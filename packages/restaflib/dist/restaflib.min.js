/*! For license information please see restaflib.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("restaflib",[],t):"object"==typeof exports?exports.restaflib=t():e.restaflib=t()}(self,function(){return function(){var e={192:function(e,t,n){var r=n(541)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},203:function(e){e.exports=function(){return"\n        result = runMain(_args_); \n        send_response(result); \n        /* print result; */\n     \n     \n        function runMain(_args_) ; \n            r = {Error= 'No path'};   \n            if ( _args_.path eq '/selectors') then do;   \n                r = selectionLists(_args_.selectors, _args_.table.caslib, _args_.table.name);   \n            end;   \n            else if ( _args_.path eq '/contents') then do;  \n                r = contents(_args_.table.caslib, _args_.table.name);  \n            end;  \n            else if (_args_.path eq '/describe') then do; \n               r = describeModel(_args_); \n            end; \n            else if (_args_.path eq '/scenario' ) then do;\n              r = fetchData(_args_.filter, _args_.table);\n            end;\n            else if (_args_.path eq '/score') then do;  \n                if( exists(_args_, 'modelName')  eq false ) then\n                  modelname = '';\n                else modelName =_args_.modelName;\n                r =  runScoreCode(_args_.model,  _args_.scenario, modelName);   \n            end;   \n            else do; \n              r = {icasResults={Errors = 'Invalid action option specified' || _args_.path}, statusCode=404}; \n            end; \n            print r;\n            if ( r.statusCode ne 0) then do;\n              print r.icasResults;\n              exit({severity=2,reason=6, status=r.iCasResults.Errors,statusCode=r.statusCode});\n            end;\n            result = {casResults = r.icasResults};  \n            print '***************************************************************';  \n            print result;  \n            print '***************************************************************';  \n            return result;  \n        end; \n     \n        /*-----------------------------------------*/ \n        /* describeModel                           */ \n        /*-----------------------------------------*/ \n     \n        function describeModel(_args_) ; \n            s = checkAndLoadTable(_args_.model.caslib, _args_.model.name);   \n            if ( s ne true) then do;   \n                results = {Errors= 'Unable to access ' ||_args_.model.caslib||'.'||_args_.model.name};   \n                return {icasResults=results, statusCode=404};  \n                end; \n     \n            mtype = isModel(_args_.model.caslib, _args_.model.name); \n            if ( mtype EQ 'astore' ) then do; \n               r = astoreDescribe(_args_.model); \n            end; \n            else if (mtype EQ 'ds' or mtype EQ 'ds2') then do;\n               s = checkAndLoadTable(_args_.table.caslib, _args_.table.name);   \n              if ( s ne true ) then do;   \n                results = {Errors= 'Unable to access ' ||_args_.table.caslib||'.'||_args_.table.name};   \n                return {icasResults=results, statusCode=404};  \n                end; \n               r = contents( _args_.table.caslib, _args_.table.name); \n            end; \n         return {icasResults= r, statusCode=0} ;\n        end;             \n       \n        /*------------------------------------------*/ \n        /* astoreDescribe                           */ \n        /*------------------------------------------*/ \n     \n        function astoreDescribe(model); \n          action astore.describe r=result/ \n              rstore = { caslib= model.caslib name = model.name }; \n          rows = resultsToDict(result.InputVariables); \n          return {describe = rows, table = result.InputVariables}; \n        end; \n     \n        /*------------------------------------------*/  \n        /* score                                    */  \n        /*------------------------------------------*/  \n        function runScoreCode( model, scenario, modelName);   \n            print model; \n            s = checkAndLoadTable(model.caslib, model.name);   \n            if ( s ne true ) then do;   \n                results = {Errors= 'Unable to access ' ||model.caslib||'.'||model.name};   \n                return {icasResults=results, statusCode=404};   \n                end;\n             \n            mtype = isModel(model.caslib, model.name); \n     \n            if ( mtype eq 'bad' ) then do; \n               results = {Error= model.caslib||'.'||model.name || ' is not recognized as a valid supported model. Please check your values'};\n               return {icasResults=results, statusCode=400};\n              end; \n            destroyTable('casuser', 'input');   \n            argsToTable(scenario, 'casuser', 'input'); \n     \n            destroyTable('casuser', 'output');   \n     \n            if (mtype eq 'astore') then do; \n                print 'Scoring with astore'; \n                action astore.score r = result/   \n                    rstore = {caslib=model.caslib name=model.name}   \n                    out    = {caslib='casuser' name='output'}   \n                    table  = {caslib='casuser' name='input'};   \n            end; \n            else if (mtype eq 'ds') then do; \n                print 'scoring with datastep code'; \n                action datastep.runcodetable r = result/   \n                    single='YES'   \n                    codeTable= {caslib=model.caslib name=model.name}   \n                    casout = {caslib='casuser' name='output'}   \n                    table = {caslib='casuser' name='input'};   \n            end;  \n            else if (mtype eq 'ds2' ) then do; \n               print 'Scoring with d2'; \n               if ( missing(modelName) eq true) then do;\n                  results = {Error= 'modelName is missing. Please check your values'};\n                  return {icasResults=results, statusCode=400};\n               end;\n\n               action ds2.runModel r = result/ \n                  modelTable = {caslib=model.caslib, name=model.name} \n                  modelName = modelName \n                  table = {caslib= 'casuser', name='input'} \n                  casOut = {caslib= 'casuser' name='output'}; \n               end; \n     \n             \n            action table.fetch r = result /   \n                table={caslib='casuser' name='output'};   \n             \n            rows = resultsToDict(result.Fetch);   \n            \n            return {icasResults= rows, statusCode=0} ;\n        end;   \n             \n        \n    "}},541:function(e,t,n){var r=n(998).default;function a(){"use strict";e.exports=a=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var t,n={},s=Object.prototype,o=s.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",p=i.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(t){f=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var a=t&&t.prototype instanceof x?t:x,s=Object.create(a.prototype),o=new A(r||[]);return c(s,"_invoke",{value:E(e,n,o)}),s}function b(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=d;var m="suspendedStart",h="suspendedYield",y="executing",v="completed",g={};function x(){}function w(){}function k(){}var _={};f(_,u,function(){return this});var S=Object.getPrototypeOf,C=S&&S(S(P([])));C&&C!==s&&o.call(C,u)&&(_=C);var T=k.prototype=x.prototype=Object.create(_);function j(e){["next","throw","return"].forEach(function(t){f(e,t,function(e){return this._invoke(t,e)})})}function O(e,t){function n(a,s,c,i){var u=b(e[a],e,s);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==r(p)&&o.call(p,"__await")?t.resolve(p.__await).then(function(e){n("next",e,c,i)},function(e){n("throw",e,c,i)}):t.resolve(p).then(function(e){l.value=e,c(l)},function(e){return n("throw",e,c,i)})}i(u.arg)}var a;c(this,"_invoke",{value:function(e,r){function s(){return new t(function(t,a){n(e,r,t,a)})}return a=a?a.then(s,s):s()}})}function E(e,n,r){var a=m;return function(s,o){if(a===y)throw new Error("Generator is already running");if(a===v){if("throw"===s)throw o;return{value:t,done:!0}}for(r.method=s,r.arg=o;;){var c=r.delegate;if(c){var i=R(c,r);if(i){if(i===g)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=y;var u=b(e,n,r);if("normal"===u.type){if(a=r.done?v:h,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=v,r.method="throw",r.arg=u.arg)}}}function R(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,R(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var s=b(a,e.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,g;var o=s.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function q(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function P(e){if(e||""===e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function n(){for(;++a<e.length;)if(o.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(r(e)+" is not iterable")}return w.prototype=k,c(T,"constructor",{value:k,configurable:!0}),c(k,"constructor",{value:w,configurable:!0}),w.displayName=f(k,p,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,f(e,p,"GeneratorFunction")),e.prototype=Object.create(T),e},n.awrap=function(e){return{__await:e}},j(O.prototype),f(O.prototype,l,function(){return this}),n.AsyncIterator=O,n.async=function(e,t,r,a,s){void 0===s&&(s=Promise);var o=new O(d(e,t,r,a),s);return n.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},j(T),f(T,p,"Generator"),f(T,u,function(){return this}),f(T,"toString",function(){return"[object Generator]"}),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(q),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],c=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var i=o.call(s,"catchLoc"),u=o.call(s,"finallyLoc");if(i&&u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(i){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),q(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;q(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:P(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},n}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},998:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return function(){"use strict";function e(e,t,n,r,a,s,o){try{var c=e[s](o),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function t(t){return function(){var n=this,r=arguments;return new Promise(function(a,s){var o=t.apply(n,r);function c(t){e(o,a,s,c,i,"next",t)}function i(t){e(o,a,s,c,i,"throw",t)}c(void 0)})}}n.r(r),n.d(r,{casActionRun:function(){return E},casAppendTable:function(){return M},casFetchData:function(){return L},casFetchRows:function(){return A},casLoadTable:function(){return ee},casSaveTable:function(){return J},casSetup:function(){return j},casTableToJson:function(){return Q},casUpdateData:function(){return N},casUpload:function(){return $},caslDescribe:function(){return C},caslRun:function(){return h},caslRunBase:function(){return p},caslScore:function(){return w},computeAppendTable:function(){return Ce},computeFetchData:function(){return we},computeFileContent:function(){return _e},computeResults:function(){return be},computeRun:function(){return le},computeSetup:function(){return fe},computeSetupTables:function(){return he},computeSummary:function(){return oe},computeUpdateData:function(){return Oe},computeUpload:function(){return Re},findReport:function(){return qe},getReportImage:function(){return Pe},getReportUri:function(){return Ie},getSasTableRows:function(){return Fe},jesRun:function(){return Ve},jesSetup:function(){return Ue},jesSummary:function(){return Qe},jsonToDict:function(){return u},lib:function(){return ot},masAddModel:function(){return Ke},masDescribe:function(){return tt},masRun:function(){return rt},masScore:function(){return st},masSetup:function(){return et}});var a=n(192),s=n.n(a);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function c(e){var t="{ ",n=" ";for(var r in e){if(!0===Array.isArray(e[r])){var a=i(e[r]);t=t+n+"".concat(r,"=")+a}else{var s=o(e[r]);if("object"===s){var u=c(e[r]);t=t+n+"".concat(r,"=")+u}else t=t+n+"".concat(r,"=")+("string"===s?' "'.concat(e[r],'" '):"".concat(e[r],"  "))}n=","}return t+"} "}function i(e){for(var t="{",n=" ",r=e.length,a=0;a<r;a++)if(!0===Array.isArray(e[a])){var s=i(e[a]);t=t+n+"".concat(a,"=")+s}else{var u=o(e[a]);t="object"===u?t+n+c(e[a]):t+n+("string"===u?' "'.concat(e[a],'" '):"".concat(e[a],"  ")),n=","}return t+"}"}var u=function(e,t){var n;return n=null===e?"{}":!0===Array.isArray(e)?i(e):c(e),"".concat(t," = ").concat(n,";")};function l(){return l=t(s().mark(function e(t,n,r,a){var o,c,i,l,p,f,d,b=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=u(null!==a?a:{},"_args_"),c=(c=o+" "+r).replace(/\r?\n|\r/g,""),i={action:"sccasl.runcasl",data:{code:c}},l=b.length,p=new Array(l>4?l-4:0),f=4;f<l;f++)p[f-4]=b[f];return e.next=7,t.runAction.apply(t,[n,i].concat(p));case 7:return d=e.sent,e.abrupt("return",d);case 9:case"end":return e.stop()}},e)})),l.apply(this,arguments)}var p=function(e,t,n,r){return l.apply(this,arguments)},f=n(203),d=function(){return"\n    print _args_;\n\n    results = casFetchRows(_args_.table.caslib, _args_.table.name , _args_.start + 1, _args_.limit,  _args_.format, _args_.where);  \n    send_response({casResults = results});  \n        \n    function casFetchRows(caslib, name, from, count, format, where) ;    \n     \n       rc = checkAndLoadTable(caslib, name);\n    \n       if (rc ne true) then do;\n        text = 'Unable to access ' ||caslib||'.'||name;   \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        exit(rx);  \n        end;  \n\n        /*\n         * get tableoinfo to get rowCount\n         */\n\n        action table.tableinfo r= result/    \n            caslib = caslib    \n            name   = name;    \n     \n        rowCount = result.TableInfo[1, 'rows'];\n        to = from + count - 1;\n\n        \n        /*\n         * get column information\n         */\n\n        action table.columninfo r=infoResult /\n            table = {caslib=caslib name=name};\n\n        columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}};\n        i = 2;\n        do c over inforesult.columninfo;\n           columns[i] = c;\n           i = i + 1;\n        end;\n        \n        /*\n         * Fetch the current set of rows\n         */\n\n        rows = {};\n        if (from <=  rowCount) then do;\n          action table.fetch r = result status=rcx/    \n              table = {caslib=caslib, name=name where=where}   \n              from= from to=to format=format  sastypes=true\n              ;\n          if (rcx.severity eq 2) then do;\n            exit(rcx);\n          end;\n          /* \n          * create payload to return\n          */\n\n          i = 1;\n          rows ={};\n          do row over result.fetch;\n            rr = {};\n            j = 1;\n            do key,v  over row;\n              rr[j] = override(columns[j].Type, v);\n              j = j + 1;\n            end;\n            rows[i] = rr;\n            i = i + 1;\n          end;\n        end;\n\n        currentCount = DIM(rows);\n        pagination = {};   \n        table = {caslib=caslib, name=name};\n\n        pagination = setPagination(from, count, format, where, currentCount, rowCount, table);\n    \n        lastRequest={start=from-1, limit=count, format=format, currentCount=currentCount, \n                     rowCount=rowCount, where=where, table=table, version='3'};\n       scrollOptions = getKeys(pagination);\n       return( \n         {pagination = pagination, data = {schema=columns, rows=rows , scrollOptions=scrollOptions}, lasRequest=lastRequest}\n         );\n    end;    \n    \n    \n    /*\n     * For non-primary column types set new content\n     */\n\n    function setPagination(from, count, format, where,  currentCount, rowCount, table);\n\n\n      prevStart = max(from - count - 1, 0);\n\n      if (currentCount lt count) then do; \n        pagination.prev = {start=prevStart, limit=count, format=format, where=' ', table=table};\n        if (prevStart ne 0) then do;\n          pagination.first = {start=0, limit=count, format=format, where=' ', table=table};\n        end; \n      return pagination;\n      end;\n      currentStart = from -1;\n      if (currentStart eq 0) then do;\n         pagination.next = {start=count, limit=count, format=format, where=' ', table=table};\n         return pagination;\n      end;\n\n      nextStart = currentStart + count;\n      pagination.next = {start=nextStart, limit=count, format=format, where=' ', table=table};\n      pagination.prev = {start=prevStart, limit=count, format=format, where=' ', table=table};\n      if (prevStart ne 0) then do;\n        pagination.first = {start=0, limit=count, format=format, where=' ', table=table};\n      end; \n      return pagination;\n  end;\n\n\n\n\n    function override(type, iv);\n      if (type EQ 'varbinary')       then v = '...varbinary';\n      else if (type EQ  'blob')      then v = '...blob';\n      else if (type EQ 'table')      then v = '...table';\n      else if (type EQ 'dictionary') then v = '...dictionary';\n      else if (type EQ 'list')       then v = '...list';\n      else if (type EQ 'isArray')    then v = '...array';\n      else v = iv;\n      return v;\n      end;\n\n      \n    "},b={commonCasl:function(){return"\n    function checkAndLoadTable(caslib, name);   \n        \n                /* verify caslib is there */\n                 table.queryCaslib status=status result=result/\n                    caslib = caslib;\n                do k,v over result;   /* to handle casuser[user] */                       \n                   rc = v;\n                end;\n                if ( rc eq false ) then \n                   return -1;\n                /*    \n                * Check to see if table is already loaded   \n                */   \n                action table.tableExists r=result/    \n                    caslib = caslib    \n                    name  = name;    \n                /*   \n                * if not loaded then try to load it   \n                */   \n                rc = true;\n                if (result.exists eq 0 or result.exists eq 2) then do;   \n                    path = lookupPath(caslib, name);\n                    if (path eq '*') then do;\n                       rc = false;\n                    end;\n                    else do;\n                        action table.loadTable status=status/    \n                            caslib = caslib    \n                            source = path    \n                            casout={caslib= caslib name=name}; \n                        if (status.statusCode ne 0 ) then rc = false;\n                    end; \n                end;        \n                return rc;  \n            end;   \n        \n        function saveAndLoadTable(caslib, source, targetlib, targetname,promote);\n        \n                /* load source */\n                r = checkAndLoadTable(caslib, source);\n        \n                sashdat = target||\".sashdat\";\n                table.save /\n                    caslib= targetlib name=sashdat\n                    table = {caslib=caslib name=source} replace=true;\n                \n                table.droptable /\n                    caslib=targetlib name=target quiet=true;\n                \n                table.loadtable result=r status=rc/\n                    caslib=targetlib casout={caslib=targetlib name=target replace=TRUE}\n                    path=sashdat;\n        \n                if (promote eq true) then do;\n                    table.promote result=r status=rc/\n                      caslib=caslib name=target quiet=true\n                      targetLib=caslib target=target;\n                end;\n                if (rc.severity eq 2) then do;\n                    print rc;\n                    print 'Ignoring error';\n                    end;\n                r = 0;\n                return r;\n        \n         end;\n        \n    function lookupPath(caslib, name ) ; \n            table.fileInfo r = result/\n            caslib=caslib; \n        \n            names = result.fileInfo[,4]; \n            nameu = upcase(name)||'.SASHDAT'; \n            cpath = '*'; \n            count = 0; \n        \n            do n over names; \n                if (upcase(n) eq nameu)  then do; \n                    count = count + 1; \n                    if ( cpath eq '*') then do; \n                        cpath = n; \n                    end; \n                end; \n            end; \n            \n            if (count GT 1 ) then do; \n                print 'Warning: ' count 'Files with names only different in case exist - First one chosen';\n                print 'Path: ' cpath ' will be used****';  \n            end; \n            r = cpath; \n            return r; \n        end; \n            /*-----------------------------------------*/ \n            /* isModel: is it model table              */  \n            /*-----------------------------------------*/  \n         \n            function isModel(caslib, name) ; \n                 table.columnInfo r = result /  \n                        table = {caslib=caslib , name=name};  \n                 validTable = false; \n                 mtype = 'bad'; \n                 do c over result.columninfo;  \n                    cu = upCase(c.Column); \n                    if ( cu eq 'DATASTEPSRC') then do; \n                       mtype = 'ds'; \n                    end; \n                    else if ( cu eq '_STATE_' ) then do; \n                      mtype = 'astore'; \n                    end; \n                    else if (cu eq 'MODELMETADATA') then do; \n                      mtype = 'ds2'; \n                    end; \n                end;  \n                print 'Specified model type: ' || mtype; \n                return mtype; \n            end; \n         \n    /*-----------------------------------------*/ \n            /* Returns contents of the specified table */  \n            /*-----------------------------------------*/  \n         \n            function contents(caslib, name) ;    \n                table.columnInfo r = result /  \n                        table = {caslib=caslib , name=name};  \n               /* columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}}; */ \n                i = 1;  \n                columns = {}; \n                do c over result.columninfo;  \n                    columns[i] = c;  \n                    i = i + 1;  \n                end;  \n                return {describe = columns, table = {}};   \n            end;  \n    \n           /*------------------------------------------*/  \n            /* Returns unique values                   */  \n            /*-----------------------------------------*/  \n         \n            function selectionLists(idvars,caslib, name, where);   \n                 \n                s = checkAndLoadTable(caslib, name);   \n                if ( s ne true) then do;   \n                results = {Errors= 'Unable to access ' ||caslib||'.'||name, statusCode = s};   \n              \n                end;   \n                print idvars;\n                do k over idvars;   \n                r  = _getValues(k, caslib, name, where);   \n                results[k] = r;   \n                end;   \n                return { data=results, statusCode=0};   \n            end;   \n           function _getValues(id, caslib, name, where) ;   \n                             \n                action table.dropTable/   \n                caslib='casuser' name='dtemp1' quiet=TRUE;   \n                     \n                action table.deleteSource status=src /   \n                caslib='casuser' source= 'dtemp1.sashdat' quiet=TRUE;   \n                     \n                action simple.groupby result=r status=rc/   \n                    aggregator = 'N'   \n                    inputs     = {id}   \n                    table      = {caslib=caslib name=name, where=where}   \n                    casout     = {caslib='casuser' name='dtemp1'}   \n                ;   \n                action table.fetch result=r/   \n                    table={caslib='casuser' name='dtemp1'}    \n                    sortby={{name=id,  order='ascending'}};   \n                result = r.Fetch[,2];   \n                return result;   \n                end;  \n            /*------------------------------------------*/ \n            /* get a record                             */ \n            /*------------------------------------------*/ \n         \n            function _fetchData(filter, table); \n                s = checkAndLoadTable(table.caslib, table.name);   \n                if ( s ne 0 ) then do;   \n                    results = {Errors= 'Unable to access ' ||table.caslib||'.'||table.name};   \n                    return results;   \n                    end;   \n                wherex = dictTowhere(filter);   \n               /* wherex = table.caslib||'.'||table.name||'(where=('||wherex||'));';  \n                 \n                destroyTable('casuser', 'input');  \n         \n                action datastep.runCode r=result status=rc/   \n                    single='yes'   \n                    code = 'data casuser.input; set ' || wherex||'run;';  \n                    */ \n                     \n                action table.fetch r = result /   \n                    table={caslib=table.caslib name=table.name where=wherex};   \n             \n                rows = resultsToDict(result.Fetch);   \n                return {scenario = rows, table = result.Fetch};   \n         \n            end; \n    function destroyTable(caslib,name);   \n                action table.dropTable/   \n                caslib=caslib name=name quiet=TRUE;   \n                         \n                action table.deleteSource status=src /   \n                caslib=caslib source= name||'.sashdat' quiet=TRUE;   \n                     \n            return true;   \n            end;   \n                 \n                 \n            function dictToWhere(filter);   \n                where ='';   \n                andbit='  ';   \n                do k,v over filter;   \n                    if (isString(v) ) then do;   \n                        where = where || andbit || k ||  ' eq ' || '\"'||v||'\"';   \n                    end;    \n                    else do;   \n                        where = where || andbit || k ||  ' eq ' || v ;   \n                    end;   \n                andbit =' and ';   \n                end;   \n            return where;   \n            end;   \n                 \n            function resultsToDict(r);   \n                casResults = {};   \n                i = 1;   \n                do row over r;   \n                casResults[i] = row;   \n                i = i + 1;   \n                end;   \n                return casResults;   \n            end;   \n             \n            function argsToTable(_arg_, caslib, name );   \n                action table.droptable/  \n                    caslib=caslib name=name quiet=TRUE;  \n                i = 1;  \n                do key,obj over _arg_;  \n                    columns[i] = key;  \n                    row[i] = obj;  \n                    if ( isString(obj) ) then  \n                        type[i] = 'varchar';   \n                    else if ( isInteger(obj) ) then   \n                        type[i] = 'int';   \n                    else type[i] = 'double';  \n                    i = i + 1;  \n                    end;    \n                 \n                data1 = newTable('data1', columns, type, row );   \n                 \n                saveresult data1 casout=name caslib=caslib replace;   \n            end; \n    \n        function saveAndPromoteTable(caslib, target, source);\n            sashdat = target||\".sashdat\";\n            rc = checkAndLoadTable(caslib, source);\n            table.droptable /\n                caslib=caslib name=target quiet=true;\n        \n            table.save /\n                caslib= caslib name=sashdat\n                table = {caslib=caslib name=source} replace=true;\n            \n            table.loadtable result=r/\n                caslib=caslib casout={caslib=caslib name=target replace=TRUE}\n                path=sashdat;\n        \n            table.promote result=r status=rc/\n                caslib=caslib name=target quiet=true\n                targetLib=caslib target=target;\n            print rc;\n            r = rc.severity;\n            if (rc.severity gt 0) then do;\n              print rc;\n              print 'Ignoring error';\n              rc = 0;\n            end;\n        \n            return r;\n         end;  \n       \n     "},casFetchData:d,casFetchRows:function(){return"\n  results = casFetchRows(_args_.table.caslib, _args_.table.name , _args_.from, _args_.count,  _args_.format, _args_.where);   \n  send_response({casResults = results});  \n      \n  function casFetchRows(caslib, name, from, count, format, where) ;    \n   \n     rc = checkAndLoadTable(caslib, name);\n  \n     if (rc ne true) then do;\n      text = 'Unable to access ' ||caslib||'.'||name;   \n      rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n      exit(rx);  \n      end;  \n\n      /*\n       * get all table to get rowCount\n       */\n\n      action table.tableinfo r= result/    \n          caslib = caslib    \n          name   = name;    \n   \n      rowCount = result.TableInfo[1, 'rows'];    \n     \n      to       = from + count - 1;   \n      \n      /*\n       * get column information\n       */\n\n      action table.columninfo r=infoResult /\n          table = {caslib=caslib name=name};\n\n      columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}};\n      i = 2;\n      do c over inforesult.columninfo;\n         columns[i] = c;\n         i = i + 1;\n      end;\n      \n      /*\n       * Fetch the current set of rows\n       */\n     /* wherex = dictTowhere(where); let user send in the where clause */\n      print where;\n\n      action table.fetch r = result /    \n          table = {caslib=caslib, name=name where=where}   \n          from= from to=to format=format  sastypes=true\n          ;\n\n      /* \n       * create payload to return\n       */\n\n      i = 1;\n      rows ={};\n      do row over result.fetch;\n        rr = {};\n        j = 1;\n        do key,v  over row;\n          rr[j] = override(columns[j].Type, v);\n          j = j + 1;\n        end;\n        rows[i] = rr;\n        i = i + 1;\n      end;\n\n      pagePrev = max(from - count, 1);\n     \n      if ( to eq rowCount ) then do;    \n          pageNext = -1;    \n      end;    \n      else do ;    \n          pageNext = min(to + 1, rowCount);    \n      end;   \n      table = {caslib=caslib, name=name};\n      pagination = {next= {from=pageNext, count=count, format=format, where=where table=table}, prev={from=pagePrev, count=count, format=format, where=where, table=table}};\n      pagination.current = {from = from, to=to, rowCount=rowCount, version=1};\n      return( \n       {pagination = pagination, data = {schema=columns, rows=rows }}\n       );\n  end;    \n  \n  \n  /*\n   * For non-primary column types set new content\n   */\n\n  function override(type, iv);\n    if (type EQ 'varbinary')       then v = '...varbinary';\n    else if (type EQ  'blob')      then v = '...blob';\n    else if (type EQ 'table')      then v = '...table';\n    else if (type EQ 'dictionary') then v = '...dictionary';\n    else if (type EQ 'list')       then v = '...list';\n    else if (type EQ 'isArray')    then v = '...array';\n    else v = iv;\n    return v;\n    end;\n\n    \n  "},scoreCasl:n.n(f)(),casAppendTable:function(){return"\n    rc = checkAndLoadTable(_args_.masterTable.caslib, _args_.masterTable.name);\n\n    if (rc ne true) then do;\n        text = 'Unable to access ' ||_args_.masterTable.caslib||'.'||_args_.masterTable.name;   \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        exit(rx); \n    end; \n    \n    rc = checkAndLoadTable(_args_.setTable.caslib, _args_.setTable.name);\n    if (rc ne true) then do;\n        text = 'Unable to access ' ||_args_.setTable.caslib||'.'||_args_.setTable.name; \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        return rx;\n    end;\n\n\n    setdata = _args_.setTable.caslib ||'.'||_args_.setTable.name;\n    masterdata = _args_.masterTable.caslib ||'.'||_args_.masterTable.name;\n\n    action datastep.runCode r=result status=rc/\n     code='data ' ||masterdata||'(append=YES);set ' || setdata ||'; run;';\n\n    if (rc.statusCode ne 0) then do;\n      exit(rc);\n    end; \n    else do;\n     results = {msg= 'Append succeeded', statusCode=true};\n     end;\n    \n    send_response({casResults = results});\n    "},casRowSets:d};function m(){return m=t(s().mark(function e(t,n,r,a,o){var c,i,u,l,f,d=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(c=r,!1!==o&&(c=b.commonCasl()+" "+r),i=d.length,u=new Array(i>5?i-5:0),l=5;l<i;l++)u[l-5]=d[l];return e.next=5,p.apply(void 0,[t,n,c,a].concat(u));case 5:return f=e.sent,e.abrupt("return",f.items().toJS());case 7:case"end":return e.stop()}},e)})),m.apply(this,arguments)}var h=function(e,t,n,r,a){return m.apply(this,arguments)};function y(e,t,n){return(t=function(e){var t=function(e){if("object"!==o(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function x(){return(x=t(s().mark(function e(t,n,r){var a,o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.commonCasl()+" "+b.scoreCasl(),o=g({path:"/score"},r),e.next=4,p(t,n,a,o);case 4:return c=e.sent,i=c.items("results","casResults").toJS()[0],e.abrupt("return",i);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var w=function(e,t,n){return x.apply(this,arguments)};function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach(function(t){y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function S(){return(S=t(s().mark(function e(t,n,r){var a,o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.commonCasl()+" "+b.scoreCasl(),o=_({path:"/describe"},r),e.next=4,p(t,n,a,o);case 4:return c=e.sent,i=c.items("results").toJS(),e.abrupt("return",i);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var C=function(e,t,n){return S.apply(this,arguments)};function T(){return(T=t(s().mark(function e(t,n,r,a){var c,i,u,l,p,f,d,b,m,h;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=4;break}return e.next=3,t.logon(n);case 3:e.sent;case 4:return e.next=6,t.addServices("casManagement");case 6:return c=e.sent,i=c.casManagement,e.next=10,t.apiCall(i.links("servers"));case 10:if(0!==(u=e.sent).itemsList().size){e.next=13;break}throw{Error:"No cas servers were found"};case 13:if(l=null,null!=a){e.next=18;break}l=u.itemsList(0),e.next=25;break;case 18:if(p=u.itemsList().toJS(),-1!==(f=p.findIndex(function(e){return e===a}))){e.next=24;break}throw{Error:"server with name of ".concat(a," was not found")};case 24:l=u.itemsList(f);case 25:if(d=null,null!=r){e.next=32;break}return e.next=29,t.apiCall(u.itemsCmd(l,"createSession"));case 29:d=e.sent,e.next=46;break;case 32:if("object"!==o(r)){e.next=36;break}d=r,e.next=46;break;case 36:return b={qs:{filter:"eq( id,'".concat(r,"')")}},e.next=39,t.apiCall(u.itemsCmd(l,"sessions"),b);case 39:if(0!==(m=e.sent).items().size){e.next=42;break}throw"ERROR: The sessionID ".concat(r," was not found.");case 42:return h=m.itemsCmd(m.itemsList(0),"self"),e.next=45,t.apiCall(h);case 45:d=e.sent;case 46:return e.abrupt("return",{servers:u,session:d});case 47:case"end":return e.stop()}},e)}))).apply(this,arguments)}var j=function(e,t,n,r){return T.apply(this,arguments)};function O(){return O=t(s().mark(function e(t){var n,r,a,o,c=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=c.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=c[a];return e.next=3,t.runAction.apply(t,r);case 3:return o=e.sent,e.abrupt("return",o.items().toJS());case 5:case"end":return e.stop()}},e)})),O.apply(this,arguments)}var E=function(e){return O.apply(this,arguments)};function R(){return(R=t(s().mark(function e(t,n,r){var a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.commonCasl()+" "+b.casFetchData(),e.next=3,p(t,n,a,r);case 3:return o=e.sent,e.abrupt("return",o.items("results","casResults").toJS());case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var L=function(e,t,n){return R.apply(this,arguments)};function q(){return(q=t(s().mark(function e(t,n,r){var a,o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null==r.where&&(r.where=" "),a=b.commonCasl()+" "+b.casFetchRows(),e.next=4,p(t,n,a,r);case 4:return o=e.sent,null==(c=o.items("results","casResults").toJS()).data&&(c.data={rows:[]}),e.abrupt("return",c);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var A=function(e,t,n){return q.apply(this,arguments)};function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach(function(t){y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function I(){return(I=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,d,b,m,h,y,v,g,x,w;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(l in a=r.data,o=r.where,c=r.table,i="",u=" ",o)p=o[l],f="string"==typeof p?"'".concat(p.toString(),"'"):p,i=i+u+l+"= ".concat(f," "),u=" AND ";for(b in d=[],a)m=a[b],void 0,h=null==m?".":"string"==typeof m?JSON.stringify(m):m.toString(),d.push({var:b,value:h});return y=D(D({},c),{},{where:"".concat(i)}),v={action:"table.update",data:{table:y,set:d}},e.next=11,t.runAction(n,v);case 11:return g=e.sent,x={msg:"Update completed",statusCode:0},0!==(w=g.items().toJS().disposition).statusCode&&(x.statusCode=w.statusCode,x.msg=w.reason),e.abrupt("return",x);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}var N=function(e,t,n){return I.apply(this,arguments)};function F(){return(F=t(s().mark(function e(t,n,r,a,o){var c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.caslib,i=r.name,'\n   table.save /\n    replace=true\n      table = {caslib="'.concat(c,'" name="').concat(i,'"}\n    caslib="').concat(c,'" name="').concat(i,'.sashdat";\n\n  /* clean up before promoting the table */\n  table.droptable /\n      caslib="').concat(c,'" name="').concat(i,'" ;\n\n  /* promote the table to make it available for further analysis */\n  table.loadTable status=status r=rc/\n    caslib="').concat(c,'",\n    path="').concat(i,'.sashdat",\n    casout={name="').concat(i,'", caslib="').concat(c,'" promote=True};\n    run;\n\t'),e.abrupt("return",{msg:"".concat(c,".").concat(i," saved}"),statusCode:0});case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var J=function(e,t,n,r,a){return F.apply(this,arguments)};function U(){return(U=t(s().mark(function e(t,n,r,a,o,c){var i,u,l,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=b.commonCasl()+" "+b.casAppendTable(),u={masterTable:a,setTable:r,save:null==o||o,promote:null!=c&&c},e.next=4,p(t,n,i,u);case 4:if(l=e.sent,f=l.items("results","casResults").toJS(),!0!==o){e.next=9;break}return e.next=9,J(t,n,a);case 9:return e.abrupt("return",f);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var M=function(e,t,n,r,a,s){return U.apply(this,arguments)},Q=function(e,t){var n=e.items("tables",t),r=n.get("rows"),a=[];n.get("schema").map(function(e){a.push(e.get("name"))});var s=[];return r.map(function(e){var t={};e.map(function(e,n){t[a[n]]=e}),s.push(t)}),s};function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G(){return(G=t(s().mark(function e(t,n,r,a){var o,c,i,u,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.output,c=o.caslib,null!=(i=o.name)){e.next=3;break}throw"Please specify table as caslib.name";case 3:return i=i.toLowerCase(i),u="\n      action table.droptable /\n       caslib= '".concat(c,"'  name= '").concat(i,"' quiet=true;\n\n      action table.deleteSource/\n      caslib= '").concat(c,"'  source= '").concat(i,".sashdat' quiet=true;   \n      "),l={action:"sccasl.runcasl",data:{code:u}},e.next=8,t.runAction(n,l);case 8:return l={action:"astore.upload",data:{rstore:{name:"".concat(i),caslib:"".concat(c),replace:!0},store:r}},e.next=11,t.runAction(n,l);case 11:return e.sent,e.abrupt("return","Upload of ".concat(a.source," to ").concat(c,".").concat(i," completed"));case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var B=function(e,t,n,r){return G.apply(this,arguments)};function Y(){return(Y=t(s().mark(function e(t,n,r,a,o){var c,i,u,l,p,f,d;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=a.output,i=c.caslib,null!=(u=c.name)){e.next=3;break}throw"Please specify table as caslib.name";case 3:return e.next=5,H(t,n,i,u);case 5:return e.sent,l={casout:{caslib:i,name:u},importOptions:{fileType:a.fileType}},"sas"!==a.fileExt&&"ds2"!==a.fileExt||(l.importOptions.delimiter="\\"),p={headers:{"JSON-Parameters":l,"Content-Type":"binary/octet-stream"},data:r,action:"table.upload"},e.next=11,t.runAction(n,p);case 11:if(f=e.sent,!0!==o){e.next=17;break}return d="\n\t\t\n\t\t\taction table.save r = result / \n\t\t\t\ttable = {caslib='".concat(i,"' name='").concat(u,"'} \n\t\t\t\tcaslib='").concat(i,"' name='").concat(u,"' replace=true;\n\t\t\t\n\t\t\taction table.loadTable r = result2 /\n\t\t\t\tcaslib='").concat(i,"' casout={caslib='").concat(i,"' name='").concat(u,"' replace=true} \n\t\t\t\tpath='").concat(u,".sashdat' ;\n\n\t\t\n\t\t    send_response({status=result2});\n\t\t\t"),e.next=16,h(t,n,d,null,!0);case 16:e.sent;case 17:return null==a.source||a.source,e.abrupt("return",f);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H(e,t,n,r){return V.apply(this,arguments)}function V(){return(V=t(s().mark(function e(t,n,r,a){var o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"".concat(r,".").concat(a),o="\n\t\taction table.dropTable/   \n        caslib='".concat(r,"' name='").concat(a,"' quiet=TRUE;   \n             \n        action table.deleteSource status=src /   \n        caslib='casuser' source= '").concat(a,".sashdat' quiet=TRUE;  \n\t\tsend_response({casResults = {status=src, results= 'data deleted'}})\n\t\t"),e.next=4,h(t,n,o);case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var W=function(e,t,n,r,a){return Y.apply(this,arguments)},K=function(e,t){var n,r,a=null,s=W,o=function(e){return e};switch(r=null==e?"csv":e.split(".").pop().toLowerCase()){case"sas7bdat":n="basesas";break;case"sashdat":n="hdat";break;case"csv":n=r,a="UTF8";break;case"xslx":case"xsl":n=r;break;case"astore":case"sasast":n=r,s=B,o=function(e){return new Buffer.from(e).toString("base64")};break;case"ds2":case"sas":n="csv",a="UTF8",s=W,o=function(e,t){var n=e.replace(/[^\x00-\x7F]/g,"").replace(/\r?\n/g,""),r=t.fileExt;return"modelName\\"+("sas"===r?"dataStepSrc":"ds2"===r?"ds2Src":"casl"===r?"caslSrc":"dataStepsrc")+"\n"+t.output.name+"\\ "+n+"\n"};break;default:throw"Currently file type of ".concat(r," is not supported")}var c,i,u=(c=t.split("."),i=2,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,c=[],i=!0,u=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=s.call(n)).done)&&(c.push(r.value),c.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{if(!i&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}(c,i)||function(e,t){if(e){if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(c,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{source:e,output:{caslib:u[0],name:u[1].toLowerCase()},fileType:n,fileExt:r,fileOptions:a,transform:o,contentType:"binary/octet-stream",handler:s}};function X(){return(X=t(s().mark(function e(t,n,r,a,c,i){var u,l,p,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=a,"object"===o(a)&&(u="".concat(a.caslib,".").concat(a.name)),l=K(r,u),p=i,e.next=6,l.handler(t,n,p,l,c);case 6:return f=e.sent,e.abrupt("return",f);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $=function(e,t,n,r,a,s){return X.apply(this,arguments)};function Z(){return(Z=t(s().mark(function e(t,n,r,a){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,h(t,n,"\n\t  print _args_;\n    rc = checkAndLoadTable(_args_.caslib, _args_.name);\n\t\tif (rc ne true) then do;\n\t\t\ttext = 'Unable to access ' ||_args_.caslib||'.'||_args_.name;   \n\t\t\trx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n\t\t\texit(rx);  \n\t\tend; \n\t  print 'return code = ' || rc;\n\t  send_response({casResults={status='ok'}});\n  ",r,!0);case 3:return e.sent,e.abrupt("return",{msg:"".concat(r.caslib,".").concat(r.name," loaded}"),statusCode:0});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ee=function(e,t,n,r){return Z.apply(this,arguments)};function te(){return(te=t(s().mark(function e(t,n,r,a){var o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r||null!=a){e.next=6;break}return e.next=3,ne(t,n,r);case 3:o=e.sent,e.next=9;break;case 6:return e.next=8,ae(t,n,a);case 8:o=e.sent;case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ne(e,t,n){return re.apply(this,arguments)}function re(){return(re=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,d,b;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a={session:n,log:null,listing:null,ods:null,job:r,tables:{},files:{}}).log=r.links("log"),a.listing=r.links("listing"),null===(o=r.links("results"))){e.next=10;break}return e.next=7,t.apiCall(o);case 7:if(c=e.sent,(i=c.itemsList().size)>0)for(u=0;u<i;u++)l=c.itemsList(u),"ods"===(p=c.items(l,"data","type").toLowerCase())?a.ods=c.itemsCmd(l,"self"):"table"===p?(f={self:c.itemsCmd(l,"self"),current:null},a.tables[l.toUpperCase()]=f):"file"===p?(d={self:l,current:null,data:null},a.files[l]=d):(b={self:l,current:null,data:null},a[p]=b);case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ae(e,t,n){return se.apply(this,arguments)}function se(){return(se=t(s().mark(function e(t,n,r){var a,c,i,u,l,p,f,d,b,m,h,y,v;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a={session:n,log:null,listing:null,ods:null,job:null,tables:{},files:{}},c="object"===o(r)?[r]:r,i=0;case 3:if(!(i<c.length)){e.next=29;break}return u=c[i],l=u.libref.toUpperCase(),p=u.name.toUpperCase(),f={qs:{filter:"eq(name,'".concat(l,"')")}},e.next=10,t.apiCall(n.links("librefs"),f);case 10:if(0!==(d=e.sent).itemsList().size){e.next=13;break}throw"ERROR: Libref ".concat(l," not found");case 13:return b=d.itemsCmd(l,"self"),e.next=16,t.apiCall(b);case 16:return m=e.sent,f={qs:{filter:"eq(name,'".concat(p,"')")}},e.next=20,t.apiCall(m.links("tables"),f);case 20:if(0!==(h=e.sent).itemsList().size){e.next=23;break}throw"ERROR: Table ".concat(p," not found");case 23:y="".concat(l,".").concat(p).toLowerCase(),v={self:h.itemsCmd(p,"self"),current:null},a.tables[y.toUpperCase()]=v;case 26:i++,e.next=3;break;case 29:return e.abrupt("return",a);case 30:case"end":return e.stop()}},e)}))).apply(this,arguments)}var oe=function(e,t,n,r){return te.apply(this,arguments)};function ce(){return(ce=t(s().mark(function e(t,n,r,a,o,c){var i,u,l,p,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={data:{code:r}},e.next=3,t.apiCall(n.links("execute"),i);case 3:return u=e.sent,l={qs:{wait:null!=a?a:5},headers:{"If-None-Match":u.headers("etag")}},e.next=7,t.jobState(u,l,"longpoll",0,o,c);case 7:return p=e.sent,e.next=10,oe(t,n,p.job);case 10:return(f=e.sent).SASJobStatus=p.data,f.jobStateStatus=p,e.abrupt("return",f);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ie=function(e,t,n,r,a,s){return ce.apply(this,arguments)};function ue(){return(ue=t(s().mark(function e(t,n,r,a,o,c,i){var u,l,p,f,d;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("number"==typeof c&&(c=null),u=["options NOSYNTAXCHECK OBS=MAX;%let syscc=0;"],null!=a)for(l in a)p="%let ".concat(l,"=").concat(a[l],";"),u.push(p);return f=(f=r.replace(/\t/g," ")).split(/\r?\n/),u=u.concat(f).concat(";"),e.next=8,ie(t,n,u,o,c,i);case 8:return d=e.sent,e.abrupt("return",d);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var le=function(e,t,n,r,a,s,o){return ue.apply(this,arguments)};function pe(){return(pe=t(s().mark(function e(t,n,r,a,c){var i,u,l,p,f,d,b,m,h,y,v;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==c||"object"!==o(c)){e.next=2;break}return e.abrupt("return",c);case 2:if(null==r){e.next=6;break}return e.next=5,t.logon(r);case 5:e.sent;case 6:return e.next=8,t.addServices("compute");case 8:if(i=e.sent,u=i.compute,l=null,null==c){e.next=24;break}return p={start:0,limit:100,qs:{filter:"eq(id,'".concat(c,"')")}},e.next=15,t.apiCall(u.links("sessions"),p);case 15:if(f=e.sent,!((d=f.itemsList().toJS().indexOf(c))<0)){e.next=19;break}throw"ERROR: The sessionID ".concat(c," was not found.");case 19:return b=f.itemsCmd(f.itemsList(d),"self"),e.next=22,t.apiCall(b);case 22:return l=e.sent,e.abrupt("return",l);case 24:if(null==t.store.config.options.computeServerId){e.next=30;break}return console.log("NOTE: Detected Workbench"),e.next=28,t.apiCall(u.links("createSession"));case 28:return l=e.sent,e.abrupt("return",l);case 30:return null==n&&(n="SAS Job Execution compute context"),m={qs:{filter:"contains(name,'".concat(n,"')")}},h=null,e.prev=33,e.next=36,t.apiCall(u.links("contexts"),m);case 36:if(0!==(h=e.sent).itemsList().size){e.next=39;break}throw"Context ".concat(n," not found");case 39:e.next=45;break;case 41:throw e.prev=41,e.t0=e.catch(33),console.log("Error: Not able to get context"),e.t0;case 45:if(y=h.itemsList(0),null!=c){e.next=52;break}return m=null==a?null:a,v=h.itemsCmd(y,"createSession"),e.next=51,t.apiCall(v,a);case 51:l=e.sent;case 52:return e.abrupt("return",l);case 53:case"end":return e.stop()}},e,null,[[33,41]])}))).apply(this,arguments)}var fe=function(e,t,n,r,a){return pe.apply(this,arguments)};function de(){return(de=t(s().mark(function e(t,n,r){var a,o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("log"!==r&&"listing"!==r){e.next=20;break}if(a=[],null===n[r]){e.next=16;break}return e.next=5,t.apiCall(n[r]);case 5:o=e.sent,a=a.concat(o.items().toJS());case 7:if(null===(c=o.scrollCmds("next"))){e.next=14;break}return e.next=10,t.apiCall(c);case 10:o=e.sent,a=a.concat(o.items().toJS()),e.next=7;break;case 14:e.next=17;break;case 16:a[0]="Note: No ".concat(r);case 17:return e.abrupt("return",a);case 20:if("ods"!==r){e.next=31;break}if(null===n.ods){e.next=28;break}return e.next=24,t.apiCall(n.ods);case 24:return i=e.sent,e.abrupt("return",i.items());case 28:return e.abrupt("return","<h2> No ODS output </h2>");case 29:e.next=40;break;case 31:if("tables"!==r){e.next=35;break}return e.abrupt("return",Object.keys(n.tables));case 35:if("files"!==r){e.next=39;break}return e.abrupt("return",Object.keys(n.files));case 39:throw"Error: Invalid type ".concat(r);case 40:case"end":return e.stop()}},e)}))).apply(this,arguments)}var be=function(e,t,n){return de.apply(this,arguments)};function me(){return(me=t(s().mark(function e(t,n,r,a){var o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a){e.next=6;break}return e.next=3,le(t,n,a);case 3:if("completed"===(o=e.sent).SASJobStatus){e.next=6;break}throw"Error: Preamble failed with completion code of ".concat(o.SASJobStatus);case 6:return e.next=8,oe(t,n,null,r);case 8:return c=e.sent,e.abrupt("return",c);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var he=function(e,t,n,r){return me.apply(this,arguments)};function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach(function(t){y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ge(){return(ge=t(s().mark(function e(t,n,r,a,o,c){var i,u,l,p,f,d,b,m,h,y,v,g,x,w,k,_,S,C,T,j,O,E,R;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null,u=(u="string"==typeof r?r:"".concat(r.libref,".").concat(r.name)).toUpperCase(),(l=null!=o?ve({},o):{qs:{}}).qs.includeIndex=!0,p=l.qs.format,f=null==c?"rows":c,d=null!=o&&null==a,null==(b=n.tables[u])){e.next=47;break}if(!0===d&&(b.current=null),null!==b.current&&null!=a&&"first"!==a){e.next=35;break}return e.next=15,t.apiCall(b.self);case 15:return m=e.sent,h=m.items().toJS().columnCount,y={qs:{start:0,limit:h}},e.next=20,t.apiCall(m.links("columns"),y);case 20:for(w in v=e.sent,g=[],x=v.items().toJS(),"rows"===f&&g.push({name:"_index_",Column:"_Index_",Label:"Index",length:8,type:"FLOAT",format:"BEST",informat:"BEST",custom:!1,isFormat:!1}),x)k=x[w],_={name:k.name.toLowerCase(),Column:k.name.toLowerCase(),Label:k.data.label,length:k.data.length,type:k.data.type,format:null!=k.data.format?k.data.format.name:null,informat:null!=k.data.informat?k.data.informat.name:null,custom:!1,isFormat:p},S=!0===l.qs.includeIndex?1:0,g[k.data.index+S]=_;return e.next=27,t.apiCall(m.links(f),l);case 27:C=e.sent,T="rowSet"===f?C.items("rows").toJS():xe(C),b.current=C,b.schema=g,b.columns=v,i={columns:v,schema:g,rows:T,scrollOptions:C.scrollCmds().keySeq().toJS()},e.next=47;break;case 35:if(j=b.current,O=a,"next"===a&&null===j.scrollCmds("next")&&(O=null!==j.links("last")?"last":null),"prev"===a&&null===j.scrollCmds("prev")&&(O=null!==j.links("first")?"first":null),i={schema:b.schema,columns:b.columns,currentColumns:b.currentColumns,rows:[],scrollOptions:j.scrollCmds().keySeq().toJS()},null===O||null===j.scrollCmds(O)){e.next=47;break}return e.next=43,t.apiCall(j.scrollCmds(O),l);case 43:E=e.sent,b.current=E,R="rows"!==f?E.items("rows").toJS():xe(E),i={schema:b.schema,columns:b.schema,rows:R,scrollOptions:E.scrollCmds().keySeq().toJS()};case 47:return e.abrupt("return",i);case 48:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xe(e){return e.items().toJS().map(function(e){return e.cells})}var we=function(e,t,n,r,a,s){return ge.apply(this,arguments)};function ke(){return(ke=t(s().mark(function e(t,n,r,a){var o,c,i,u,l,p;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(o=n.files[r])){e.next=3;break}throw"Invalid fileref ".concat(r);case 3:if(null!==o.current){e.next=12;break}return c={qs:{filter:"eq(name,'".concat(r,"')")}},e.next=7,t.apiCall(n.session.links("files"),c);case 7:return i=e.sent,e.next=10,t.apiCall(i.itemsCmd(r,"self"));case 10:i=e.sent,o.current=i;case 12:if(!0!==a){e.next=17;break}return u="".concat(n.session.host).concat(o.current.links("content","link","uri")),e.abrupt("return",u);case 17:if(null!==o.data){e.next=26;break}return e.next=20,t.apiCall(o.current.links("content"));case 20:return l=e.sent,p=l.items(),o.data=p,e.abrupt("return",p);case 26:return e.abrupt("return",o.data);case 27:case"end":return e.stop()}},e)}))).apply(this,arguments)}var _e=function(e,t,n,r){return ke.apply(this,arguments)};function Se(){return(Se=t(s().mark(function e(t,n,r,a){var o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o="\n     proc append base=".concat(a.libref,".{output.name}  \n     data= ").concat(r.libref,".").concat(r.name,"; run;\n     "),e.next=3,le(t,n,o);case 3:return c=e.sent,i="completed"===c.SASJobStatus?0:1,e.abrupt("return",{msg:"Append Completed. Status is: ".concat(c.SASJobStatus),statusCode:i});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ce=function(e,t,n,r){return Se.apply(this,arguments)};function Te(){return(Te=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,d,b,m,h,y,v,g,x,w,k;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(p in a=r.data,o=r.table,c=r.where,i="proc sql; update ".concat(o.libref,".").concat(o.name),u="SET ",l=" ",a)u=u+l+p+"="+je(a[p]),l=", ";if(i=i+" "+u,f=" WHERE ",d=" ","string"==typeof c)f+=c;else for(b in c)m=c[b],h=je(m),f=f+d+b+"= ".concat(h," "),d=" AND ";return y=(i=i+" "+f+";run;").split(/\r?\n/),v={data:{code:y}},e.next=14,t.apiCall(n.links("execute"),v);case 14:return g=e.sent,x={qs:{newState:"Completed",timeout:1}},e.next=18,t.jobState(g,x);case 18:return w=e.sent,k="completed"===w.data?0:1,e.abrupt("return",{statusCode:k,msg:w.data});case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}function je(e){return null==e?".":"string"==typeof e?JSON.stringify(e):e.toString()}var Oe=function(e,t,n){return Te.apply(this,arguments)};function Ee(){return(Ee=t(s().mark(function e(t,n,r,a,o){var c,i,u,l,p,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(l in c="data ".concat(r.libref,".").concat(r.name,"; INFILE datalines delimiter=',' ;\n"),i="",u="INPUT ",o)p=o[l],u=u+p.Column+" ","CHAR"===p.Type&&(f=" ".concat(p.Column," $ ").concat(p.length," \n"),i=i+" "+f);return i.length>0&&(i="LENGTH "+i+";\n"),c=c+";\n"+i+(u+=";\n")+"datalines;\n"+a+"\n; run; proc print;run;\n",e.next=9,le(t,n,c);case 9:return e.abrupt("return",{msg:"done",statusCode:0});case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Re=function(e,t,n,r,a){return Ee.apply(this,arguments)};function Le(){return(Le=t(s().mark(function e(t,n){var r,a,o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.addServices("reports");case 2:return r=e.sent,a=r.reports,console.log(a),o=null,null!==n&&(o={qs:{filter:"eq(name,'".concat(n,"')")}}),console.log("-----------",a.links("reports")),e.next=10,t.apiCall(a.links("reports"),o);case 10:return c=e.sent,e.abrupt("return",0===c.itemsList().size?null:c);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var qe=function(e,t){return Le.apply(this,arguments)};function Ae(){return(Ae=t(s().mark(function e(t,n){var r,a,o,c,i,u,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rafObject("reportImages"),e.next=3,qe(t,n);case 3:if(null!==(a=e.sent)){e.next=6;break}return e.abrupt("return","".concat(n," was not found"));case 6:return o=a.itemsCmd(a.itemsList(0),"self","link","uri"),c={data:{reportUri:o,sectionIndex:0,layoutType:"entireSection",size:"400x400"}},e.next=11,t.apiCall(r.links("createJob"),c);case 11:return i=e.sent,e.next=14,t.jobState(i,{qs:{wait:1.5}},10,2);case 14:if("completed"===(u=e.sent).data){e.next=17;break}return e.abrupt("return","Job failed ".concat(u.data));case 17:return e.next=19,t.apiCall(u.job.itemsCmd(u.job.itemsList(0),"image"));case 19:return l=e.sent,e.abrupt("return",l.items());case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Pe=function(e,t){return Ae.apply(this,arguments)};function De(){return(De=t(s().mark(function e(t,n){var r,a;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qe(t,n);case 2:if(null!==(r=e.sent)){e.next=6;break}throw null==n?"No reports were found":"".concat(n," was not found");case 6:return a=[],r.items().map(function(e,t){var n={name:t,uri:r.itemsCmd(t,"self","link","uri")};a.push(n)}),e.abrupt("return",a);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ie=function(e,t){return De.apply(this,arguments)};function Ne(){return(Ne=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,d;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.tables[r],e.next=3,t.apiCall(a);case 3:return o=e.sent,e.next=6,t.apiCall(o.links("rowSet"));case 6:c=e.sent,i=c.items("columns"),u=c.items("rows"),l=[],p=u.size,f=s().mark(function e(){var t,n;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=u.get(d),n={},i.map(function(e,r){var a=e.toLowerCase();n[a]=t.get(r)}),l.push(n);case 4:case"end":return e.stop()}},e)}),d=0;case 13:if(!(d<p)){e.next=18;break}return e.delegateYield(f(),"t0",15);case 15:d++,e.next=13;break;case 18:return e.abrupt("return",l);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Fe=function(e,t,n){return Ne.apply(this,arguments)};function Je(){return(Je=t(s().mark(function e(t,n){var r;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=3;break}return e.next=3,t.logon(n);case 3:return e.next=5,t.addServices("jobExecution","compute","jobDefinitions");case 5:return r=e.sent,e.abrupt("return",r.jobExecution);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ue=function(e,t){return Je.apply(this,arguments)};function Me(){return(Me=t(s().mark(function e(t,n){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Qe=function(e,t){return Me.apply(this,arguments)};function ze(){return(ze=t(s().mark(function e(t,n,r){var a,o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.apiCall(n.links("create"),r);case 2:return a=e.sent,e.next=5,t.jobState(a,null,5,2);case 5:if("running"!==(o=e.sent).data){e.next=10;break}throw"ERROR: Job did not complete in allotted time";case 10:if("failed"!==o.data){e.next=14;break}throw JSON.stringify(o);case 14:return e.next=16,Qe(t,o.job);case 16:return c=e.sent,e.abrupt("return",c);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ge=function(e,t,n){return ze.apply(this,arguments)};function Be(){return(Be=t(s().mark(function e(t,n,r,a,o){var c,i,u,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c={},i={},null===a){e.next=6;break}return e.next=5,Ye(t,a);case 5:c.jobDefinitionUri=e.sent;case 6:return-0!=r&&(i.code=r),i.type="Compute",c.arguments=o,c.jobDefinition=i,u={data:c},e.next=13,Ge(t,n,u);case 13:return l=e.sent,e.abrupt("return",l);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ye(e,t){return He.apply(this,arguments)}function He(){return(He=t(s().mark(function e(t,n){var r,a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.getService("jobDefinitions"),r=null,a={qs:{filter:"eq(name,'".concat(n,"')")}},e.next=5,Ge(t,a);case 5:if(0!==(o=e.sent).itemsList().size){e.next=10;break}throw"Error: ".concat(n," not found in the system");case 10:r=o.itemsCmd(n,"self","link","uri");case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ve=function(e,t,n,r,a){return Be.apply(this,arguments)};function We(){return(We=t(s().mark(function e(t,n,r){var a,o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=n.service,o=0;case 2:if(!(o<r.length)){e.next=12;break}if(c=r[o],null!=n.steps[c]){e.next=9;break}return e.next=7,$e(t,a,c);case 7:i=e.sent,n.steps[c]=i;case 9:o++,e.next=2;break;case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ke=function(e,t,n){return We.apply(this,arguments)};function Xe(){return(Xe=t(s().mark(function e(t,n,r){var a,o,c,i,u;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={qs:{filter:"eq(name,'".concat(r.trim(),"')")}},e.next=3,t.apiCall(n.links("modules"),a);case 3:if(0!==(o=e.sent).itemsList().size){e.next=6;break}return e.abrupt("return",null);case 6:return c=o.itemsCmd(r,"steps"),e.next=9,t.apiCall(c);case 9:return i=e.sent,u={name:r,stepsRafLink:i,stepIds:o.items(r,"data","stepIds").toJS(),microanalyticScore:n},e.abrupt("return",u);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $e=function(e,t,n){return Xe.apply(this,arguments)};function Ze(){return(Ze=t(s().mark(function e(t,n,r){var a,o,c,i,u,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r){e.next=3;break}return e.next=3,t.logon(r);case 3:return e.next=5,t.addServices("microanalyticScore");case 5:a=e.sent,o=a.microanalyticScore,c={service:o,steps:{}},i=0;case 9:if(!(i<n.length)){e.next=18;break}return u=n[i],e.next=13,$e(t,o,u);case 13:l=e.sent,c.steps[u]=l;case 15:i++,e.next=9;break;case 18:return e.abrupt("return",c);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}var et=function(e,t,n){return Ze.apply(this,arguments)},tt=function(e,t,n,r){var a=e.steps[t];if(null===a)return[];var s=null;if(null==n){var o=a.stepIds.findIndex(function(e){return"execute"===e||"score"===e});if(-1===o)return[];s=a.stepIds[o];var c=a.stepsRafLink.items(s,"data","inputs"),i=a.stepsRafLink.items(s,"data","outputs");return null===c?[]:!0===r?{inputs:c.toJS(),outputs:i.toJS()}:c.toJS()}if(-1===a.stepIds.findIndex(function(e){return e===n}))return[];s=n;var u=a.stepsRafLink.items(s,"data","inputs"),l=a.stepsRafLink.items(s,"data","outputs");return null===u?[]:!0===r?{inputs:u.toJS(),outputs:l.toJS()}:u.toJS()};function nt(){return(nt=t(s().mark(function e(t,n,r,a,o,c){var i,u,l,p,f,d,b,m,h,y,v,g,x;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.steps[r],u=!1,l=[],!1===Array.isArray(a))for(p in a)f={name:p,value:a[p]},l.push(f);else u=!0;if(d={data:{inputs:!0===u?a:l}},b=null,null!=o){e.next=15;break}if(-1!==(m=i.stepIds.findIndex(function(e){return"execute"===e||"score"===e}))){e.next=12;break}return e.abrupt("return",[]);case 12:b=i.stepIds[m];case 13:e.next=21;break;case 15:if(-1!==i.stepIds.findIndex(function(e){return e===o})){e.next=20;break}return e.abrupt("return",[]);case 20:b=o;case 21:if(null==c&&(c="execute"),null!==(h=i.stepsRafLink.itemsCmd(b,c))){e.next=26;break}return y=[{name:"Error",type:"string",value:"name: ".concat(r," step: ").concat(o," operation: ").concat(c," is an invalid combination")}],e.abrupt("return",y);case 26:return e.next=28,t.apiCall(h,d);case 28:return v=e.sent,g=v.items("outputs").toJS(),!0===u?x=g:(x={},g.map(function(e){x[e.name]=e.value})),e.abrupt("return",x);case 32:case"end":return e.stop()}},e)}))).apply(this,arguments)}var rt=function(e,t,n,r,a,s){return nt.apply(this,arguments)};function at(){return(at=t(s().mark(function e(t,n,r){var a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,et(t,[n]);case 2:return a=e.sent,e.next=5,rt(t,a,n,r,"score","execute");case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var st=function(e,t,n){return at.apply(this,arguments)},ot={caslRun:h,caslRunBase:p,casSetup:j,casActionRun:E,casFetchData:L,casUpdateData:N,computeRun:le,computeSetup:fe,computeSummary:oe,computeFetchData:we,computeFileContent:_e,computeResults:be,findReport:qe,getReportImage:Pe,getReportUri:Ie,getSASTableRows:Fe,jesSetup:Ue,jesRun:Ve,jesSummary:Qe,jsonToDict:u,casTableToJson:Q,caslScore:w,caslDescribe:C,masSetup:et,masAddModel:Ke,masDescribe:tt,masRun:rt}}(),r}()});