/*! For license information please see restaflib.esm.min.js.LICENSE.txt */
var e={125(e,t,n){var r=n(590);function a(){var t,n,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",c=s.toStringTag||"@@toStringTag";function u(e,a,s,o){var c=a&&a.prototype instanceof l?a:l,u=Object.create(c.prototype);return r(u,"_invoke",function(e,r,a){var s,o,c,u=0,l=a||[],p=!1,f={p:0,n:0,v:t,a:b,f:b.bind(t,4),d:function(e,n){return s=e,o=0,c=t,f.n=n,i}};function b(e,r){for(o=e,c=r,n=0;!p&&u&&!a&&n<l.length;n++){var a,s=l[n],b=f.p,d=s[2];e>3?(a=d===r)&&(c=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=t):s[0]<=b&&((a=e<2&&b<s[1])?(o=0,f.v=r,f.n=s[1]):b<d&&(a=e<3||s[0]>r||r>d)&&(s[4]=e,s[5]=r,f.n=d,o=0))}if(a||e>1)return i;throw p=!0,r}return function(a,l,d){if(u>1)throw TypeError("Generator is already running");for(p&&1===l&&b(l,d),o=l,c=d;(n=o<2?t:c)||!p;){s||(o?o<3?(o>1&&(f.n=-1),b(o,c)):f.n=c:f.v=c);try{if(u=2,s){if(o||(a="next"),n=s[a]){if(!(n=n.call(s,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,o<2&&(o=0)}else 1===o&&(n=s.return)&&n.call(s),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);s=t}else if((n=(p=f.n<0)?c:e.call(r,f))!==i)break}catch(e){s=t,o=1,c=e}finally{u=1}}return{value:n,done:p}}}(e,s,o),!0),u}var i={};function l(){}function p(){}function f(){}n=Object.getPrototypeOf;var b=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),d=f.prototype=l.prototype=Object.create(b);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,c,"GeneratorFunction")),e.prototype=Object.create(d),e}return p.prototype=f,r(d,"constructor",f),r(f,"constructor",p),p.displayName="GeneratorFunction",r(f,c,"GeneratorFunction"),r(d),r(d,c,"Generator"),r(d,o,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(e.exports=a=function(){return{w:u,m}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},192(e,t,n){var r=n(541)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},251(e,t,n){var r=n(632),a=n(590);e.exports=function e(t,n){function s(e,a,o,c){try{var u=t[e](a),i=u.value;return i instanceof r?n.resolve(i.v).then(function(e){s("next",e,o,c)},function(e){s("throw",e,o,c)}):n.resolve(i).then(function(e){u.value=e,o(u)},function(e){return s("throw",e,o,c)})}catch(e){c(e)}}var o;this.next||(a(e.prototype),a(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),a(this,"_invoke",function(e,t,r){function a(){return new n(function(t,n){s(e,r,t,n)})}return o=o?o.then(a,a):a()},!0)},e.exports.__esModule=!0,e.exports.default=e.exports},423(e,t,n){var r=n(998).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},541(e,t,n){var r=n(632),a=n(125),s=n(857),o=n(691),c=n(251),u=n(769),i=n(423);function l(){var t=a(),n=t.m(l),p=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function f(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))}var b={throw:1,return:2,break:3,continue:3};function d(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,b[e],t)},delegateYield:function(e,a,s){return t.resultName=a,n(r.d,i(e),s)},finish:function(e){return n(r.f,e)}},n=function(e,n,a){r.p=t.prev,r.n=t.next;try{return e(n,a)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(e.exports=l=function(){return{wrap:function(e,n,r,a){return t.w(d(e),n,r,a&&a.reverse())},isGeneratorFunction:f,mark:t.m,awrap:function(e,t){return new r(e,t)},AsyncIterator:c,async:function(e,t,n,r,a){return(f(t)?o:s)(d(e),t,n,r,a)},keys:u,values:i}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports},590(e){function t(n,r,a,s){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}e.exports=t=function(e,n,r,a){function s(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(s("next",0),s("throw",1),s("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r,a,s)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},632(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},691(e,t,n){var r=n(125),a=n(251);e.exports=function(e,t,n,s,o){return new a(r().w(e,t,n,s),o||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},769(e){e.exports=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},857(e,t,n){var r=n(691);e.exports=function(e,t,n,a,s){var o=r(e,t,n,a,s);return o.next().then(function(e){return e.done?e.value:o.next()})},e.exports.__esModule=!0,e.exports.default=e.exports},998(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}function r(e,t,n,r,a,s,o){try{var c=e[s](o),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(a,s){var o=e.apply(t,n);function c(e){r(o,a,s,c,u,"next",e)}function u(e){r(o,a,s,c,u,"throw",e)}c(void 0)})}}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s=n(192),o=n.n(s);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e){var t="{ ",n=" ";for(var r in e){if(!0===Array.isArray(e[r])){var a=i(e[r]);t=t+n+"".concat(r,"=")+a}else{var s=c(e[r]);if("object"===s){var o=u(e[r]);t=t+n+"".concat(r,"=")+o}else t=t+n+"".concat(r,"=")+("string"===s?' "'.concat(e[r],'" '):"".concat(e[r],"  "))}n=","}return t+"} "}function i(e){for(var t="{",n=" ",r=e.length,a=0;a<r;a++)if(!0===Array.isArray(e[a])){var s=i(e[a]);t=t+n+"".concat(a,"=")+s}else{var o=c(e[a]);t="object"===o?t+n+u(e[a]):t+n+("string"===o?' "'.concat(e[a],'" '):"".concat(e[a],"  ")),n=","}return t+"}"}const l=function(e,t){var n;return n=null===e?"{}":!0===Array.isArray(e)?i(e):u(e),"".concat(t," = ").concat(n,";")};function p(){return p=a(o().mark(function e(t,n,r,a){var s,c,u,i,p,f,b,d=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(s=l(null!==a?a:{},"_args_"),c=(c=s+" "+r).replace(/\r?\n|\r/g,""),u={action:"sccasl.runcasl",data:{code:c}},i=d.length,p=new Array(i>4?i-4:0),f=4;f<i;f++)p[f-4]=d[f];return e.next=1,t.runAction.apply(t,[n,u].concat(p));case 1:return b=e.sent,e.abrupt("return",b);case 2:case"end":return e.stop()}},e)})),p.apply(this,arguments)}const f=function(e,t,n,r){return p.apply(this,arguments)},b=function(){return"\n    print _args_;\n\n    results = casFetchRows(_args_.table.caslib, _args_.table.name , _args_.start + 1, _args_.limit,  _args_.format, _args_.where);  \n    send_response({casResults = results});  \n        \n    function casFetchRows(caslib, name, from, count, format, where) ;    \n     \n       rc = checkAndLoadTable(caslib, name);\n    \n       if (rc ne true) then do;\n        text = 'Unable to access ' ||caslib||'.'||name;   \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        exit(rx);  \n        end;  \n\n        /*\n         * get tableoinfo to get rowCount\n         */\n\n        action table.tableinfo r= result/    \n            caslib = caslib    \n            name   = name;    \n     \n        rowCount = result.TableInfo[1, 'rows'];\n        to = from + count - 1;\n\n        \n        /*\n         * get column information\n         */\n\n        action table.columninfo r=infoResult /\n            table = {caslib=caslib name=name};\n\n        columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}};\n        i = 2;\n        do c over inforesult.columninfo;\n           columns[i] = c;\n           i = i + 1;\n        end;\n        \n        /*\n         * Fetch the current set of rows\n         */\n\n        rows = {};\n        if (from <=  rowCount) then do;\n          action table.fetch r = result status=rcx/    \n              table = {caslib=caslib, name=name where=where}   \n              from= from to=to format=format  sastypes=true\n              ;\n          if (rcx.severity eq 2) then do;\n            exit(rcx);\n          end;\n          /* \n          * create payload to return\n          */\n\n          i = 1;\n          rows ={};\n          do row over result.fetch;\n            rr = {};\n            j = 1;\n            do key,v  over row;\n              rr[j] = override(columns[j].Type, v);\n              j = j + 1;\n            end;\n            rows[i] = rr;\n            i = i + 1;\n          end;\n        end;\n\n        currentCount = DIM(rows);\n        pagination = {};   \n        table = {caslib=caslib, name=name};\n\n        pagination = setPagination(from, count, format, where, currentCount, rowCount, table);\n    \n        lastRequest={start=from-1, limit=count, format=format, currentCount=currentCount, \n                     rowCount=rowCount, where=where, table=table, version='3'};\n       scrollOptions = getKeys(pagination);\n       return( \n         {pagination = pagination, data = {schema=columns, rows=rows , scrollOptions=scrollOptions}, lasRequest=lastRequest}\n         );\n    end;    \n    \n    \n    /*\n     * For non-primary column types set new content\n     */\n\n    function setPagination(from, count, format, where,  currentCount, rowCount, table);\n\n\n      prevStart = max(from - count - 1, 0);\n\n      if (currentCount lt count) then do; \n        pagination.prev = {start=prevStart, limit=count, format=format, where=' ', table=table};\n        if (prevStart ne 0) then do;\n          pagination.first = {start=0, limit=count, format=format, where=' ', table=table};\n        end; \n      return pagination;\n      end;\n      currentStart = from -1;\n      if (currentStart eq 0) then do;\n         pagination.next = {start=count, limit=count, format=format, where=' ', table=table};\n         return pagination;\n      end;\n\n      nextStart = currentStart + count;\n      pagination.next = {start=nextStart, limit=count, format=format, where=' ', table=table};\n      pagination.prev = {start=prevStart, limit=count, format=format, where=' ', table=table};\n      if (prevStart ne 0) then do;\n        pagination.first = {start=0, limit=count, format=format, where=' ', table=table};\n      end; \n      return pagination;\n  end;\n\n\n\n\n    function override(type, iv);\n      if (type EQ 'varbinary')       then v = '...varbinary';\n      else if (type EQ  'blob')      then v = '...blob';\n      else if (type EQ 'table')      then v = '...table';\n      else if (type EQ 'dictionary') then v = '...dictionary';\n      else if (type EQ 'list')       then v = '...list';\n      else if (type EQ 'isArray')    then v = '...array';\n      else v = iv;\n      return v;\n      end;\n\n      \n    "},d=function(){return"\n    function checkAndLoadTable(caslib, name);   \n        \n                /* verify caslib is there */\n                 table.queryCaslib status=status result=result/\n                    caslib = caslib;\n                do k,v over result;   /* to handle casuser[user] */                       \n                   rc = v;\n                end;\n                if ( rc eq false ) then \n                   return -1;\n                /*    \n                * Check to see if table is already loaded   \n                */   \n                action table.tableExists r=result/    \n                    caslib = caslib    \n                    name  = name;    \n                /*   \n                * if not loaded then try to load it   \n                */   \n                rc = true;\n                if (result.exists eq 0 or result.exists eq 2) then do;   \n                    path = lookupPath(caslib, name);\n                    if (path eq '*') then do;\n                       rc = false;\n                    end;\n                    else do;\n                        action table.loadTable status=status/    \n                            caslib = caslib    \n                            source = path    \n                            casout={caslib= caslib name=name}; \n                        if (status.statusCode ne 0 ) then rc = false;\n                    end; \n                end;        \n                return rc;  \n            end;   \n        \n        function saveAndLoadTable(caslib, source, targetlib, targetname,promote);\n        \n                /* load source */\n                r = checkAndLoadTable(caslib, source);\n        \n                sashdat = target||\".sashdat\";\n                table.save /\n                    caslib= targetlib name=sashdat\n                    table = {caslib=caslib name=source} replace=true;\n                \n                table.droptable /\n                    caslib=targetlib name=target quiet=true;\n                \n                table.loadtable result=r status=rc/\n                    caslib=targetlib casout={caslib=targetlib name=target replace=TRUE}\n                    path=sashdat;\n        \n                if (promote eq true) then do;\n                    table.promote result=r status=rc/\n                      caslib=caslib name=target quiet=true\n                      targetLib=caslib target=target;\n                end;\n                if (rc.severity eq 2) then do;\n                    print rc;\n                    print 'Ignoring error';\n                    end;\n                r = 0;\n                return r;\n        \n         end;\n        \n    function lookupPath(caslib, name ) ; \n            table.fileInfo r = result/\n            caslib=caslib; \n        \n            names = result.fileInfo[,4]; \n            nameu = upcase(name)||'.SASHDAT'; \n            cpath = '*'; \n            count = 0; \n        \n            do n over names; \n                if (upcase(n) eq nameu)  then do; \n                    count = count + 1; \n                    if ( cpath eq '*') then do; \n                        cpath = n; \n                    end; \n                end; \n            end; \n            \n            if (count GT 1 ) then do; \n                print 'Warning: ' count 'Files with names only different in case exist - First one chosen';\n                print 'Path: ' cpath ' will be used****';  \n            end; \n            r = cpath; \n            return r; \n        end; \n            /*-----------------------------------------*/ \n            /* isModel: is it model table              */  \n            /*-----------------------------------------*/  \n         \n            function isModel(caslib, name) ; \n                 table.columnInfo r = result /  \n                        table = {caslib=caslib , name=name};  \n                 validTable = false; \n                 mtype = 'bad'; \n                 do c over result.columninfo;  \n                    cu = upCase(c.Column); \n                    if ( cu eq 'DATASTEPSRC') then do; \n                       mtype = 'ds'; \n                    end; \n                    else if ( cu eq '_STATE_' ) then do; \n                      mtype = 'astore'; \n                    end; \n                    else if (cu eq 'MODELMETADATA') then do; \n                      mtype = 'ds2'; \n                    end; \n                end;  \n                print 'Specified model type: ' || mtype; \n                return mtype; \n            end; \n         \n    /*-----------------------------------------*/ \n            /* Returns contents of the specified table */  \n            /*-----------------------------------------*/  \n         \n            function contents(caslib, name) ;    \n                table.columnInfo r = result /  \n                        table = {caslib=caslib , name=name};  \n               /* columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}}; */ \n                i = 1;  \n                columns = {}; \n                do c over result.columninfo;  \n                    columns[i] = c;  \n                    i = i + 1;  \n                end;  \n                return {describe = columns, table = {}};   \n            end;  \n    \n           /*------------------------------------------*/  \n            /* Returns unique values                   */  \n            /*-----------------------------------------*/  \n         \n            function selectionLists(idvars,caslib, name, where);   \n                 \n                s = checkAndLoadTable(caslib, name);   \n                if ( s ne true) then do;   \n                results = {Errors= 'Unable to access ' ||caslib||'.'||name, statusCode = s};   \n              \n                end;   \n                print idvars;\n                do k over idvars;   \n                r  = _getValues(k, caslib, name, where);   \n                results[k] = r;   \n                end;   \n                return { data=results, statusCode=0};   \n            end;   \n           function _getValues(id, caslib, name, where) ;   \n                             \n                action table.dropTable/   \n                caslib='casuser' name='dtemp1' quiet=TRUE;   \n                     \n                action table.deleteSource status=src /   \n                caslib='casuser' source= 'dtemp1.sashdat' quiet=TRUE;   \n                     \n                action simple.groupby result=r status=rc/   \n                    aggregator = 'N'   \n                    inputs     = {id}   \n                    table      = {caslib=caslib name=name, where=where}   \n                    casout     = {caslib='casuser' name='dtemp1'}   \n                ;   \n                action table.fetch result=r/   \n                    table={caslib='casuser' name='dtemp1'}    \n                    sortby={{name=id,  order='ascending'}};   \n                result = r.Fetch[,2];   \n                return result;   \n                end;  \n            /*------------------------------------------*/ \n            /* get a record                             */ \n            /*------------------------------------------*/ \n         \n            function _fetchData(filter, table); \n                s = checkAndLoadTable(table.caslib, table.name);   \n                if ( s ne 0 ) then do;   \n                    results = {Errors= 'Unable to access ' ||table.caslib||'.'||table.name};   \n                    return results;   \n                    end;   \n                wherex = dictTowhere(filter);   \n               /* wherex = table.caslib||'.'||table.name||'(where=('||wherex||'));';  \n                 \n                destroyTable('casuser', 'input');  \n         \n                action datastep.runCode r=result status=rc/   \n                    single='yes'   \n                    code = 'data casuser.input; set ' || wherex||'run;';  \n                    */ \n                     \n                action table.fetch r = result /   \n                    table={caslib=table.caslib name=table.name where=wherex};   \n             \n                rows = resultsToDict(result.Fetch);   \n                return {scenario = rows, table = result.Fetch};   \n         \n            end; \n    function destroyTable(caslib,name);   \n                action table.dropTable/   \n                caslib=caslib name=name quiet=TRUE;   \n                         \n                action table.deleteSource status=src /   \n                caslib=caslib source= name||'.sashdat' quiet=TRUE;   \n                     \n            return true;   \n            end;   \n                 \n                 \n            function dictToWhere(filter);   \n                where ='';   \n                andbit='  ';   \n                do k,v over filter;   \n                    if (isString(v) ) then do;   \n                        where = where || andbit || k ||  ' eq ' || '\"'||v||'\"';   \n                    end;    \n                    else do;   \n                        where = where || andbit || k ||  ' eq ' || v ;   \n                    end;   \n                andbit =' and ';   \n                end;   \n            return where;   \n            end;   \n                 \n            function resultsToDict(r);   \n                casResults = {};   \n                i = 1;   \n                do row over r;   \n                casResults[i] = row;   \n                i = i + 1;   \n                end;   \n                return casResults;   \n            end;   \n             \n            function argsToTable(_arg_, caslib, name );   \n                action table.droptable/  \n                    caslib=caslib name=name quiet=TRUE;  \n                i = 1;  \n                do key,obj over _arg_;  \n                    columns[i] = key;  \n                    row[i] = obj;  \n                    if ( isString(obj) ) then  \n                        type[i] = 'varchar';   \n                    else if ( isInteger(obj) ) then   \n                        type[i] = 'int';   \n                    else type[i] = 'double';  \n                    i = i + 1;  \n                    end;    \n                 \n                data1 = newTable('data1', columns, type, row );   \n                 \n                saveresult data1 casout=name caslib=caslib replace;   \n            end; \n    \n        function saveAndPromoteTable(caslib, target, source);\n            sashdat = target||\".sashdat\";\n            rc = checkAndLoadTable(caslib, source);\n            table.droptable /\n                caslib=caslib name=target quiet=true;\n        \n            table.save /\n                caslib= caslib name=sashdat\n                table = {caslib=caslib name=source} replace=true;\n            \n            table.loadtable result=r/\n                caslib=caslib casout={caslib=caslib name=target replace=TRUE}\n                path=sashdat;\n        \n            table.promote result=r status=rc/\n                caslib=caslib name=target quiet=true\n                targetLib=caslib target=target;\n            print rc;\n            r = rc.severity;\n            if (rc.severity gt 0) then do;\n              print rc;\n              print 'Ignoring error';\n              rc = 0;\n            end;\n        \n            return r;\n         end;  \n       \n     "},m=b,h=function(){return"\n  results = casFetchRows(_args_.table.caslib, _args_.table.name , _args_.from, _args_.count,  _args_.format, _args_.where);   \n  send_response({casResults = results});  \n      \n  function casFetchRows(caslib, name, from, count, format, where) ;    \n   \n     rc = checkAndLoadTable(caslib, name);\n  \n     if (rc ne true) then do;\n      text = 'Unable to access ' ||caslib||'.'||name;   \n      rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n      exit(rx);  \n      end;  \n\n      /*\n       * get all table to get rowCount\n       */\n\n      action table.tableinfo r= result/    \n          caslib = caslib    \n          name   = name;    \n   \n      rowCount = result.TableInfo[1, 'rows'];    \n     \n      to       = from + count - 1;   \n      \n      /*\n       * get column information\n       */\n\n      action table.columninfo r=infoResult /\n          table = {caslib=caslib name=name};\n\n      columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}};\n      i = 2;\n      do c over inforesult.columninfo;\n         columns[i] = c;\n         i = i + 1;\n      end;\n      \n      /*\n       * Fetch the current set of rows\n       */\n     /* wherex = dictTowhere(where); let user send in the where clause */\n      print where;\n\n      action table.fetch r = result /    \n          table = {caslib=caslib, name=name where=where}   \n          from= from to=to format=format  sastypes=true\n          ;\n\n      /* \n       * create payload to return\n       */\n\n      i = 1;\n      rows ={};\n      do row over result.fetch;\n        rr = {};\n        j = 1;\n        do key,v  over row;\n          rr[j] = override(columns[j].Type, v);\n          j = j + 1;\n        end;\n        rows[i] = rr;\n        i = i + 1;\n      end;\n\n      pagePrev = max(from - count, 1);\n     \n      if ( to eq rowCount ) then do;    \n          pageNext = -1;    \n      end;    \n      else do ;    \n          pageNext = min(to + 1, rowCount);    \n      end;   \n      table = {caslib=caslib, name=name};\n      pagination = {next= {from=pageNext, count=count, format=format, where=where table=table}, prev={from=pagePrev, count=count, format=format, where=where, table=table}};\n      pagination.current = {from = from, to=to, rowCount=rowCount, version=1};\n      return( \n       {pagination = pagination, data = {schema=columns, rows=rows }}\n       );\n  end;    \n  \n  \n  /*\n   * For non-primary column types set new content\n   */\n\n  function override(type, iv);\n    if (type EQ 'varbinary')       then v = '...varbinary';\n    else if (type EQ  'blob')      then v = '...blob';\n    else if (type EQ 'table')      then v = '...table';\n    else if (type EQ 'dictionary') then v = '...dictionary';\n    else if (type EQ 'list')       then v = '...list';\n    else if (type EQ 'isArray')    then v = '...array';\n    else v = iv;\n    return v;\n    end;\n\n    \n  "},y=function(){return"\n        result = runMain(_args_); \n        send_response(result); \n        /* print result; */\n     \n     \n        function runMain(_args_) ; \n            r = {Error= 'No path'};   \n            if ( _args_.path eq '/selectors') then do;   \n                r = selectionLists(_args_.selectors, _args_.table.caslib, _args_.table.name);   \n            end;   \n            else if ( _args_.path eq '/contents') then do;  \n                r = contents(_args_.table.caslib, _args_.table.name);  \n            end;  \n            else if (_args_.path eq '/describe') then do; \n               r = describeModel(_args_); \n            end; \n            else if (_args_.path eq '/scenario' ) then do;\n              r = fetchData(_args_.filter, _args_.table);\n            end;\n            else if (_args_.path eq '/score') then do;  \n                if( exists(_args_, 'modelName')  eq false ) then\n                  modelname = '';\n                else modelName =_args_.modelName;\n                r =  runScoreCode(_args_.model,  _args_.scenario, modelName);   \n            end;   \n            else do; \n              r = {icasResults={Errors = 'Invalid action option specified' || _args_.path}, statusCode=404}; \n            end; \n            print r;\n            if ( r.statusCode ne 0) then do;\n              print r.icasResults;\n              exit({severity=2,reason=6, status=r.iCasResults.Errors,statusCode=r.statusCode});\n            end;\n            result = {casResults = r.icasResults};  \n            print '***************************************************************';  \n            print result;  \n            print '***************************************************************';  \n            return result;  \n        end; \n     \n        /*-----------------------------------------*/ \n        /* describeModel                           */ \n        /*-----------------------------------------*/ \n     \n        function describeModel(_args_) ; \n            s = checkAndLoadTable(_args_.model.caslib, _args_.model.name);   \n            if ( s ne true) then do;   \n                results = {Errors= 'Unable to access ' ||_args_.model.caslib||'.'||_args_.model.name};   \n                return {icasResults=results, statusCode=404};  \n                end; \n     \n            mtype = isModel(_args_.model.caslib, _args_.model.name); \n            if ( mtype EQ 'astore' ) then do; \n               r = astoreDescribe(_args_.model); \n            end; \n            else if (mtype EQ 'ds' or mtype EQ 'ds2') then do;\n               s = checkAndLoadTable(_args_.table.caslib, _args_.table.name);   \n              if ( s ne true ) then do;   \n                results = {Errors= 'Unable to access ' ||_args_.table.caslib||'.'||_args_.table.name};   \n                return {icasResults=results, statusCode=404};  \n                end; \n               r = contents( _args_.table.caslib, _args_.table.name); \n            end; \n         return {icasResults= r, statusCode=0} ;\n        end;             \n       \n        /*------------------------------------------*/ \n        /* astoreDescribe                           */ \n        /*------------------------------------------*/ \n     \n        function astoreDescribe(model); \n          action astore.describe r=result/ \n              rstore = { caslib= model.caslib name = model.name }; \n          rows = resultsToDict(result.InputVariables); \n          return {describe = rows, table = result.InputVariables}; \n        end; \n     \n        /*------------------------------------------*/  \n        /* score                                    */  \n        /*------------------------------------------*/  \n        function runScoreCode( model, scenario, modelName);   \n            print model; \n            s = checkAndLoadTable(model.caslib, model.name);   \n            if ( s ne true ) then do;   \n                results = {Errors= 'Unable to access ' ||model.caslib||'.'||model.name};   \n                return {icasResults=results, statusCode=404};   \n                end;\n             \n            mtype = isModel(model.caslib, model.name); \n     \n            if ( mtype eq 'bad' ) then do; \n               results = {Error= model.caslib||'.'||model.name || ' is not recognized as a valid supported model. Please check your values'};\n               return {icasResults=results, statusCode=400};\n              end; \n            destroyTable('casuser', 'input');   \n            argsToTable(scenario, 'casuser', 'input'); \n     \n            destroyTable('casuser', 'output');   \n     \n            if (mtype eq 'astore') then do; \n                print 'Scoring with astore'; \n                action astore.score r = result/   \n                    rstore = {caslib=model.caslib name=model.name}   \n                    out    = {caslib='casuser' name='output'}   \n                    table  = {caslib='casuser' name='input'};   \n            end; \n            else if (mtype eq 'ds') then do; \n                print 'scoring with datastep code'; \n                action datastep.runcodetable r = result/   \n                    single='YES'   \n                    codeTable= {caslib=model.caslib name=model.name}   \n                    casout = {caslib='casuser' name='output'}   \n                    table = {caslib='casuser' name='input'};   \n            end;  \n            else if (mtype eq 'ds2' ) then do; \n               print 'Scoring with d2'; \n               if ( missing(modelName) eq true) then do;\n                  results = {Error= 'modelName is missing. Please check your values'};\n                  return {icasResults=results, statusCode=400};\n               end;\n\n               action ds2.runModel r = result/ \n                  modelTable = {caslib=model.caslib, name=model.name} \n                  modelName = modelName \n                  table = {caslib= 'casuser', name='input'} \n                  casOut = {caslib= 'casuser' name='output'}; \n               end; \n     \n             \n            action table.fetch r = result /   \n                table={caslib='casuser' name='output'};   \n             \n            rows = resultsToDict(result.Fetch);   \n            \n            return {icasResults= rows, statusCode=0} ;\n        end;   \n             \n        \n    "},x=function(){return"\n    rc = checkAndLoadTable(_args_.masterTable.caslib, _args_.masterTable.name);\n\n    if (rc ne true) then do;\n        text = 'Unable to access ' ||_args_.masterTable.caslib||'.'||_args_.masterTable.name;   \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        exit(rx); \n    end; \n    \n    rc = checkAndLoadTable(_args_.setTable.caslib, _args_.setTable.name);\n    if (rc ne true) then do;\n        text = 'Unable to access ' ||_args_.setTable.caslib||'.'||_args_.setTable.name; \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        return rx;\n    end;\n\n\n    setdata = _args_.setTable.caslib ||'.'||_args_.setTable.name;\n    masterdata = _args_.masterTable.caslib ||'.'||_args_.masterTable.name;\n\n    action datastep.runCode r=result status=rc/\n     code='data ' ||masterdata||'(append=YES);set ' || setdata ||'; run;';\n\n    if (rc.statusCode ne 0) then do;\n      exit(rc);\n    end; \n    else do;\n     results = {msg= 'Append succeeded', statusCode=true};\n     end;\n    \n    send_response({casResults = results});\n    "};function v(){return v=a(o().mark(function e(t,n,r,a,s){var c,u,i,l,p,b=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(c=r,!1!==s&&(c=d()+" "+r),u=b.length,i=new Array(u>5?u-5:0),l=5;l<u;l++)i[l-5]=b[l];return e.next=1,f.apply(void 0,[t,n,c,a].concat(i));case 1:return p=e.sent,e.abrupt("return",p.items().toJS());case 2:case"end":return e.stop()}},e)})),v.apply(this,arguments)}const w=function(e,t,n,r,a){return v.apply(this,arguments)};function g(e,t,n){return(t=function(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function S(){return(S=a(o().mark(function e(t,n,r){var a,s,c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=d()+" "+y(),s=_({path:"/score"},r),e.next=1,f(t,n,a,s);case 1:return c=e.sent,u=c.items("results","casResults").toJS()[0],e.abrupt("return",u);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const O=function(e,t,n){return S.apply(this,arguments)};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function T(){return(T=a(o().mark(function e(t,n,r){var a,s,c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=d()+" "+y(),s=j({path:"/describe"},r),e.next=1,f(t,n,a,s);case 1:return c=e.sent,u=c.items("results").toJS(),e.abrupt("return",u);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const E=function(e,t,n){return T.apply(this,arguments)};function R(){return(R=a(o().mark(function e(t,n,r,a){var s,u,i,l,p,f,b,d,m,h;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=2;break}return e.next=1,t.logon(n);case 1:e.sent;case 2:return e.next=3,t.addServices("casManagement");case 3:return s=e.sent,u=s.casManagement,e.next=4,t.apiCall(u.links("servers"));case 4:if(0!==(i=e.sent).itemsList().size){e.next=5;break}throw{Error:"No cas servers were found"};case 5:if(l=null,null!=a){e.next=6;break}l=i.itemsList(0),e.next=8;break;case 6:if(p=i.itemsList().toJS(),-1!==(f=p.findIndex(function(e){return e===a}))){e.next=7;break}throw{Error:"server with name of ".concat(a," was not found")};case 7:l=i.itemsList(f);case 8:if(b=null,null!=r){e.next=10;break}return e.next=9,t.apiCall(i.itemsCmd(l,"createSession"));case 9:b=e.sent,e.next=15;break;case 10:if("object"!==c(r)){e.next=11;break}b=r,e.next=15;break;case 11:return d={qs:{filter:"eq( id,'".concat(r,"')")}},e.next=12,t.apiCall(i.itemsCmd(l,"sessions"),d);case 12:if(0!==(m=e.sent).items().size){e.next=13;break}throw"ERROR: The sessionID ".concat(r," was not found.");case 13:return h=m.itemsCmd(m.itemsList(0),"self"),e.next=14,t.apiCall(h);case 14:b=e.sent;case 15:return e.abrupt("return",{servers:i,session:b});case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}const P=function(e,t,n,r){return R.apply(this,arguments)};function q(){return q=a(o().mark(function e(t){var n,r,a,s,c=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=c.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=c[a];return e.next=1,t.runAction.apply(t,r);case 1:return s=e.sent,e.abrupt("return",s.items().toJS());case 2:case"end":return e.stop()}},e)})),q.apply(this,arguments)}const A=function(e){return q.apply(this,arguments)};function L(){return(L=a(o().mark(function e(t,n,r){var a,s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=d()+" "+m(),e.next=1,f(t,n,a,r);case 1:return s=e.sent,e.abrupt("return",s.items("results","casResults").toJS());case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const D=function(e,t,n){return L.apply(this,arguments)};function I(){return(I=a(o().mark(function e(t,n,r){var a,s,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null==r.where&&(r.where=" "),a=d()+" "+h(),e.next=1,f(t,n,a,r);case 1:return s=e.sent,null==(c=s.items("results","casResults").toJS()).data&&(c.data={rows:[]}),e.abrupt("return",c);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const N=function(e,t,n){return I.apply(this,arguments)};function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function F(){return(F=a(o().mark(function e(t,n,r){var a,s,c,u,i,l,p,f,b,d,m,h,y,x,v,w,g;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(l in a=r.data,s=r.where,c=r.table,u="",i=" ",s)p=s[l],f="string"==typeof p?"'".concat(p.toString(),"'"):p,u=u+i+l+"= ".concat(f," "),i=" AND ";for(d in b=[],a)m=a[d],void 0,h=null==m?".":"string"==typeof m?JSON.stringify(m):m.toString(),b.push({var:d,value:h});return y=U(U({},c),{},{where:"".concat(u)}),x={action:"table.update",data:{table:y,set:b}},e.next=1,t.runAction(n,x);case 1:return v=e.sent,w={msg:"Update completed",statusCode:0},0!==(g=v.items().toJS().disposition).statusCode&&(w.statusCode=g.statusCode,w.msg=g.reason),e.abrupt("return",w);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const M=function(e,t,n){return F.apply(this,arguments)};function Q(){return(Q=a(o().mark(function e(t,n,r,a,s){var c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.caslib,u=r.name,'\n   table.save /\n    replace=true\n      table = {caslib="'.concat(c,'" name="').concat(u,'"}\n    caslib="').concat(c,'" name="').concat(u,'.sashdat";\n\n  /* clean up before promoting the table */\n  table.droptable /\n      caslib="').concat(c,'" name="').concat(u,'" ;\n\n  /* promote the table to make it available for further analysis */\n  table.loadTable status=status r=rc/\n    caslib="').concat(c,'",\n    path="').concat(u,'.sashdat",\n    casout={name="').concat(u,'", caslib="').concat(c,'" promote=True};\n    run;\n\t'),e.abrupt("return",{msg:"".concat(c,".").concat(u," saved}"),statusCode:0});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}const z=function(e,t,n,r,a){return Q.apply(this,arguments)};function G(){return(G=a(o().mark(function e(t,n,r,a,s,c){var u,i,l,p;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=d()+" "+x(),i={masterTable:a,setTable:r,save:null==s||s,promote:null!=c&&c},e.next=1,f(t,n,u,i);case 1:if(l=e.sent,p=l.items("results","casResults").toJS(),!0!==s){e.next=2;break}return e.next=2,z(t,n,a);case 2:return e.abrupt("return",p);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}const B=function(e,t,n,r,a,s){return G.apply(this,arguments)},H=function(e,t){var n=e.items("tables",t),r=n.get("rows"),a=[];n.get("schema").map(function(e){a.push(e.get("name"))});var s=[];return r.map(function(e){var t={};e.map(function(e,n){t[a[n]]=e}),s.push(t)}),s};function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Y(){return(Y=a(o().mark(function e(t,n,r,a){var s,c,u,i,l;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=a.output,c=s.caslib,null!=(u=s.name)){e.next=1;break}throw"Please specify table as caslib.name";case 1:return u=u.toLowerCase(u),i="\n      action table.droptable /\n       caslib= '".concat(c,"'  name= '").concat(u,"' quiet=true;\n\n      action table.deleteSource/\n      caslib= '").concat(c,"'  source= '").concat(u,".sashdat' quiet=true;   \n      "),l={action:"sccasl.runcasl",data:{code:i}},e.next=2,t.runAction(n,l);case 2:return l={action:"astore.upload",data:{rstore:{name:"".concat(u),caslib:"".concat(c),replace:!0},store:r}},e.next=3,t.runAction(n,l);case 3:return e.sent,e.abrupt("return","Upload of ".concat(a.source," to ").concat(c,".").concat(u," completed"));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const V=function(e,t,n,r){return Y.apply(this,arguments)};function X(){return(X=a(o().mark(function e(t,n,r,a,s){var c,u,i,l,p,f,b;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=a.output,u=c.caslib,null!=(i=c.name)){e.next=1;break}throw"Please specify table as caslib.name";case 1:return e.next=2,K(t,n,u,i);case 2:return e.sent,l={casout:{caslib:u,name:i},importOptions:{fileType:a.fileType}},"sas"!==a.fileExt&&"ds2"!==a.fileExt||(l.importOptions.delimiter="\\"),p={headers:{"JSON-Parameters":l,"Content-Type":"binary/octet-stream"},data:r,action:"table.upload"},e.next=3,t.runAction(n,p);case 3:if(f=e.sent,!0!==s){e.next=5;break}return b="\n\t\t\n\t\t\taction table.save r = result / \n\t\t\t\ttable = {caslib='".concat(u,"' name='").concat(i,"'} \n\t\t\t\tcaslib='").concat(u,"' name='").concat(i,"' replace=true;\n\t\t\t\n\t\t\taction table.loadTable r = result2 /\n\t\t\t\tcaslib='").concat(u,"' casout={caslib='").concat(u,"' name='").concat(i,"' replace=true} \n\t\t\t\tpath='").concat(i,".sashdat' ;\n\n\t\t\n\t\t    send_response({status=result2});\n\t\t\t"),e.next=4,w(t,n,b,null,!0);case 4:e.sent;case 5:return null==a.source||a.source,e.abrupt("return",f);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function K(e,t,n,r){return $.apply(this,arguments)}function $(){return($=a(o().mark(function e(t,n,r,a){var s,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"".concat(r,".").concat(a),s="\n\t\taction table.dropTable/   \n        caslib='".concat(r,"' name='").concat(a,"' quiet=TRUE;   \n             \n        action table.deleteSource status=src /   \n        caslib='casuser' source= '").concat(a,".sashdat' quiet=TRUE;  \n\t\tsend_response({casResults = {status=src, results= 'data deleted'}})\n\t\t"),e.next=1,w(t,n,s);case 1:return c=e.sent,e.abrupt("return",c);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Z=function(e,t,n,r,a){return X.apply(this,arguments)},ee=function(e,t){var n,r,a=null,s=Z,o=function(e){return e};switch(r=null==e?"csv":e.split(".").pop().toLowerCase()){case"sas7bdat":n="basesas";break;case"sashdat":n="hdat";break;case"csv":n=r,a="UTF8";break;case"xslx":case"xsl":n=r;break;case"astore":case"sasast":n=r,s=V,o=function(e){return new Buffer.from(e).toString("base64")};break;case"ds2":case"sas":n="csv",a="UTF8",s=Z,o=function(e,t){var n=e.replace(/[^\x00-\x7F]/g,"").replace(/\r?\n/g,""),r=t.fileExt;return"modelName\\"+("sas"===r?"dataStepSrc":"ds2"===r?"ds2Src":"casl"===r?"caslSrc":"dataStepsrc")+"\n"+t.output.name+"\\ "+n+"\n"};break;default:throw"Currently file type of ".concat(r," is not supported")}var c,u,i=(c=t.split("."),u=2,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,c=[],u=!0,i=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=s.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){i=!0,a=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(i)throw a}}return c}}(c,u)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(c,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{source:e,output:{caslib:i[0],name:i[1].toLowerCase()},fileType:n,fileExt:r,fileOptions:a,transform:o,contentType:"binary/octet-stream",handler:s}};function te(){return(te=a(o().mark(function e(t,n,r,a,s,u){var i,l,p,f;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=a,"object"===c(a)&&(i="".concat(a.caslib,".").concat(a.name)),l=ee(r,i),p=u,e.next=1,l.handler(t,n,p,l,s);case 1:return f=e.sent,e.abrupt("return",f);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ne=function(e,t,n,r,a,s){return te.apply(this,arguments)};function re(){return(re=a(o().mark(function e(t,n,r,a){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,w(t,n,"\n\t  print _args_;\n    rc = checkAndLoadTable(_args_.caslib, _args_.name);\n\t\tif (rc ne true) then do;\n\t\t\ttext = 'Unable to access ' ||_args_.caslib||'.'||_args_.name;   \n\t\t\trx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n\t\t\texit(rx);  \n\t\tend; \n\t  print 'return code = ' || rc;\n\t  send_response({casResults={status='ok'}});\n  ",r,!0);case 1:return e.sent,e.abrupt("return",{msg:"".concat(r.caslib,".").concat(r.name," loaded}"),statusCode:0});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ae=function(e,t,n,r){return re.apply(this,arguments)};function se(){return(se=a(o().mark(function e(t,n,r,a){var s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r||null!=a){e.next=2;break}return e.next=1,oe(t,n,r);case 1:s=e.sent,e.next=4;break;case 2:return e.next=3,ue(t,n,a);case 3:s=e.sent;case 4:return e.abrupt("return",s);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function oe(e,t,n){return ce.apply(this,arguments)}function ce(){return(ce=a(o().mark(function e(t,n,r){var a,s,c,u,i,l,p,f,b,d;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a={session:n,log:null,listing:null,ods:null,job:r,tables:{},files:{}}).log=r.links("log"),a.listing=r.links("listing"),null===(s=r.links("results"))){e.next=2;break}return e.next=1,t.apiCall(s);case 1:if(c=e.sent,(u=c.itemsList().size)>0)for(i=0;i<u;i++)l=c.itemsList(i),"ods"===(p=c.items(l,"data","type").toLowerCase())?a.ods=c.itemsCmd(l,"self"):"table"===p?(f={self:c.itemsCmd(l,"self"),current:null},a.tables[l.toUpperCase()]=f):"file"===p?(b={self:l,current:null,data:null},a.files[l]=b):(d={self:l,current:null,data:null},a[p]=d);case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ue(e,t,n){return ie.apply(this,arguments)}function ie(){return(ie=a(o().mark(function e(t,n,r){var a,s,u,i,l,p,f,b,d,m,h,y,x;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a={session:n,log:null,listing:null,ods:null,job:null,tables:{},files:{}},s="object"===c(r)?[r]:r,u=0;case 1:if(!(u<s.length)){e.next=8;break}return i=s[u],l=i.libref.toUpperCase(),p=i.name.toUpperCase(),f={qs:{filter:"eq(name,'".concat(l,"')")}},e.next=2,t.apiCall(n.links("librefs"),f);case 2:if(0!==(b=e.sent).itemsList().size){e.next=3;break}throw"ERROR: Libref ".concat(l," not found");case 3:return d=b.itemsCmd(l,"self"),e.next=4,t.apiCall(d);case 4:return m=e.sent,f={qs:{filter:"eq(name,'".concat(p,"')")}},e.next=5,t.apiCall(m.links("tables"),f);case 5:if(0!==(h=e.sent).itemsList().size){e.next=6;break}throw"ERROR: Table ".concat(p," not found");case 6:y="".concat(l,".").concat(p).toLowerCase(),x={self:h.itemsCmd(p,"self"),current:null},a.tables[y.toUpperCase()]=x;case 7:u++,e.next=1;break;case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}const le=function(e,t,n,r){return se.apply(this,arguments)};function pe(){return(pe=a(o().mark(function e(t,n,r,a,s,c){var u,i,l,p,f;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u={data:{code:r}},e.next=1,t.apiCall(n.links("execute"),u);case 1:return i=e.sent,l={qs:{wait:null!=a?a:5},headers:{"If-None-Match":i.headers("etag")}},e.next=2,t.jobState(i,l,"longpoll",0,s,c);case 2:return p=e.sent,e.next=3,le(t,n,p.job);case 3:return(f=e.sent).SASJobStatus=p.data,f.jobStateStatus=p,e.abrupt("return",f);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const fe=function(e,t,n,r,a,s){return pe.apply(this,arguments)};function be(){return(be=a(o().mark(function e(t,n,r,a,s,c,u){var i,l,p,f,b;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("number"==typeof c&&(c=null),i=["options NOSYNTAXCHECK OBS=MAX;%let syscc=0;"],null!=a)for(l in a)p="%let ".concat(l,"=").concat(a[l],";"),i.push(p);return f=(f=r.replace(/\t/g," ")).split(/\r?\n/),i=i.concat(f).concat(";"),e.next=1,fe(t,n,i,s,c,u);case 1:return b=e.sent,e.abrupt("return",b);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const de=function(e,t,n,r,a,s,o){return be.apply(this,arguments)};function me(){return(me=a(o().mark(function e(t,n,r,a,s){var u,i,l,p,f,b,d,m,h,y,x,v;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==s||"object"!==c(s)){e.next=1;break}return e.abrupt("return",s);case 1:if(null==r){e.next=3;break}return e.next=2,t.logon(r);case 2:e.sent;case 3:return e.next=4,t.addServices("compute");case 4:if(u=e.sent,i=u.compute,l=null,null==s){e.next=8;break}return p={start:0,limit:100,qs:{filter:"eq(id,'".concat(s,"')")}},e.next=5,t.apiCall(i.links("sessions"),p);case 5:if(f=e.sent,!((b=f.itemsList().toJS().indexOf(s))<0)){e.next=6;break}throw"ERROR: The sessionID ".concat(s," was not found.");case 6:return d=f.itemsCmd(f.itemsList(b),"self"),e.next=7,t.apiCall(d);case 7:return l=e.sent,e.abrupt("return",l);case 8:if(null==t.store.config.options.computeServerId){e.next=10;break}return console.log("NOTE: Detected Workbench"),e.next=9,t.apiCall(i.links("createSession"));case 9:return l=e.sent,e.abrupt("return",l);case 10:return null==n&&(n="SAS Job Execution compute context"),m={qs:{filter:"contains(name,'".concat(n,"')")}},h=null,e.prev=11,e.next=12,t.apiCall(i.links("contexts"),m);case 12:if(0!==(h=e.sent).itemsList().size){e.next=13;break}throw"Context ".concat(n," not found");case 13:e.next=15;break;case 14:throw e.prev=14,v=e.catch(11),console.error("Error: Not able to get context"),v;case 15:if(y=h.itemsList(0),null!=s){e.next=17;break}return m=null==a?null:a,x=h.itemsCmd(y,"createSession"),e.next=16,t.apiCall(x,a);case 16:l=e.sent;case 17:return e.abrupt("return",l);case 18:case"end":return e.stop()}},e,null,[[11,14]])}))).apply(this,arguments)}const he=function(e,t,n,r,a){return me.apply(this,arguments)};function ye(){return(ye=a(o().mark(function e(t,n,r){var a,s,c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("log"!==r&&"listing"!==r){e.next=7;break}if(a=[],null===n[r]){e.next=5;break}return e.next=1,t.apiCall(n[r]);case 1:s=e.sent,a=a.concat(s.items().toJS());case 2:if(null===(c=s.scrollCmds("next"))){e.next=4;break}return e.next=3,t.apiCall(c);case 3:s=e.sent,a=a.concat(s.items().toJS()),e.next=2;break;case 4:e.next=6;break;case 5:a[0]="Note: No ".concat(r);case 6:return e.abrupt("return",a);case 7:if("ods"!==r){e.next=11;break}if(null===n.ods){e.next=9;break}return e.next=8,t.apiCall(n.ods);case 8:return u=e.sent,e.abrupt("return",u.items());case 9:return e.abrupt("return","<h2> No ODS output </h2>");case 10:e.next=14;break;case 11:if("tables"!==r){e.next=12;break}return e.abrupt("return",Object.keys(n.tables));case 12:if("files"!==r){e.next=13;break}return e.abrupt("return",Object.keys(n.files));case 13:throw"Error: Invalid type ".concat(r);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}const xe=function(e,t,n){return ye.apply(this,arguments)};function ve(){return(ve=a(o().mark(function e(t,n,r,a){var s,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a){e.next=2;break}return e.next=1,de(t,n,a);case 1:if("completed"===(s=e.sent).SASJobStatus){e.next=2;break}throw"Error: Preamble failed with completion code of ".concat(s.SASJobStatus);case 2:return e.next=3,le(t,n,null,r);case 3:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const we=function(e,t,n,r){return ve.apply(this,arguments)};function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _e(){return(_e=a(o().mark(function e(t,n,r,a,s,c){var u,i,l,p,f,b,d,m,h,y,x,v,w,g,k,_,S,O,C,j,T,E,R;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u=null,i=(i="string"==typeof r?r:"".concat(r.libref,".").concat(r.name)).toUpperCase(),(l=null!=s?ke({},s):{qs:{}}).qs.includeIndex=!0,p=l.qs.format,f=null==c?"rows":c,b=null!=s&&null==a,null==(d=n.tables[i])){e.next=6;break}if(!0===b&&(d.current=null),null!==d.current&&null!=a&&"first"!==a){e.next=4;break}return e.next=1,t.apiCall(d.self);case 1:return m=e.sent,h=m.items().toJS().columnCount,y={qs:{start:0,limit:h}},e.next=2,t.apiCall(m.links("columns"),y);case 2:for(g in x=e.sent,v=[],w=x.items().toJS(),"rows"===f&&v.push({name:"_index_",Column:"_Index_",Label:"Index",length:8,type:"FLOAT",format:"BEST",informat:"BEST",custom:!1,isFormat:!1}),w)k=w[g],_={name:k.name.toLowerCase(),Column:k.name.toLowerCase(),Label:k.data.label,length:k.data.length,type:k.data.type,format:null!=k.data.format?k.data.format.name:null,informat:null!=k.data.informat?k.data.informat.name:null,custom:!1,isFormat:p},S=!0===l.qs.includeIndex?1:0,v[k.data.index+S]=_;return e.next=3,t.apiCall(m.links(f),l);case 3:O=e.sent,C="rowSet"===f?O.items("rows").toJS():Se(O),d.current=O,d.schema=v,d.columns=x,u={columns:x,schema:v,rows:C,scrollOptions:O.scrollCmds().keySeq().toJS()},e.next=6;break;case 4:if(j=d.current,T=a,"next"===a&&null===j.scrollCmds("next")&&(T=null!==j.links("last")?"last":null),"prev"===a&&null===j.scrollCmds("prev")&&(T=null!==j.links("first")?"first":null),u={schema:d.schema,columns:d.columns,currentColumns:d.currentColumns,rows:[],scrollOptions:j.scrollCmds().keySeq().toJS()},null===T||null===j.scrollCmds(T)){e.next=6;break}return e.next=5,t.apiCall(j.scrollCmds(T),l);case 5:E=e.sent,d.current=E,R="rows"!==f?E.items("rows").toJS():Se(E),u={schema:d.schema,columns:d.schema,rows:R,scrollOptions:E.scrollCmds().keySeq().toJS()};case 6:return e.abrupt("return",u);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Se(e){return e.items().toJS().map(function(e){return e.cells})}const Oe=function(e,t,n,r,a,s){return _e.apply(this,arguments)};function Ce(){return(Ce=a(o().mark(function e(t,n,r,a){var s,c,u,i,l,p;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(s=n.files[r])){e.next=1;break}throw"Invalid fileref ".concat(r);case 1:if(null!==s.current){e.next=4;break}return c={qs:{filter:"eq(name,'".concat(r,"')")}},e.next=2,t.apiCall(n.session.links("files"),c);case 2:return u=e.sent,e.next=3,t.apiCall(u.itemsCmd(r,"self"));case 3:u=e.sent,s.current=u;case 4:if(!0!==a){e.next=5;break}return i="".concat(n.session.host).concat(s.current.links("content","link","uri")),e.abrupt("return",i);case 5:if(null!==s.data){e.next=7;break}return e.next=6,t.apiCall(s.current.links("content"));case 6:return l=e.sent,p=l.items(),s.data=p,e.abrupt("return",p);case 7:return e.abrupt("return",s.data);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}const je=function(e,t,n,r){return Ce.apply(this,arguments)};function Te(){return(Te=a(o().mark(function e(t,n,r,a){var s,c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s="\n     proc append base=".concat(a.libref,".{output.name}  \n     data= ").concat(r.libref,".").concat(r.name,"; run;\n     "),e.next=1,de(t,n,s);case 1:return c=e.sent,u="completed"===c.SASJobStatus?0:1,e.abrupt("return",{msg:"Append Completed. Status is: ".concat(c.SASJobStatus),statusCode:u});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Ee=function(e,t,n,r){return Te.apply(this,arguments)};function Re(){return(Re=a(o().mark(function e(t,n,r){var a,s,c,u,i,l,p,f,b,d,m,h,y,x,v,w,g,k;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(p in a=r.data,s=r.table,c=r.where,u="proc sql; update ".concat(s.libref,".").concat(s.name),i="SET ",l=" ",a)i=i+l+p+"="+Pe(a[p]),l=", ";if(u=u+" "+i,f=" WHERE ",b=" ","string"==typeof c)f+=c;else for(d in c)m=c[d],h=Pe(m),f=f+b+d+"= ".concat(h," "),b=" AND ";return y=(u=u+" "+f+";run;").split(/\r?\n/),x={data:{code:y}},e.next=1,t.apiCall(n.links("execute"),x);case 1:return v=e.sent,w={qs:{newState:"Completed",timeout:1}},e.next=2,t.jobState(v,w);case 2:return g=e.sent,k="completed"===g.data?0:1,e.abrupt("return",{statusCode:k,msg:g.data});case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pe(e){return null==e?".":"string"==typeof e?JSON.stringify(e):e.toString()}const qe=function(e,t,n){return Re.apply(this,arguments)};function Ae(){return(Ae=a(o().mark(function e(t,n,r,a,s){var c,u,i,l,p,f;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(l in c="data ".concat(r.libref,".").concat(r.name,"; INFILE datalines delimiter=',' ;\n"),u="",i="INPUT ",s)p=s[l],i=i+p.Column+" ","CHAR"===p.Type&&(f=" ".concat(p.Column," $ ").concat(p.length," \n"),u=u+" "+f);return u.length>0&&(u="LENGTH "+u+";\n"),c=c+";\n"+u+(i+=";\n")+"datalines;\n"+a+"\n; run; proc print;run;\n",e.next=1,de(t,n,c);case 1:return e.abrupt("return",{msg:"done",statusCode:0});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Le=function(e,t,n,r,a){return Ae.apply(this,arguments)};function De(){return(De=a(o().mark(function e(t,n){var r,a,s,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("reports");case 1:return r=e.sent,a=r.reports,console.log(a),s=null,null!==n&&(s={qs:{filter:"eq(name,'".concat(n,"')")}}),console.log("-----------",a.links("reports")),e.next=2,t.apiCall(a.links("reports"),s);case 2:return c=e.sent,e.abrupt("return",0===c.itemsList().size?null:c);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Ie=function(e,t){return De.apply(this,arguments)};function Ne(){return(Ne=a(o().mark(function e(t,n){var r,a,s,c,u,i,l;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rafObject("reportImages"),e.next=1,Ie(t,n);case 1:if(null!==(a=e.sent)){e.next=2;break}return e.abrupt("return","".concat(n," was not found"));case 2:return s=a.itemsCmd(a.itemsList(0),"self","link","uri"),c={data:{reportUri:s,sectionIndex:0,layoutType:"entireSection",size:"400x400"}},e.next=3,t.apiCall(r.links("createJob"),c);case 3:return u=e.sent,e.next=4,t.jobState(u,{qs:{wait:1.5}},10,2);case 4:if("completed"===(i=e.sent).data){e.next=5;break}return e.abrupt("return","Job failed ".concat(i.data));case 5:return e.next=6,t.apiCall(i.job.itemsCmd(i.job.itemsList(0),"image"));case 6:return l=e.sent,e.abrupt("return",l.items());case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Je=function(e,t){return Ne.apply(this,arguments)};function Ue(){return(Ue=a(o().mark(function e(t,n){var r,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Ie(t,n);case 1:if(null!==(r=e.sent)){e.next=2;break}throw null==n?"No reports were found":"".concat(n," was not found");case 2:return a=[],r.items().map(function(e,t){var n={name:t,uri:r.itemsCmd(t,"self","link","uri")};a.push(n)}),e.abrupt("return",a);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Fe=function(e,t){return Ue.apply(this,arguments)};function Me(){return(Me=a(o().mark(function e(t,n,r){var a,s,c,u,i,l,p,f,b;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.tables[r],e.next=1,t.apiCall(a);case 1:return s=e.sent,e.next=2,t.apiCall(s.links("rowSet"));case 2:c=e.sent,u=c.items("columns"),i=c.items("rows"),l=[],p=i.size,f=o().mark(function e(){var t,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=i.get(b),n={},u.map(function(e,r){var a=e.toLowerCase();n[a]=t.get(r)}),l.push(n);case 1:case"end":return e.stop()}},e)}),b=0;case 3:if(!(b<p)){e.next=5;break}return e.delegateYield(f(),"t0",4);case 4:b++,e.next=3;break;case 5:return e.abrupt("return",l);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Qe=function(e,t,n){return Me.apply(this,arguments)};function ze(){return(ze=a(o().mark(function e(t,n){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Ge(t,n);case 1:return e.abrupt("return",e.sent);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ge(e,t){return Be.apply(this,arguments)}function Be(){return Be=a(o().mark(function e(t,n){var r,s,c,u,i,l,p,f,b,d,m,h,y,x,v;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y=function(){return y=a(o().mark(function e(t,n,r,a){var s,c,u,i,l,p,f,b,d;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("files");case 1:return s=e.sent,c=s.files,u={qs:{filter:"eq(id,'".concat(r,"')")}},e.prev=2,e.next=3,t.apiCall(c.links("files"),u);case 3:return i=e.sent,l=i.itemsCmd(i.itemsList(0),"content"),e.next=4,t.apiCall(l);case 4:if(p=e.sent,"string"!=typeof(f=p.items())){e.next=5;break}return e.abrupt("return",f);case 5:if(b=f.toJS(),!a){e.next=7;break}if(!Array.isArray(b)){e.next=6;break}return e.abrupt("return",b);case 6:return d=[],Object.values(b).forEach(function(e){d.push(e)}),e.abrupt("return",d);case 7:return e.abrupt("return",b);case 8:e.next=10;break;case 9:return e.prev=9,e.catch(2),e.abrupt("return",null);case 10:case"end":return e.stop()}},e,null,[[2,9]])})),y.apply(this,arguments)},h=function(e,t,n,r){return y.apply(this,arguments)},r=n.items().toJS(),s={computeContext:r.results.COMPUTE_CONTEXT,computeJob:r.results.COMPUTE_JOB,computeSession:r.results.COMPUTE_SESSION,session:n.session,log:null,listing:null,ods:null,job:n,tables:{},files:{},results:r.results},x=o().keys(r.results);case 1:if((v=x()).done){e.next=5;break}if("COMPUTE_CONTEXT"===(c=v.value)||"COMPUTE_JOB"===c||"COMPUTE_SESSION"===c){e.next=4;break}if(u=!1,i=null,c.endsWith(".json")?(i=c,u=!0):((l=c.split(".")).shift(),i=l.join(".")),null!==(p=r.results[c])){e.next=2;break}return e.abrupt("continue",1);case 2:return f=p.split("/"),b=f[f.length-1],e.next=3,h(t,i,b,u);case 3:d=e.sent,u?(m=i.split(".json")[0],s.tables[m]=d):s.files[i]=d;case 4:e.next=1;break;case 5:return e.abrupt("return",s);case 6:case"end":return e.stop()}},e)})),Be.apply(this,arguments)}const He=function(e,t){return ze.apply(this,arguments)};function We(){return(We=a(o().mark(function e(t,n){var r,a,s,c,u,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("jobExecution");case 1:return r=e.sent,a=r.jobExecution,e.prev=2,e.next=3,t.apiCall(a.links("create"),n);case 3:return s=e.sent,e.next=4,t.jobState(s,null,"wait",2);case 4:if("running"!==(c=e.sent).data){e.next=5;break}throw"ERROR: Job did not complete in allotted time";case 5:if("failed"!==c.data){e.next=6;break}throw JSON.stringify(c);case 6:return e.next=7,He(t,c.job);case 7:return(u=e.sent).status=c.data,e.abrupt("return",u);case 8:e.next=10;break;case 9:throw e.prev=9,i=e.catch(2),"Error: ".concat(i);case 10:case"end":return e.stop()}},e,null,[[2,9]])}))).apply(this,arguments)}const Ye=function(e,t){return We.apply(this,arguments)};function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ke(){return(Ke=a(o().mark(function e(t,n,r,a){var s,c,u,i,l;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a){e.next=1;break}l=a,e.next=3;break;case 1:return e.next=2,$e(t,n);case 2:l=e.sent;case 3:return s=l,c=Xe(Xe({},r),{},{_omitSessionResults:!1,_resultfile:"*",_output_json:"json"}),u={data:{jobDefinitionUri:s,arguments:c}},e.next=4,Ye(t,u);case 4:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $e(e,t){return Ze.apply(this,arguments)}function Ze(){return(Ze=a(o().mark(function e(t,n){var r,a,s,c,u,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("jobDefinitions");case 1:return r=e.sent,a=r.jobDefinitions,s=null,c={qs:{filter:"eq(name,'".concat(n,"')")}},u=a.links("job-definitions"),e.prev=2,e.next=3,t.apiCall(u,c);case 3:if(0!==(i=e.sent).itemsList().size){e.next=4;break}throw"Error: ".concat(n," not found in the system");case 4:s=i.itemsCmd(n,"self","link","uri");case 5:return e.abrupt("return",s);case 6:throw e.prev=6,e.catch(2),"Error: ".concat(n," not found in the system");case 7:case"end":return e.stop()}},e,null,[[2,6]])}))).apply(this,arguments)}const et=function(e,t,n,r){return Ke.apply(this,arguments)};function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rt(){return(rt=a(o().mark(function e(t,n,r){var a,s,c,u,i,l,p,f,b,d;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("jobExecution");case 1:return a=e.sent,s=a.jobExecution,c={qs:{filter:"eq(name,'".concat(n,"')")}},e.prev=2,e.next=3,t.apiCall(s.links("jobs"),c);case 3:if(0!==(u=e.sent).itemsList().size){e.next=4;break}throw"Error: ".concat(n," not found in the system");case 4:return i=u.items(u.itemsList(0),"data","jobRequest","jobDefinition"),l=nt(nt({},r),{},{_omitSessionResults:!1,_resultfile:"*",_output_json:"json"}),p={data:{jobDefinition:i,arguments:l}},e.next=5,t.apiCall(u.links("submitJob"),p);case 5:return f=e.sent,e.next=6,t.jobState(f,null,"wait",2);case 6:if("running"!==(b=e.sent).data){e.next=7;break}throw"ERROR: Job did not complete in allotted time.";case 7:if("failed"!==b.data){e.next=8;break}throw"ERROR: Job failed. See SAS Environment for details.";case 8:return e.next=9,He(t,b.job);case 9:return d=e.sent,e.abrupt("return",d);case 10:e.next=12;break;case 11:throw e.prev=11,e.catch(2);case 12:case"end":return e.stop()}},e,null,[[2,11]])}))).apply(this,arguments)}const at=function(e,t,n){return rt.apply(this,arguments)};function st(){return(st=a(o().mark(function e(t,n,r){var a,s,c,u,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={qs:{filter:"eq(name,'".concat(r.trim(),"')")}},e.next=1,t.apiCall(n.links("modules"),a);case 1:if(0!==(s=e.sent).itemsList().size){e.next=2;break}return e.abrupt("return",null);case 2:return c=s.itemsCmd(r,"steps"),e.next=3,t.apiCall(c);case 3:return u=e.sent,i={name:r,stepsRafLink:u,stepIds:s.items(r,"data","stepIds").toJS(),microanalyticScore:n},e.abrupt("return",i);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ot=function(e,t,n){return st.apply(this,arguments)};function ct(){return(ct=a(o().mark(function e(t,n,r){var a,s,c,u,i,l;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r){e.next=1;break}return e.next=1,t.logon(r);case 1:return e.next=2,t.addServices("microanalyticScore");case 2:a=e.sent,s=a.microanalyticScore,c={service:s,steps:{}},u=0;case 3:if(!(u<n.length)){e.next=6;break}return i=n[u],e.next=4,ot(t,s,i);case 4:l=e.sent,c.steps[i]=l;case 5:u++,e.next=3;break;case 6:return e.abrupt("return",c);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ut=function(e,t,n){return ct.apply(this,arguments)},it=function(e,t,n,r){var a=e.steps[t];if(null===a)return[];var s=null;if(null==n){var o=a.stepIds.findIndex(function(e){return"execute"===e||"score"===e});if(-1===o)return[];s=a.stepIds[o];var c=a.stepsRafLink.items(s,"data","inputs"),u=a.stepsRafLink.items(s,"data","outputs");return null===c?[]:!0===r?{inputs:c.toJS(),outputs:u.toJS()}:c.toJS()}if(-1===a.stepIds.findIndex(function(e){return e===n}))return[];s=n;var i=a.stepsRafLink.items(s,"data","inputs"),l=a.stepsRafLink.items(s,"data","outputs");return null===i?[]:!0===r?{inputs:i.toJS(),outputs:l.toJS()}:i.toJS()};function lt(){return(lt=a(o().mark(function e(t,n,r,a,s,c){var u,i,l,p,f,b,d,m,h,y,x,v,w;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n.steps[r],i=!1,l=[],!1===Array.isArray(a))for(p in a)f={name:p,value:a[p]},l.push(f);else i=!0;if(b={data:{inputs:!0===i?a:l}},d=null,null!=s){e.next=3;break}if(-1!==(m=u.stepIds.findIndex(function(e){return"execute"===e||"score"===e}))){e.next=1;break}return e.abrupt("return",[]);case 1:d=u.stepIds[m];case 2:e.next=5;break;case 3:if(-1!==u.stepIds.findIndex(function(e){return e===s})){e.next=4;break}return e.abrupt("return",[]);case 4:d=s;case 5:if(null==c&&(c="execute"),null!==(h=u.stepsRafLink.itemsCmd(d,c))){e.next=6;break}return y=[{name:"Error",type:"string",value:"name: ".concat(r," step: ").concat(s," operation: ").concat(c," is an invalid combination")}],e.abrupt("return",y);case 6:return e.next=7,t.apiCall(h,b);case 7:return x=e.sent,v=x.items("outputs").toJS(),!0===i?w=v:(w={},v.map(function(e){w[e.name]=e.value})),e.abrupt("return",w);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}const pt=function(e,t,n,r,a,s){return lt.apply(this,arguments)};function ft(){return(ft=a(o().mark(function e(t,n,r){var a,s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,ut(t,[n]);case 1:return a=e.sent,e.next=2,pt(t,a,n,r,"score","execute");case 2:return s=e.sent,e.abrupt("return",s);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}const bt=function(e,t,n){return ft.apply(this,arguments)};function dt(){return(dt=a(o().mark(function e(t,n,r){var a,s,c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=n.service,s=0;case 1:if(!(s<r.length)){e.next=4;break}if(c=r[s],null!=n.steps[c]){e.next=3;break}return e.next=2,ot(t,a,c);case 2:u=e.sent,n.steps[c]=u;case 3:s++,e.next=1;break;case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}const mt=function(e,t,n){return dt.apply(this,arguments)};export{A as casActionRun,B as casAppendTable,D as casFetchData,N as casFetchRows,ae as casLoadTable,z as casSaveTable,P as casSetup,H as casTableToJson,M as casUpdateData,ne as casUpload,E as caslDescribe,w as caslRun,f as caslRunBase,O as caslScore,Ee as computeAppendTable,Oe as computeFetchData,je as computeFileContent,xe as computeResults,de as computeRun,he as computeSetup,we as computeSetupTables,le as computeSummary,qe as computeUpdateData,Le as computeUpload,Ie as findReport,Je as getReportImage,Fe as getReportUri,Qe as getSasTableRows,et as jesRun,at as jobRun,l as jsonToDict,mt as masAddModel,it as masDescribe,pt as masRun,bt as masScore,ut as masSetup};