/*! For license information please see restaflib.umd.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("restaflib",[],t):"object"==typeof exports?exports.restaflib=t():e.restaflib=t()}(self,()=>(()=>{var e={125(e,t,n){var r=n(590);function a(){var t,n,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",c=s.toStringTag||"@@toStringTag";function i(e,a,s,o){var c=a&&a.prototype instanceof l?a:l,i=Object.create(c.prototype);return r(i,"_invoke",function(e,r,a){var s,o,c,i=0,l=a||[],p=!1,f={p:0,n:0,v:t,a:b,f:b.bind(t,4),d:function(e,n){return s=e,o=0,c=t,f.n=n,u}};function b(e,r){for(o=e,c=r,n=0;!p&&i&&!a&&n<l.length;n++){var a,s=l[n],b=f.p,d=s[2];e>3?(a=d===r)&&(c=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=t):s[0]<=b&&((a=e<2&&b<s[1])?(o=0,f.v=r,f.n=s[1]):b<d&&(a=e<3||s[0]>r||r>d)&&(s[4]=e,s[5]=r,f.n=d,o=0))}if(a||e>1)return u;throw p=!0,r}return function(a,l,d){if(i>1)throw TypeError("Generator is already running");for(p&&1===l&&b(l,d),o=l,c=d;(n=o<2?t:c)||!p;){s||(o?o<3?(o>1&&(f.n=-1),b(o,c)):f.n=c:f.v=c);try{if(i=2,s){if(o||(a="next"),n=s[a]){if(!(n=n.call(s,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,o<2&&(o=0)}else 1===o&&(n=s.return)&&n.call(s),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);s=t}else if((n=(p=f.n<0)?c:e.call(r,f))!==u)break}catch(e){s=t,o=1,c=e}finally{i=1}}return{value:n,done:p}}}(e,s,o),!0),i}var u={};function l(){}function p(){}function f(){}n=Object.getPrototypeOf;var b=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),d=f.prototype=l.prototype=Object.create(b);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,c,"GeneratorFunction")),e.prototype=Object.create(d),e}return p.prototype=f,r(d,"constructor",f),r(f,"constructor",p),p.displayName="GeneratorFunction",r(f,c,"GeneratorFunction"),r(d),r(d,c,"Generator"),r(d,o,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(e.exports=a=function(){return{w:i,m}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},192(e,t,n){var r=n(541)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},251(e,t,n){var r=n(632),a=n(590);e.exports=function e(t,n){function s(e,a,o,c){try{var i=t[e](a),u=i.value;return u instanceof r?n.resolve(u.v).then(function(e){s("next",e,o,c)},function(e){s("throw",e,o,c)}):n.resolve(u).then(function(e){i.value=e,o(i)},function(e){return s("throw",e,o,c)})}catch(e){c(e)}}var o;this.next||(a(e.prototype),a(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),a(this,"_invoke",function(e,t,r){function a(){return new n(function(t,n){s(e,r,t,n)})}return o=o?o.then(a,a):a()},!0)},e.exports.__esModule=!0,e.exports.default=e.exports},423(e,t,n){var r=n(998).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},541(e,t,n){var r=n(632),a=n(125),s=n(857),o=n(691),c=n(251),i=n(769),u=n(423);function l(){"use strict";var t=a(),n=t.m(l),p=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function f(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))}var b={throw:1,return:2,break:3,continue:3};function d(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,b[e],t)},delegateYield:function(e,a,s){return t.resultName=a,n(r.d,u(e),s)},finish:function(e){return n(r.f,e)}},n=function(e,n,a){r.p=t.prev,r.n=t.next;try{return e(n,a)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(e.exports=l=function(){return{wrap:function(e,n,r,a){return t.w(d(e),n,r,a&&a.reverse())},isGeneratorFunction:f,mark:t.m,awrap:function(e,t){return new r(e,t)},AsyncIterator:c,async:function(e,t,n,r,a){return(f(t)?o:s)(d(e),t,n,r,a)},keys:i,values:u}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=l,e.exports.__esModule=!0,e.exports.default=e.exports},590(e){function t(n,r,a,s){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}e.exports=t=function(e,n,r,a){function s(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(s("next",0),s("throw",1),s("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r,a,s)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},632(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},691(e,t,n){var r=n(125),a=n(251);e.exports=function(e,t,n,s,o){return new a(r().w(e,t,n,s),o||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},769(e){e.exports=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},857(e,t,n){var r=n(691);e.exports=function(e,t,n,a,s){var o=r(e,t,n,a,s);return o.next().then(function(e){return e.done?e.value:o.next()})},e.exports.__esModule=!0,e.exports.default=e.exports},998(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";function e(e,t,n,r,a,s,o){try{var c=e[s](o),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function t(t){return function(){var n=this,r=arguments;return new Promise(function(a,s){var o=t.apply(n,r);function c(t){e(o,a,s,c,i,"next",t)}function i(t){e(o,a,s,c,i,"throw",t)}c(void 0)})}}n.r(r),n.d(r,{casActionRun:()=>q,casAppendTable:()=>G,casFetchData:()=>L,casFetchRows:()=>I,casLoadTable:()=>re,casSaveTable:()=>Q,casSetup:()=>R,casTableToJson:()=>B,casUpdateData:()=>M,casUpload:()=>te,caslDescribe:()=>T,caslRun:()=>v,caslRunBase:()=>p,caslScore:()=>S,computeAppendTable:()=>Te,computeFetchData:()=>Se,computeFileContent:()=>Ce,computeResults:()=>ye,computeRun:()=>be,computeSetup:()=>me,computeSetupTables:()=>ve,computeSummary:()=>ue,computeUpdateData:()=>Pe,computeUpload:()=>Ae,findReport:()=>De,getReportImage:()=>Ne,getReportUri:()=>Ue,getSasTableRows:()=>Fe,jesRun:()=>Ze,jobRun:()=>rt,jsonToDict:()=>u,masAddModel:()=>dt,masDescribe:()=>it,masRun:()=>lt,masScore:()=>ft,masSetup:()=>ct});var a=n(192),s=n.n(a);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function c(e){var t="{ ",n=" ";for(var r in e){if(!0===Array.isArray(e[r])){var a=i(e[r]);t=t+n+"".concat(r,"=")+a}else{var s=o(e[r]);if("object"===s){var u=c(e[r]);t=t+n+"".concat(r,"=")+u}else t=t+n+"".concat(r,"=")+("string"===s?' "'.concat(e[r],'" '):"".concat(e[r],"  "))}n=","}return t+"} "}function i(e){for(var t="{",n=" ",r=e.length,a=0;a<r;a++)if(!0===Array.isArray(e[a])){var s=i(e[a]);t=t+n+"".concat(a,"=")+s}else{var u=o(e[a]);t="object"===u?t+n+c(e[a]):t+n+("string"===u?' "'.concat(e[a],'" '):"".concat(e[a],"  ")),n=","}return t+"}"}const u=function(e,t){var n;return n=null===e?"{}":!0===Array.isArray(e)?i(e):c(e),"".concat(t," = ").concat(n,";")};function l(){return l=t(s().mark(function e(t,n,r,a){var o,c,i,l,p,f,b,d=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=u(null!==a?a:{},"_args_"),c=(c=o+" "+r).replace(/\r?\n|\r/g,""),i={action:"sccasl.runcasl",data:{code:c}},l=d.length,p=new Array(l>4?l-4:0),f=4;f<l;f++)p[f-4]=d[f];return e.next=1,t.runAction.apply(t,[n,i].concat(p));case 1:return b=e.sent,e.abrupt("return",b);case 2:case"end":return e.stop()}},e)})),l.apply(this,arguments)}const p=function(e,t,n,r){return l.apply(this,arguments)},f=function(){return"\n    print _args_;\n\n    results = casFetchRows(_args_.table.caslib, _args_.table.name , _args_.start + 1, _args_.limit,  _args_.format, _args_.where);  \n    send_response({casResults = results});  \n        \n    function casFetchRows(caslib, name, from, count, format, where) ;    \n     \n       rc = checkAndLoadTable(caslib, name);\n    \n       if (rc ne true) then do;\n        text = 'Unable to access ' ||caslib||'.'||name;   \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        exit(rx);  \n        end;  \n\n        /*\n         * get tableoinfo to get rowCount\n         */\n\n        action table.tableinfo r= result/    \n            caslib = caslib    \n            name   = name;    \n     \n        rowCount = result.TableInfo[1, 'rows'];\n        to = from + count - 1;\n\n        \n        /*\n         * get column information\n         */\n\n        action table.columninfo r=infoResult /\n            table = {caslib=caslib name=name};\n\n        columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}};\n        i = 2;\n        do c over inforesult.columninfo;\n           columns[i] = c;\n           i = i + 1;\n        end;\n        \n        /*\n         * Fetch the current set of rows\n         */\n\n        rows = {};\n        if (from <=  rowCount) then do;\n          action table.fetch r = result status=rcx/    \n              table = {caslib=caslib, name=name where=where}   \n              from= from to=to format=format  sastypes=true\n              ;\n          if (rcx.severity eq 2) then do;\n            exit(rcx);\n          end;\n          /* \n          * create payload to return\n          */\n\n          i = 1;\n          rows ={};\n          do row over result.fetch;\n            rr = {};\n            j = 1;\n            do key,v  over row;\n              rr[j] = override(columns[j].Type, v);\n              j = j + 1;\n            end;\n            rows[i] = rr;\n            i = i + 1;\n          end;\n        end;\n\n        currentCount = DIM(rows);\n        pagination = {};   \n        table = {caslib=caslib, name=name};\n\n        pagination = setPagination(from, count, format, where, currentCount, rowCount, table);\n    \n        lastRequest={start=from-1, limit=count, format=format, currentCount=currentCount, \n                     rowCount=rowCount, where=where, table=table, version='3'};\n       scrollOptions = getKeys(pagination);\n       return( \n         {pagination = pagination, data = {schema=columns, rows=rows , scrollOptions=scrollOptions}, lasRequest=lastRequest}\n         );\n    end;    \n    \n    \n    /*\n     * For non-primary column types set new content\n     */\n\n    function setPagination(from, count, format, where,  currentCount, rowCount, table);\n\n\n      prevStart = max(from - count - 1, 0);\n\n      if (currentCount lt count) then do; \n        pagination.prev = {start=prevStart, limit=count, format=format, where=' ', table=table};\n        if (prevStart ne 0) then do;\n          pagination.first = {start=0, limit=count, format=format, where=' ', table=table};\n        end; \n      return pagination;\n      end;\n      currentStart = from -1;\n      if (currentStart eq 0) then do;\n         pagination.next = {start=count, limit=count, format=format, where=' ', table=table};\n         return pagination;\n      end;\n\n      nextStart = currentStart + count;\n      pagination.next = {start=nextStart, limit=count, format=format, where=' ', table=table};\n      pagination.prev = {start=prevStart, limit=count, format=format, where=' ', table=table};\n      if (prevStart ne 0) then do;\n        pagination.first = {start=0, limit=count, format=format, where=' ', table=table};\n      end; \n      return pagination;\n  end;\n\n\n\n\n    function override(type, iv);\n      if (type EQ 'varbinary')       then v = '...varbinary';\n      else if (type EQ  'blob')      then v = '...blob';\n      else if (type EQ 'table')      then v = '...table';\n      else if (type EQ 'dictionary') then v = '...dictionary';\n      else if (type EQ 'list')       then v = '...list';\n      else if (type EQ 'isArray')    then v = '...array';\n      else v = iv;\n      return v;\n      end;\n\n      \n    "},b=function(){return"\n    function checkAndLoadTable(caslib, name);   \n        \n                /* verify caslib is there */\n                 table.queryCaslib status=status result=result/\n                    caslib = caslib;\n                do k,v over result;   /* to handle casuser[user] */                       \n                   rc = v;\n                end;\n                if ( rc eq false ) then \n                   return -1;\n                /*    \n                * Check to see if table is already loaded   \n                */   \n                action table.tableExists r=result/    \n                    caslib = caslib    \n                    name  = name;    \n                /*   \n                * if not loaded then try to load it   \n                */   \n                rc = true;\n                if (result.exists eq 0 or result.exists eq 2) then do;   \n                    path = lookupPath(caslib, name);\n                    if (path eq '*') then do;\n                       rc = false;\n                    end;\n                    else do;\n                        action table.loadTable status=status/    \n                            caslib = caslib    \n                            source = path    \n                            casout={caslib= caslib name=name}; \n                        if (status.statusCode ne 0 ) then rc = false;\n                    end; \n                end;        \n                return rc;  \n            end;   \n        \n        function saveAndLoadTable(caslib, source, targetlib, targetname,promote);\n        \n                /* load source */\n                r = checkAndLoadTable(caslib, source);\n        \n                sashdat = target||\".sashdat\";\n                table.save /\n                    caslib= targetlib name=sashdat\n                    table = {caslib=caslib name=source} replace=true;\n                \n                table.droptable /\n                    caslib=targetlib name=target quiet=true;\n                \n                table.loadtable result=r status=rc/\n                    caslib=targetlib casout={caslib=targetlib name=target replace=TRUE}\n                    path=sashdat;\n        \n                if (promote eq true) then do;\n                    table.promote result=r status=rc/\n                      caslib=caslib name=target quiet=true\n                      targetLib=caslib target=target;\n                end;\n                if (rc.severity eq 2) then do;\n                    print rc;\n                    print 'Ignoring error';\n                    end;\n                r = 0;\n                return r;\n        \n         end;\n        \n    function lookupPath(caslib, name ) ; \n            table.fileInfo r = result/\n            caslib=caslib; \n        \n            names = result.fileInfo[,4]; \n            nameu = upcase(name)||'.SASHDAT'; \n            cpath = '*'; \n            count = 0; \n        \n            do n over names; \n                if (upcase(n) eq nameu)  then do; \n                    count = count + 1; \n                    if ( cpath eq '*') then do; \n                        cpath = n; \n                    end; \n                end; \n            end; \n            \n            if (count GT 1 ) then do; \n                print 'Warning: ' count 'Files with names only different in case exist - First one chosen';\n                print 'Path: ' cpath ' will be used****';  \n            end; \n            r = cpath; \n            return r; \n        end; \n            /*-----------------------------------------*/ \n            /* isModel: is it model table              */  \n            /*-----------------------------------------*/  \n         \n            function isModel(caslib, name) ; \n                 table.columnInfo r = result /  \n                        table = {caslib=caslib , name=name};  \n                 validTable = false; \n                 mtype = 'bad'; \n                 do c over result.columninfo;  \n                    cu = upCase(c.Column); \n                    if ( cu eq 'DATASTEPSRC') then do; \n                       mtype = 'ds'; \n                    end; \n                    else if ( cu eq '_STATE_' ) then do; \n                      mtype = 'astore'; \n                    end; \n                    else if (cu eq 'MODELMETADATA') then do; \n                      mtype = 'ds2'; \n                    end; \n                end;  \n                print 'Specified model type: ' || mtype; \n                return mtype; \n            end; \n         \n    /*-----------------------------------------*/ \n            /* Returns contents of the specified table */  \n            /*-----------------------------------------*/  \n         \n            function contents(caslib, name) ;    \n                table.columnInfo r = result /  \n                        table = {caslib=caslib , name=name};  \n               /* columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}}; */ \n                i = 1;  \n                columns = {}; \n                do c over result.columninfo;  \n                    columns[i] = c;  \n                    i = i + 1;  \n                end;  \n                return {describe = columns, table = {}};   \n            end;  \n    \n           /*------------------------------------------*/  \n            /* Returns unique values                   */  \n            /*-----------------------------------------*/  \n         \n            function selectionLists(idvars,caslib, name, where);   \n                 \n                s = checkAndLoadTable(caslib, name);   \n                if ( s ne true) then do;   \n                results = {Errors= 'Unable to access ' ||caslib||'.'||name, statusCode = s};   \n              \n                end;   \n                print idvars;\n                do k over idvars;   \n                r  = _getValues(k, caslib, name, where);   \n                results[k] = r;   \n                end;   \n                return { data=results, statusCode=0};   \n            end;   \n           function _getValues(id, caslib, name, where) ;   \n                             \n                action table.dropTable/   \n                caslib='casuser' name='dtemp1' quiet=TRUE;   \n                     \n                action table.deleteSource status=src /   \n                caslib='casuser' source= 'dtemp1.sashdat' quiet=TRUE;   \n                     \n                action simple.groupby result=r status=rc/   \n                    aggregator = 'N'   \n                    inputs     = {id}   \n                    table      = {caslib=caslib name=name, where=where}   \n                    casout     = {caslib='casuser' name='dtemp1'}   \n                ;   \n                action table.fetch result=r/   \n                    table={caslib='casuser' name='dtemp1'}    \n                    sortby={{name=id,  order='ascending'}};   \n                result = r.Fetch[,2];   \n                return result;   \n                end;  \n            /*------------------------------------------*/ \n            /* get a record                             */ \n            /*------------------------------------------*/ \n         \n            function _fetchData(filter, table); \n                s = checkAndLoadTable(table.caslib, table.name);   \n                if ( s ne 0 ) then do;   \n                    results = {Errors= 'Unable to access ' ||table.caslib||'.'||table.name};   \n                    return results;   \n                    end;   \n                wherex = dictTowhere(filter);   \n               /* wherex = table.caslib||'.'||table.name||'(where=('||wherex||'));';  \n                 \n                destroyTable('casuser', 'input');  \n         \n                action datastep.runCode r=result status=rc/   \n                    single='yes'   \n                    code = 'data casuser.input; set ' || wherex||'run;';  \n                    */ \n                     \n                action table.fetch r = result /   \n                    table={caslib=table.caslib name=table.name where=wherex};   \n             \n                rows = resultsToDict(result.Fetch);   \n                return {scenario = rows, table = result.Fetch};   \n         \n            end; \n    function destroyTable(caslib,name);   \n                action table.dropTable/   \n                caslib=caslib name=name quiet=TRUE;   \n                         \n                action table.deleteSource status=src /   \n                caslib=caslib source= name||'.sashdat' quiet=TRUE;   \n                     \n            return true;   \n            end;   \n                 \n                 \n            function dictToWhere(filter);   \n                where ='';   \n                andbit='  ';   \n                do k,v over filter;   \n                    if (isString(v) ) then do;   \n                        where = where || andbit || k ||  ' eq ' || '\"'||v||'\"';   \n                    end;    \n                    else do;   \n                        where = where || andbit || k ||  ' eq ' || v ;   \n                    end;   \n                andbit =' and ';   \n                end;   \n            return where;   \n            end;   \n                 \n            function resultsToDict(r);   \n                casResults = {};   \n                i = 1;   \n                do row over r;   \n                casResults[i] = row;   \n                i = i + 1;   \n                end;   \n                return casResults;   \n            end;   \n             \n            function argsToTable(_arg_, caslib, name );   \n                action table.droptable/  \n                    caslib=caslib name=name quiet=TRUE;  \n                i = 1;  \n                do key,obj over _arg_;  \n                    columns[i] = key;  \n                    row[i] = obj;  \n                    if ( isString(obj) ) then  \n                        type[i] = 'varchar';   \n                    else if ( isInteger(obj) ) then   \n                        type[i] = 'int';   \n                    else type[i] = 'double';  \n                    i = i + 1;  \n                    end;    \n                 \n                data1 = newTable('data1', columns, type, row );   \n                 \n                saveresult data1 casout=name caslib=caslib replace;   \n            end; \n    \n        function saveAndPromoteTable(caslib, target, source);\n            sashdat = target||\".sashdat\";\n            rc = checkAndLoadTable(caslib, source);\n            table.droptable /\n                caslib=caslib name=target quiet=true;\n        \n            table.save /\n                caslib= caslib name=sashdat\n                table = {caslib=caslib name=source} replace=true;\n            \n            table.loadtable result=r/\n                caslib=caslib casout={caslib=caslib name=target replace=TRUE}\n                path=sashdat;\n        \n            table.promote result=r status=rc/\n                caslib=caslib name=target quiet=true\n                targetLib=caslib target=target;\n            print rc;\n            r = rc.severity;\n            if (rc.severity gt 0) then do;\n              print rc;\n              print 'Ignoring error';\n              rc = 0;\n            end;\n        \n            return r;\n         end;  \n       \n     "},d=f,m=function(){return"\n  results = casFetchRows(_args_.table.caslib, _args_.table.name , _args_.from, _args_.count,  _args_.format, _args_.where);   \n  send_response({casResults = results});  \n      \n  function casFetchRows(caslib, name, from, count, format, where) ;    \n   \n     rc = checkAndLoadTable(caslib, name);\n  \n     if (rc ne true) then do;\n      text = 'Unable to access ' ||caslib||'.'||name;   \n      rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n      exit(rx);  \n      end;  \n\n      /*\n       * get all table to get rowCount\n       */\n\n      action table.tableinfo r= result/    \n          caslib = caslib    \n          name   = name;    \n   \n      rowCount = result.TableInfo[1, 'rows'];    \n     \n      to       = from + count - 1;   \n      \n      /*\n       * get column information\n       */\n\n      action table.columninfo r=infoResult /\n          table = {caslib=caslib name=name};\n\n      columns ={{Column='_Index_',ID=0,Type='double',RawLength=5,FormattedLength=5,NFL=0,NFD=0}};\n      i = 2;\n      do c over inforesult.columninfo;\n         columns[i] = c;\n         i = i + 1;\n      end;\n      \n      /*\n       * Fetch the current set of rows\n       */\n     /* wherex = dictTowhere(where); let user send in the where clause */\n      print where;\n\n      action table.fetch r = result /    \n          table = {caslib=caslib, name=name where=where}   \n          from= from to=to format=format  sastypes=true\n          ;\n\n      /* \n       * create payload to return\n       */\n\n      i = 1;\n      rows ={};\n      do row over result.fetch;\n        rr = {};\n        j = 1;\n        do key,v  over row;\n          rr[j] = override(columns[j].Type, v);\n          j = j + 1;\n        end;\n        rows[i] = rr;\n        i = i + 1;\n      end;\n\n      pagePrev = max(from - count, 1);\n     \n      if ( to eq rowCount ) then do;    \n          pageNext = -1;    \n      end;    \n      else do ;    \n          pageNext = min(to + 1, rowCount);    \n      end;   \n      table = {caslib=caslib, name=name};\n      pagination = {next= {from=pageNext, count=count, format=format, where=where table=table}, prev={from=pagePrev, count=count, format=format, where=where, table=table}};\n      pagination.current = {from = from, to=to, rowCount=rowCount, version=1};\n      return( \n       {pagination = pagination, data = {schema=columns, rows=rows }}\n       );\n  end;    \n  \n  \n  /*\n   * For non-primary column types set new content\n   */\n\n  function override(type, iv);\n    if (type EQ 'varbinary')       then v = '...varbinary';\n    else if (type EQ  'blob')      then v = '...blob';\n    else if (type EQ 'table')      then v = '...table';\n    else if (type EQ 'dictionary') then v = '...dictionary';\n    else if (type EQ 'list')       then v = '...list';\n    else if (type EQ 'isArray')    then v = '...array';\n    else v = iv;\n    return v;\n    end;\n\n    \n  "},h=function(){return"\n        result = runMain(_args_); \n        send_response(result); \n        /* print result; */\n     \n     \n        function runMain(_args_) ; \n            r = {Error= 'No path'};   \n            if ( _args_.path eq '/selectors') then do;   \n                r = selectionLists(_args_.selectors, _args_.table.caslib, _args_.table.name);   \n            end;   \n            else if ( _args_.path eq '/contents') then do;  \n                r = contents(_args_.table.caslib, _args_.table.name);  \n            end;  \n            else if (_args_.path eq '/describe') then do; \n               r = describeModel(_args_); \n            end; \n            else if (_args_.path eq '/scenario' ) then do;\n              r = fetchData(_args_.filter, _args_.table);\n            end;\n            else if (_args_.path eq '/score') then do;  \n                if( exists(_args_, 'modelName')  eq false ) then\n                  modelname = '';\n                else modelName =_args_.modelName;\n                r =  runScoreCode(_args_.model,  _args_.scenario, modelName);   \n            end;   \n            else do; \n              r = {icasResults={Errors = 'Invalid action option specified' || _args_.path}, statusCode=404}; \n            end; \n            print r;\n            if ( r.statusCode ne 0) then do;\n              print r.icasResults;\n              exit({severity=2,reason=6, status=r.iCasResults.Errors,statusCode=r.statusCode});\n            end;\n            result = {casResults = r.icasResults};  \n            print '***************************************************************';  \n            print result;  \n            print '***************************************************************';  \n            return result;  \n        end; \n     \n        /*-----------------------------------------*/ \n        /* describeModel                           */ \n        /*-----------------------------------------*/ \n     \n        function describeModel(_args_) ; \n            s = checkAndLoadTable(_args_.model.caslib, _args_.model.name);   \n            if ( s ne true) then do;   \n                results = {Errors= 'Unable to access ' ||_args_.model.caslib||'.'||_args_.model.name};   \n                return {icasResults=results, statusCode=404};  \n                end; \n     \n            mtype = isModel(_args_.model.caslib, _args_.model.name); \n            if ( mtype EQ 'astore' ) then do; \n               r = astoreDescribe(_args_.model); \n            end; \n            else if (mtype EQ 'ds' or mtype EQ 'ds2') then do;\n               s = checkAndLoadTable(_args_.table.caslib, _args_.table.name);   \n              if ( s ne true ) then do;   \n                results = {Errors= 'Unable to access ' ||_args_.table.caslib||'.'||_args_.table.name};   \n                return {icasResults=results, statusCode=404};  \n                end; \n               r = contents( _args_.table.caslib, _args_.table.name); \n            end; \n         return {icasResults= r, statusCode=0} ;\n        end;             \n       \n        /*------------------------------------------*/ \n        /* astoreDescribe                           */ \n        /*------------------------------------------*/ \n     \n        function astoreDescribe(model); \n          action astore.describe r=result/ \n              rstore = { caslib= model.caslib name = model.name }; \n          rows = resultsToDict(result.InputVariables); \n          return {describe = rows, table = result.InputVariables}; \n        end; \n     \n        /*------------------------------------------*/  \n        /* score                                    */  \n        /*------------------------------------------*/  \n        function runScoreCode( model, scenario, modelName);   \n            print model; \n            s = checkAndLoadTable(model.caslib, model.name);   \n            if ( s ne true ) then do;   \n                results = {Errors= 'Unable to access ' ||model.caslib||'.'||model.name};   \n                return {icasResults=results, statusCode=404};   \n                end;\n             \n            mtype = isModel(model.caslib, model.name); \n     \n            if ( mtype eq 'bad' ) then do; \n               results = {Error= model.caslib||'.'||model.name || ' is not recognized as a valid supported model. Please check your values'};\n               return {icasResults=results, statusCode=400};\n              end; \n            destroyTable('casuser', 'input');   \n            argsToTable(scenario, 'casuser', 'input'); \n     \n            destroyTable('casuser', 'output');   \n     \n            if (mtype eq 'astore') then do; \n                print 'Scoring with astore'; \n                action astore.score r = result/   \n                    rstore = {caslib=model.caslib name=model.name}   \n                    out    = {caslib='casuser' name='output'}   \n                    table  = {caslib='casuser' name='input'};   \n            end; \n            else if (mtype eq 'ds') then do; \n                print 'scoring with datastep code'; \n                action datastep.runcodetable r = result/   \n                    single='YES'   \n                    codeTable= {caslib=model.caslib name=model.name}   \n                    casout = {caslib='casuser' name='output'}   \n                    table = {caslib='casuser' name='input'};   \n            end;  \n            else if (mtype eq 'ds2' ) then do; \n               print 'Scoring with d2'; \n               if ( missing(modelName) eq true) then do;\n                  results = {Error= 'modelName is missing. Please check your values'};\n                  return {icasResults=results, statusCode=400};\n               end;\n\n               action ds2.runModel r = result/ \n                  modelTable = {caslib=model.caslib, name=model.name} \n                  modelName = modelName \n                  table = {caslib= 'casuser', name='input'} \n                  casOut = {caslib= 'casuser' name='output'}; \n               end; \n     \n             \n            action table.fetch r = result /   \n                table={caslib='casuser' name='output'};   \n             \n            rows = resultsToDict(result.Fetch);   \n            \n            return {icasResults= rows, statusCode=0} ;\n        end;   \n             \n        \n    "},y=function(){return"\n    rc = checkAndLoadTable(_args_.masterTable.caslib, _args_.masterTable.name);\n\n    if (rc ne true) then do;\n        text = 'Unable to access ' ||_args_.masterTable.caslib||'.'||_args_.masterTable.name;   \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        exit(rx); \n    end; \n    \n    rc = checkAndLoadTable(_args_.setTable.caslib, _args_.setTable.name);\n    if (rc ne true) then do;\n        text = 'Unable to access ' ||_args_.setTable.caslib||'.'||_args_.setTable.name; \n        rx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n        return rx;\n    end;\n\n\n    setdata = _args_.setTable.caslib ||'.'||_args_.setTable.name;\n    masterdata = _args_.masterTable.caslib ||'.'||_args_.masterTable.name;\n\n    action datastep.runCode r=result status=rc/\n     code='data ' ||masterdata||'(append=YES);set ' || setdata ||'; run;';\n\n    if (rc.statusCode ne 0) then do;\n      exit(rc);\n    end; \n    else do;\n     results = {msg= 'Append succeeded', statusCode=true};\n     end;\n    \n    send_response({casResults = results});\n    "};function x(){return x=t(s().mark(function e(t,n,r,a,o){var c,i,u,l,f,d=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(c=r,!1!==o&&(c=b()+" "+r),i=d.length,u=new Array(i>5?i-5:0),l=5;l<i;l++)u[l-5]=d[l];return e.next=1,p.apply(void 0,[t,n,c,a].concat(u));case 1:return f=e.sent,e.abrupt("return",f.items().toJS());case 2:case"end":return e.stop()}},e)})),x.apply(this,arguments)}const v=function(e,t,n,r,a){return x.apply(this,arguments)};function w(e,t,n){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){w(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(){return(_=t(s().mark(function e(t,n,r){var a,o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=b()+" "+h(),o=k({path:"/score"},r),e.next=1,p(t,n,a,o);case 1:return c=e.sent,i=c.items("results","casResults").toJS()[0],e.abrupt("return",i);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const S=function(e,t,n){return _.apply(this,arguments)};function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach(function(t){w(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function j(){return(j=t(s().mark(function e(t,n,r){var a,o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=b()+" "+h(),o=C({path:"/describe"},r),e.next=1,p(t,n,a,o);case 1:return c=e.sent,i=c.items("results").toJS(),e.abrupt("return",i);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const T=function(e,t,n){return j.apply(this,arguments)};function E(){return(E=t(s().mark(function e(t,n,r,a){var c,i,u,l,p,f,b,d,m,h;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=2;break}return e.next=1,t.logon(n);case 1:e.sent;case 2:return e.next=3,t.addServices("casManagement");case 3:return c=e.sent,i=c.casManagement,e.next=4,t.apiCall(i.links("servers"));case 4:if(0!==(u=e.sent).itemsList().size){e.next=5;break}throw{Error:"No cas servers were found"};case 5:if(l=null,null!=a){e.next=6;break}l=u.itemsList(0),e.next=8;break;case 6:if(p=u.itemsList().toJS(),-1!==(f=p.findIndex(function(e){return e===a}))){e.next=7;break}throw{Error:"server with name of ".concat(a," was not found")};case 7:l=u.itemsList(f);case 8:if(b=null,null!=r){e.next=10;break}return e.next=9,t.apiCall(u.itemsCmd(l,"createSession"));case 9:b=e.sent,e.next=15;break;case 10:if("object"!==o(r)){e.next=11;break}b=r,e.next=15;break;case 11:return d={qs:{filter:"eq( id,'".concat(r,"')")}},e.next=12,t.apiCall(u.itemsCmd(l,"sessions"),d);case 12:if(0!==(m=e.sent).items().size){e.next=13;break}throw"ERROR: The sessionID ".concat(r," was not found.");case 13:return h=m.itemsCmd(m.itemsList(0),"self"),e.next=14,t.apiCall(h);case 14:b=e.sent;case 15:return e.abrupt("return",{servers:u,session:b});case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}const R=function(e,t,n,r){return E.apply(this,arguments)};function P(){return P=t(s().mark(function e(t){var n,r,a,o,c=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=c.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=c[a];return e.next=1,t.runAction.apply(t,r);case 1:return o=e.sent,e.abrupt("return",o.items().toJS());case 2:case"end":return e.stop()}},e)})),P.apply(this,arguments)}const q=function(e){return P.apply(this,arguments)};function A(){return(A=t(s().mark(function e(t,n,r){var a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=b()+" "+d(),e.next=1,p(t,n,a,r);case 1:return o=e.sent,e.abrupt("return",o.items("results","casResults").toJS());case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const L=function(e,t,n){return A.apply(this,arguments)};function D(){return(D=t(s().mark(function e(t,n,r){var a,o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null==r.where&&(r.where=" "),a=b()+" "+m(),e.next=1,p(t,n,a,r);case 1:return o=e.sent,null==(c=o.items("results","casResults").toJS()).data&&(c.data={rows:[]}),e.abrupt("return",c);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const I=function(e,t,n){return D.apply(this,arguments)};function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach(function(t){w(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function U(){return(U=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,b,d,m,h,y,x,v,w,g;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(l in a=r.data,o=r.where,c=r.table,i="",u=" ",o)p=o[l],f="string"==typeof p?"'".concat(p.toString(),"'"):p,i=i+u+l+"= ".concat(f," "),u=" AND ";for(d in b=[],a)m=a[d],void 0,h=null==m?".":"string"==typeof m?JSON.stringify(m):m.toString(),b.push({var:d,value:h});return y=J(J({},c),{},{where:"".concat(i)}),x={action:"table.update",data:{table:y,set:b}},e.next=1,t.runAction(n,x);case 1:return v=e.sent,w={msg:"Update completed",statusCode:0},0!==(g=v.items().toJS().disposition).statusCode&&(w.statusCode=g.statusCode,w.msg=g.reason),e.abrupt("return",w);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const M=function(e,t,n){return U.apply(this,arguments)};function F(){return(F=t(s().mark(function e(t,n,r,a,o){var c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.caslib,i=r.name,'\n   table.save /\n    replace=true\n      table = {caslib="'.concat(c,'" name="').concat(i,'"}\n    caslib="').concat(c,'" name="').concat(i,'.sashdat";\n\n  /* clean up before promoting the table */\n  table.droptable /\n      caslib="').concat(c,'" name="').concat(i,'" ;\n\n  /* promote the table to make it available for further analysis */\n  table.loadTable status=status r=rc/\n    caslib="').concat(c,'",\n    path="').concat(i,'.sashdat",\n    casout={name="').concat(i,'", caslib="').concat(c,'" promote=True};\n    run;\n\t'),e.abrupt("return",{msg:"".concat(c,".").concat(i," saved}"),statusCode:0});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Q=function(e,t,n,r,a){return F.apply(this,arguments)};function z(){return(z=t(s().mark(function e(t,n,r,a,o,c){var i,u,l,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=b()+" "+y(),u={masterTable:a,setTable:r,save:null==o||o,promote:null!=c&&c},e.next=1,p(t,n,i,u);case 1:if(l=e.sent,f=l.items("results","casResults").toJS(),!0!==o){e.next=2;break}return e.next=2,Q(t,n,a);case 2:return e.abrupt("return",f);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}const G=function(e,t,n,r,a,s){return z.apply(this,arguments)},B=function(e,t){var n=e.items("tables",t),r=n.get("rows"),a=[];n.get("schema").map(function(e){a.push(e.get("name"))});var s=[];return r.map(function(e){var t={};e.map(function(e,n){t[a[n]]=e}),s.push(t)}),s};function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function W(){return(W=t(s().mark(function e(t,n,r,a){var o,c,i,u,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.output,c=o.caslib,null!=(i=o.name)){e.next=1;break}throw"Please specify table as caslib.name";case 1:return i=i.toLowerCase(i),u="\n      action table.droptable /\n       caslib= '".concat(c,"'  name= '").concat(i,"' quiet=true;\n\n      action table.deleteSource/\n      caslib= '").concat(c,"'  source= '").concat(i,".sashdat' quiet=true;   \n      "),l={action:"sccasl.runcasl",data:{code:u}},e.next=2,t.runAction(n,l);case 2:return l={action:"astore.upload",data:{rstore:{name:"".concat(i),caslib:"".concat(c),replace:!0},store:r}},e.next=3,t.runAction(n,l);case 3:return e.sent,e.abrupt("return","Upload of ".concat(a.source," to ").concat(c,".").concat(i," completed"));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Y=function(e,t,n,r){return W.apply(this,arguments)};function V(){return(V=t(s().mark(function e(t,n,r,a,o){var c,i,u,l,p,f,b;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=a.output,i=c.caslib,null!=(u=c.name)){e.next=1;break}throw"Please specify table as caslib.name";case 1:return e.next=2,X(t,n,i,u);case 2:return e.sent,l={casout:{caslib:i,name:u},importOptions:{fileType:a.fileType}},"sas"!==a.fileExt&&"ds2"!==a.fileExt||(l.importOptions.delimiter="\\"),p={headers:{"JSON-Parameters":l,"Content-Type":"binary/octet-stream"},data:r,action:"table.upload"},e.next=3,t.runAction(n,p);case 3:if(f=e.sent,!0!==o){e.next=5;break}return b="\n\t\t\n\t\t\taction table.save r = result / \n\t\t\t\ttable = {caslib='".concat(i,"' name='").concat(u,"'} \n\t\t\t\tcaslib='").concat(i,"' name='").concat(u,"' replace=true;\n\t\t\t\n\t\t\taction table.loadTable r = result2 /\n\t\t\t\tcaslib='").concat(i,"' casout={caslib='").concat(i,"' name='").concat(u,"' replace=true} \n\t\t\t\tpath='").concat(u,".sashdat' ;\n\n\t\t\n\t\t    send_response({status=result2});\n\t\t\t"),e.next=4,v(t,n,b,null,!0);case 4:e.sent;case 5:return null==a.source||a.source,e.abrupt("return",f);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X(e,t,n,r){return K.apply(this,arguments)}function K(){return(K=t(s().mark(function e(t,n,r,a){var o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"".concat(r,".").concat(a),o="\n\t\taction table.dropTable/   \n        caslib='".concat(r,"' name='").concat(a,"' quiet=TRUE;   \n             \n        action table.deleteSource status=src /   \n        caslib='casuser' source= '").concat(a,".sashdat' quiet=TRUE;  \n\t\tsend_response({casResults = {status=src, results= 'data deleted'}})\n\t\t"),e.next=1,v(t,n,o);case 1:return c=e.sent,e.abrupt("return",c);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const $=function(e,t,n,r,a){return V.apply(this,arguments)},Z=function(e,t){var n,r,a=null,s=$,o=function(e){return e};switch(r=null==e?"csv":e.split(".").pop().toLowerCase()){case"sas7bdat":n="basesas";break;case"sashdat":n="hdat";break;case"csv":n=r,a="UTF8";break;case"xslx":case"xsl":n=r;break;case"astore":case"sasast":n=r,s=Y,o=function(e){return new Buffer.from(e).toString("base64")};break;case"ds2":case"sas":n="csv",a="UTF8",s=$,o=function(e,t){var n=e.replace(/[^\x00-\x7F]/g,"").replace(/\r?\n/g,""),r=t.fileExt;return"modelName\\"+("sas"===r?"dataStepSrc":"ds2"===r?"ds2Src":"casl"===r?"caslSrc":"dataStepsrc")+"\n"+t.output.name+"\\ "+n+"\n"};break;default:throw"Currently file type of ".concat(r," is not supported")}var c,i,u=(c=t.split("."),i=2,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,c=[],i=!0,u=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=s.call(n)).done)&&(c.push(r.value),c.length!==t);i=!0);}catch(e){u=!0,a=e}finally{try{if(!i&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}(c,i)||function(e,t){if(e){if("string"==typeof e)return H(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}(c,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{source:e,output:{caslib:u[0],name:u[1].toLowerCase()},fileType:n,fileExt:r,fileOptions:a,transform:o,contentType:"binary/octet-stream",handler:s}};function ee(){return(ee=t(s().mark(function e(t,n,r,a,c,i){var u,l,p,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=a,"object"===o(a)&&(u="".concat(a.caslib,".").concat(a.name)),l=Z(r,u),p=i,e.next=1,l.handler(t,n,p,l,c);case 1:return f=e.sent,e.abrupt("return",f);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const te=function(e,t,n,r,a,s){return ee.apply(this,arguments)};function ne(){return(ne=t(s().mark(function e(t,n,r,a){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,v(t,n,"\n\t  print _args_;\n    rc = checkAndLoadTable(_args_.caslib, _args_.name);\n\t\tif (rc ne true) then do;\n\t\t\ttext = 'Unable to access ' ||_args_.caslib||'.'||_args_.name;   \n\t\t\trx = {severity=2,reason=6, status='error',statusCode=2, formatted=text};\n\t\t\texit(rx);  \n\t\tend; \n\t  print 'return code = ' || rc;\n\t  send_response({casResults={status='ok'}});\n  ",r,!0);case 1:return e.sent,e.abrupt("return",{msg:"".concat(r.caslib,".").concat(r.name," loaded}"),statusCode:0});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const re=function(e,t,n,r){return ne.apply(this,arguments)};function ae(){return(ae=t(s().mark(function e(t,n,r,a){var o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r||null!=a){e.next=2;break}return e.next=1,se(t,n,r);case 1:o=e.sent,e.next=4;break;case 2:return e.next=3,ce(t,n,a);case 3:o=e.sent;case 4:return e.abrupt("return",o);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function se(e,t,n){return oe.apply(this,arguments)}function oe(){return(oe=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,b,d;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a={session:n,log:null,listing:null,ods:null,job:r,tables:{},files:{}}).log=r.links("log"),a.listing=r.links("listing"),null===(o=r.links("results"))){e.next=2;break}return e.next=1,t.apiCall(o);case 1:if(c=e.sent,(i=c.itemsList().size)>0)for(u=0;u<i;u++)l=c.itemsList(u),"ods"===(p=c.items(l,"data","type").toLowerCase())?a.ods=c.itemsCmd(l,"self"):"table"===p?(f={self:c.itemsCmd(l,"self"),current:null},a.tables[l.toUpperCase()]=f):"file"===p?(b={self:l,current:null,data:null},a.files[l]=b):(d={self:l,current:null,data:null},a[p]=d);case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ce(e,t,n){return ie.apply(this,arguments)}function ie(){return(ie=t(s().mark(function e(t,n,r){var a,c,i,u,l,p,f,b,d,m,h,y,x;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a={session:n,log:null,listing:null,ods:null,job:null,tables:{},files:{}},c="object"===o(r)?[r]:r,i=0;case 1:if(!(i<c.length)){e.next=8;break}return u=c[i],l=u.libref.toUpperCase(),p=u.name.toUpperCase(),f={qs:{filter:"eq(name,'".concat(l,"')")}},e.next=2,t.apiCall(n.links("librefs"),f);case 2:if(0!==(b=e.sent).itemsList().size){e.next=3;break}throw"ERROR: Libref ".concat(l," not found");case 3:return d=b.itemsCmd(l,"self"),e.next=4,t.apiCall(d);case 4:return m=e.sent,f={qs:{filter:"eq(name,'".concat(p,"')")}},e.next=5,t.apiCall(m.links("tables"),f);case 5:if(0!==(h=e.sent).itemsList().size){e.next=6;break}throw"ERROR: Table ".concat(p," not found");case 6:y="".concat(l,".").concat(p).toLowerCase(),x={self:h.itemsCmd(p,"self"),current:null},a.tables[y.toUpperCase()]=x;case 7:i++,e.next=1;break;case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ue=function(e,t,n,r){return ae.apply(this,arguments)};function le(){return(le=t(s().mark(function e(t,n,r,a,o,c){var i,u,l,p,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={data:{code:r}},e.next=1,t.apiCall(n.links("execute"),i);case 1:return u=e.sent,l={qs:{wait:null!=a?a:5},headers:{"If-None-Match":u.headers("etag")}},e.next=2,t.jobState(u,l,"longpoll",0,o,c);case 2:return p=e.sent,e.next=3,ue(t,n,p.job);case 3:return(f=e.sent).SASJobStatus=p.data,f.jobStateStatus=p,e.abrupt("return",f);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const pe=function(e,t,n,r,a,s){return le.apply(this,arguments)};function fe(){return(fe=t(s().mark(function e(t,n,r,a,o,c,i){var u,l,p,f,b;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("number"==typeof c&&(c=null),u=["options NOSYNTAXCHECK OBS=MAX;%let syscc=0;"],null!=a)for(l in a)p="%let ".concat(l,"=").concat(a[l],";"),u.push(p);return f=(f=r.replace(/\t/g," ")).split(/\r?\n/),u=u.concat(f).concat(";"),e.next=1,pe(t,n,u,o,c,i);case 1:return b=e.sent,e.abrupt("return",b);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const be=function(e,t,n,r,a,s,o){return fe.apply(this,arguments)};function de(){return(de=t(s().mark(function e(t,n,r,a,c){var i,u,l,p,f,b,d,m,h,y,x,v;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==c||"object"!==o(c)){e.next=1;break}return e.abrupt("return",c);case 1:if(null==r){e.next=3;break}return e.next=2,t.logon(r);case 2:e.sent;case 3:return e.next=4,t.addServices("compute");case 4:if(i=e.sent,u=i.compute,l=null,null==c){e.next=8;break}return p={start:0,limit:100,qs:{filter:"eq(id,'".concat(c,"')")}},e.next=5,t.apiCall(u.links("sessions"),p);case 5:if(f=e.sent,!((b=f.itemsList().toJS().indexOf(c))<0)){e.next=6;break}throw"ERROR: The sessionID ".concat(c," was not found.");case 6:return d=f.itemsCmd(f.itemsList(b),"self"),e.next=7,t.apiCall(d);case 7:return l=e.sent,e.abrupt("return",l);case 8:if(null==t.store.config.options.computeServerId){e.next=10;break}return console.log("NOTE: Detected Workbench"),e.next=9,t.apiCall(u.links("createSession"));case 9:return l=e.sent,e.abrupt("return",l);case 10:return null==n&&(n="SAS Job Execution compute context"),m={qs:{filter:"contains(name,'".concat(n,"')")}},h=null,e.prev=11,e.next=12,t.apiCall(u.links("contexts"),m);case 12:if(0!==(h=e.sent).itemsList().size){e.next=13;break}throw"Context ".concat(n," not found");case 13:e.next=15;break;case 14:throw e.prev=14,v=e.catch(11),console.error("Error: Not able to get context"),v;case 15:if(y=h.itemsList(0),null!=c){e.next=17;break}return m=null==a?null:a,x=h.itemsCmd(y,"createSession"),e.next=16,t.apiCall(x,a);case 16:l=e.sent;case 17:return e.abrupt("return",l);case 18:case"end":return e.stop()}},e,null,[[11,14]])}))).apply(this,arguments)}const me=function(e,t,n,r,a){return de.apply(this,arguments)};function he(){return(he=t(s().mark(function e(t,n,r){var a,o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("log"!==r&&"listing"!==r){e.next=7;break}if(a=[],null===n[r]){e.next=5;break}return e.next=1,t.apiCall(n[r]);case 1:o=e.sent,a=a.concat(o.items().toJS());case 2:if(null===(c=o.scrollCmds("next"))){e.next=4;break}return e.next=3,t.apiCall(c);case 3:o=e.sent,a=a.concat(o.items().toJS()),e.next=2;break;case 4:e.next=6;break;case 5:a[0]="Note: No ".concat(r);case 6:return e.abrupt("return",a);case 7:if("ods"!==r){e.next=11;break}if(null===n.ods){e.next=9;break}return e.next=8,t.apiCall(n.ods);case 8:return i=e.sent,e.abrupt("return",i.items());case 9:return e.abrupt("return","<h2> No ODS output </h2>");case 10:e.next=14;break;case 11:if("tables"!==r){e.next=12;break}return e.abrupt("return",Object.keys(n.tables));case 12:if("files"!==r){e.next=13;break}return e.abrupt("return",Object.keys(n.files));case 13:throw"Error: Invalid type ".concat(r);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ye=function(e,t,n){return he.apply(this,arguments)};function xe(){return(xe=t(s().mark(function e(t,n,r,a){var o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a){e.next=2;break}return e.next=1,be(t,n,a);case 1:if("completed"===(o=e.sent).SASJobStatus){e.next=2;break}throw"Error: Preamble failed with completion code of ".concat(o.SASJobStatus);case 2:return e.next=3,ue(t,n,null,r);case 3:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ve=function(e,t,n,r){return xe.apply(this,arguments)};function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach(function(t){w(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ke(){return(ke=t(s().mark(function e(t,n,r,a,o,c){var i,u,l,p,f,b,d,m,h,y,x,v,w,g,k,_,S,O,C,j,T,E,R;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null,u=(u="string"==typeof r?r:"".concat(r.libref,".").concat(r.name)).toUpperCase(),(l=null!=o?ge({},o):{qs:{}}).qs.includeIndex=!0,p=l.qs.format,f=null==c?"rows":c,b=null!=o&&null==a,null==(d=n.tables[u])){e.next=6;break}if(!0===b&&(d.current=null),null!==d.current&&null!=a&&"first"!==a){e.next=4;break}return e.next=1,t.apiCall(d.self);case 1:return m=e.sent,h=m.items().toJS().columnCount,y={qs:{start:0,limit:h}},e.next=2,t.apiCall(m.links("columns"),y);case 2:for(g in x=e.sent,v=[],w=x.items().toJS(),"rows"===f&&v.push({name:"_index_",Column:"_Index_",Label:"Index",length:8,type:"FLOAT",format:"BEST",informat:"BEST",custom:!1,isFormat:!1}),w)k=w[g],_={name:k.name.toLowerCase(),Column:k.name.toLowerCase(),Label:k.data.label,length:k.data.length,type:k.data.type,format:null!=k.data.format?k.data.format.name:null,informat:null!=k.data.informat?k.data.informat.name:null,custom:!1,isFormat:p},S=!0===l.qs.includeIndex?1:0,v[k.data.index+S]=_;return e.next=3,t.apiCall(m.links(f),l);case 3:O=e.sent,C="rowSet"===f?O.items("rows").toJS():_e(O),d.current=O,d.schema=v,d.columns=x,i={columns:x,schema:v,rows:C,scrollOptions:O.scrollCmds().keySeq().toJS()},e.next=6;break;case 4:if(j=d.current,T=a,"next"===a&&null===j.scrollCmds("next")&&(T=null!==j.links("last")?"last":null),"prev"===a&&null===j.scrollCmds("prev")&&(T=null!==j.links("first")?"first":null),i={schema:d.schema,columns:d.columns,currentColumns:d.currentColumns,rows:[],scrollOptions:j.scrollCmds().keySeq().toJS()},null===T||null===j.scrollCmds(T)){e.next=6;break}return e.next=5,t.apiCall(j.scrollCmds(T),l);case 5:E=e.sent,d.current=E,R="rows"!==f?E.items("rows").toJS():_e(E),i={schema:d.schema,columns:d.schema,rows:R,scrollOptions:E.scrollCmds().keySeq().toJS()};case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _e(e){return e.items().toJS().map(function(e){return e.cells})}const Se=function(e,t,n,r,a,s){return ke.apply(this,arguments)};function Oe(){return(Oe=t(s().mark(function e(t,n,r,a){var o,c,i,u,l,p;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(o=n.files[r])){e.next=1;break}throw"Invalid fileref ".concat(r);case 1:if(null!==o.current){e.next=4;break}return c={qs:{filter:"eq(name,'".concat(r,"')")}},e.next=2,t.apiCall(n.session.links("files"),c);case 2:return i=e.sent,e.next=3,t.apiCall(i.itemsCmd(r,"self"));case 3:i=e.sent,o.current=i;case 4:if(!0!==a){e.next=5;break}return u="".concat(n.session.host).concat(o.current.links("content","link","uri")),e.abrupt("return",u);case 5:if(null!==o.data){e.next=7;break}return e.next=6,t.apiCall(o.current.links("content"));case 6:return l=e.sent,p=l.items(),o.data=p,e.abrupt("return",p);case 7:return e.abrupt("return",o.data);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Ce=function(e,t,n,r){return Oe.apply(this,arguments)};function je(){return(je=t(s().mark(function e(t,n,r,a){var o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o="\n     proc append base=".concat(a.libref,".{output.name}  \n     data= ").concat(r.libref,".").concat(r.name,"; run;\n     "),e.next=1,be(t,n,o);case 1:return c=e.sent,i="completed"===c.SASJobStatus?0:1,e.abrupt("return",{msg:"Append Completed. Status is: ".concat(c.SASJobStatus),statusCode:i});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Te=function(e,t,n,r){return je.apply(this,arguments)};function Ee(){return(Ee=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,b,d,m,h,y,x,v,w,g,k;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(p in a=r.data,o=r.table,c=r.where,i="proc sql; update ".concat(o.libref,".").concat(o.name),u="SET ",l=" ",a)u=u+l+p+"="+Re(a[p]),l=", ";if(i=i+" "+u,f=" WHERE ",b=" ","string"==typeof c)f+=c;else for(d in c)m=c[d],h=Re(m),f=f+b+d+"= ".concat(h," "),b=" AND ";return y=(i=i+" "+f+";run;").split(/\r?\n/),x={data:{code:y}},e.next=1,t.apiCall(n.links("execute"),x);case 1:return v=e.sent,w={qs:{newState:"Completed",timeout:1}},e.next=2,t.jobState(v,w);case 2:return g=e.sent,k="completed"===g.data?0:1,e.abrupt("return",{statusCode:k,msg:g.data});case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Re(e){return null==e?".":"string"==typeof e?JSON.stringify(e):e.toString()}const Pe=function(e,t,n){return Ee.apply(this,arguments)};function qe(){return(qe=t(s().mark(function e(t,n,r,a,o){var c,i,u,l,p,f;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(l in c="data ".concat(r.libref,".").concat(r.name,"; INFILE datalines delimiter=',' ;\n"),i="",u="INPUT ",o)p=o[l],u=u+p.Column+" ","CHAR"===p.Type&&(f=" ".concat(p.Column," $ ").concat(p.length," \n"),i=i+" "+f);return i.length>0&&(i="LENGTH "+i+";\n"),c=c+";\n"+i+(u+=";\n")+"datalines;\n"+a+"\n; run; proc print;run;\n",e.next=1,be(t,n,c);case 1:return e.abrupt("return",{msg:"done",statusCode:0});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Ae=function(e,t,n,r,a){return qe.apply(this,arguments)};function Le(){return(Le=t(s().mark(function e(t,n){var r,a,o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("reports");case 1:return r=e.sent,a=r.reports,console.log(a),o=null,null!==n&&(o={qs:{filter:"eq(name,'".concat(n,"')")}}),console.log("-----------",a.links("reports")),e.next=2,t.apiCall(a.links("reports"),o);case 2:return c=e.sent,e.abrupt("return",0===c.itemsList().size?null:c);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}const De=function(e,t){return Le.apply(this,arguments)};function Ie(){return(Ie=t(s().mark(function e(t,n){var r,a,o,c,i,u,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rafObject("reportImages"),e.next=1,De(t,n);case 1:if(null!==(a=e.sent)){e.next=2;break}return e.abrupt("return","".concat(n," was not found"));case 2:return o=a.itemsCmd(a.itemsList(0),"self","link","uri"),c={data:{reportUri:o,sectionIndex:0,layoutType:"entireSection",size:"400x400"}},e.next=3,t.apiCall(r.links("createJob"),c);case 3:return i=e.sent,e.next=4,t.jobState(i,{qs:{wait:1.5}},10,2);case 4:if("completed"===(u=e.sent).data){e.next=5;break}return e.abrupt("return","Job failed ".concat(u.data));case 5:return e.next=6,t.apiCall(u.job.itemsCmd(u.job.itemsList(0),"image"));case 6:return l=e.sent,e.abrupt("return",l.items());case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Ne=function(e,t){return Ie.apply(this,arguments)};function Je(){return(Je=t(s().mark(function e(t,n){var r,a;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,De(t,n);case 1:if(null!==(r=e.sent)){e.next=2;break}throw null==n?"No reports were found":"".concat(n," was not found");case 2:return a=[],r.items().map(function(e,t){var n={name:t,uri:r.itemsCmd(t,"self","link","uri")};a.push(n)}),e.abrupt("return",a);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Ue=function(e,t){return Je.apply(this,arguments)};function Me(){return(Me=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,b;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.tables[r],e.next=1,t.apiCall(a);case 1:return o=e.sent,e.next=2,t.apiCall(o.links("rowSet"));case 2:c=e.sent,i=c.items("columns"),u=c.items("rows"),l=[],p=u.size,f=s().mark(function e(){var t,n;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=u.get(b),n={},i.map(function(e,r){var a=e.toLowerCase();n[a]=t.get(r)}),l.push(n);case 1:case"end":return e.stop()}},e)}),b=0;case 3:if(!(b<p)){e.next=5;break}return e.delegateYield(f(),"t0",4);case 4:b++,e.next=3;break;case 5:return e.abrupt("return",l);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}const Fe=function(e,t,n){return Me.apply(this,arguments)};function Qe(){return(Qe=t(s().mark(function e(t,n){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,ze(t,n);case 1:return e.abrupt("return",e.sent);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ze(e,t){return Ge.apply(this,arguments)}function Ge(){return Ge=t(s().mark(function e(n,r){var a,o,c,i,u,l,p,f,b,d,m,h,y,x,v;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y=function(){return y=t(s().mark(function e(t,n,r,a){var o,c,i,u,l,p,f,b,d;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("files");case 1:return o=e.sent,c=o.files,i={qs:{filter:"eq(id,'".concat(r,"')")}},e.prev=2,e.next=3,t.apiCall(c.links("files"),i);case 3:return u=e.sent,l=u.itemsCmd(u.itemsList(0),"content"),e.next=4,t.apiCall(l);case 4:if(p=e.sent,"string"!=typeof(f=p.items())){e.next=5;break}return e.abrupt("return",f);case 5:if(b=f.toJS(),!a){e.next=7;break}if(!Array.isArray(b)){e.next=6;break}return e.abrupt("return",b);case 6:return d=[],Object.values(b).forEach(function(e){d.push(e)}),e.abrupt("return",d);case 7:return e.abrupt("return",b);case 8:e.next=10;break;case 9:return e.prev=9,e.catch(2),e.abrupt("return",null);case 10:case"end":return e.stop()}},e,null,[[2,9]])})),y.apply(this,arguments)},h=function(e,t,n,r){return y.apply(this,arguments)},a=r.items().toJS(),o={computeContext:a.results.COMPUTE_CONTEXT,computeJob:a.results.COMPUTE_JOB,computeSession:a.results.COMPUTE_SESSION,session:r.session,log:null,listing:null,ods:null,job:r,tables:{},files:{},results:a.results},x=s().keys(a.results);case 1:if((v=x()).done){e.next=5;break}if("COMPUTE_CONTEXT"===(c=v.value)||"COMPUTE_JOB"===c||"COMPUTE_SESSION"===c){e.next=4;break}if(i=!1,u=null,c.endsWith(".json")?(u=c,i=!0):((l=c.split(".")).shift(),u=l.join(".")),null!==(p=a.results[c])){e.next=2;break}return e.abrupt("continue",1);case 2:return f=p.split("/"),b=f[f.length-1],e.next=3,h(n,u,b,i);case 3:d=e.sent,i?(m=u.split(".json")[0],o.tables[m]=d):o.files[u]=d;case 4:e.next=1;break;case 5:return e.abrupt("return",o);case 6:case"end":return e.stop()}},e)})),Ge.apply(this,arguments)}const Be=function(e,t){return Qe.apply(this,arguments)};function He(){return(He=t(s().mark(function e(t,n){var r,a,o,c,i,u;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("jobExecution");case 1:return r=e.sent,a=r.jobExecution,e.prev=2,e.next=3,t.apiCall(a.links("create"),n);case 3:return o=e.sent,e.next=4,t.jobState(o,null,"wait",2);case 4:if("running"!==(c=e.sent).data){e.next=5;break}throw"ERROR: Job did not complete in allotted time";case 5:if("failed"!==c.data){e.next=6;break}throw JSON.stringify(c);case 6:return e.next=7,Be(t,c.job);case 7:return(i=e.sent).status=c.data,e.abrupt("return",i);case 8:e.next=10;break;case 9:throw e.prev=9,u=e.catch(2),"Error: ".concat(u);case 10:case"end":return e.stop()}},e,null,[[2,9]])}))).apply(this,arguments)}const We=function(e,t){return He.apply(this,arguments)};function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach(function(t){w(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Xe(){return(Xe=t(s().mark(function e(t,n,r,a){var o,c,i,u,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a){e.next=1;break}l=a,e.next=3;break;case 1:return e.next=2,Ke(t,n);case 2:l=e.sent;case 3:return o=l,c=Ve(Ve({},r),{},{_omitSessionResults:!1,_resultfile:"*",_output_json:"json"}),i={data:{jobDefinitionUri:o,arguments:c}},e.next=4,We(t,i);case 4:return u=e.sent,e.abrupt("return",u);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ke(e,t){return $e.apply(this,arguments)}function $e(){return($e=t(s().mark(function e(t,n){var r,a,o,c,i,u;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("jobDefinitions");case 1:return r=e.sent,a=r.jobDefinitions,o=null,c={qs:{filter:"eq(name,'".concat(n,"')")}},i=a.links("job-definitions"),e.prev=2,e.next=3,t.apiCall(i,c);case 3:if(0!==(u=e.sent).itemsList().size){e.next=4;break}throw"Error: ".concat(n," not found in the system");case 4:console.log(u.items().toJS()),o=u.itemsCmd(n,"self","link","uri");case 5:return e.abrupt("return",o);case 6:throw e.prev=6,e.catch(2),"Error: ".concat(n," not found in the system");case 7:case"end":return e.stop()}},e,null,[[2,6]])}))).apply(this,arguments)}const Ze=function(e,t,n,r){return Xe.apply(this,arguments)};function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach(function(t){w(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nt(){return(nt=t(s().mark(function e(t,n,r){var a,o,c,i,u,l,p,f,b,d;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.addServices("jobExecution");case 1:return a=e.sent,o=a.jobExecution,c={qs:{filter:"eq(name,'".concat(n,"')")}},e.prev=2,e.next=3,t.apiCall(o.links("jobs"),c);case 3:if(0!==(i=e.sent).itemsList().size){e.next=4;break}throw"Error: ".concat(n," not found in the system");case 4:return u=i.items(i.itemsList(0),"data","jobRequest","jobDefinition"),l=tt(tt({},r),{},{_omitSessionResults:!1,_resultfile:"*",_output_json:"json"}),p={data:{jobDefinition:u,arguments:l}},e.next=5,t.apiCall(i.links("submitJob"),p);case 5:return f=e.sent,e.next=6,t.jobState(f,null,"wait",2);case 6:if("running"!==(b=e.sent).data){e.next=7;break}throw"ERROR: Job did not complete in allotted time.";case 7:if("failed"!==b.data){e.next=8;break}throw"ERROR: Job failed. See SAS Environment for details.";case 8:return e.next=9,Be(t,b.job);case 9:return d=e.sent,e.abrupt("return",d);case 10:e.next=12;break;case 11:throw e.prev=11,e.catch(2);case 12:case"end":return e.stop()}},e,null,[[2,11]])}))).apply(this,arguments)}const rt=function(e,t,n){return nt.apply(this,arguments)};function at(){return(at=t(s().mark(function e(t,n,r){var a,o,c,i,u;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={qs:{filter:"eq(name,'".concat(r.trim(),"')")}},e.next=1,t.apiCall(n.links("modules"),a);case 1:if(0!==(o=e.sent).itemsList().size){e.next=2;break}return e.abrupt("return",null);case 2:return c=o.itemsCmd(r,"steps"),e.next=3,t.apiCall(c);case 3:return i=e.sent,u={name:r,stepsRafLink:i,stepIds:o.items(r,"data","stepIds").toJS(),microanalyticScore:n},e.abrupt("return",u);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const st=function(e,t,n){return at.apply(this,arguments)};function ot(){return(ot=t(s().mark(function e(t,n,r){var a,o,c,i,u,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r){e.next=1;break}return e.next=1,t.logon(r);case 1:return e.next=2,t.addServices("microanalyticScore");case 2:a=e.sent,o=a.microanalyticScore,c={service:o,steps:{}},i=0;case 3:if(!(i<n.length)){e.next=6;break}return u=n[i],e.next=4,st(t,o,u);case 4:l=e.sent,c.steps[u]=l;case 5:i++,e.next=3;break;case 6:return e.abrupt("return",c);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ct=function(e,t,n){return ot.apply(this,arguments)},it=function(e,t,n,r){var a=e.steps[t];if(null===a)return[];var s=null;if(null==n){var o=a.stepIds.findIndex(function(e){return"execute"===e||"score"===e});if(-1===o)return[];s=a.stepIds[o];var c=a.stepsRafLink.items(s,"data","inputs"),i=a.stepsRafLink.items(s,"data","outputs");return null===c?[]:!0===r?{inputs:c.toJS(),outputs:i.toJS()}:c.toJS()}if(-1===a.stepIds.findIndex(function(e){return e===n}))return[];s=n;var u=a.stepsRafLink.items(s,"data","inputs"),l=a.stepsRafLink.items(s,"data","outputs");return null===u?[]:!0===r?{inputs:u.toJS(),outputs:l.toJS()}:u.toJS()};function ut(){return(ut=t(s().mark(function e(t,n,r,a,o,c){var i,u,l,p,f,b,d,m,h,y,x,v,w;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.steps[r],u=!1,l=[],!1===Array.isArray(a))for(p in a)f={name:p,value:a[p]},l.push(f);else u=!0;if(b={data:{inputs:!0===u?a:l}},d=null,null!=o){e.next=3;break}if(-1!==(m=i.stepIds.findIndex(function(e){return"execute"===e||"score"===e}))){e.next=1;break}return e.abrupt("return",[]);case 1:d=i.stepIds[m];case 2:e.next=5;break;case 3:if(-1!==i.stepIds.findIndex(function(e){return e===o})){e.next=4;break}return e.abrupt("return",[]);case 4:d=o;case 5:if(null==c&&(c="execute"),null!==(h=i.stepsRafLink.itemsCmd(d,c))){e.next=6;break}return y=[{name:"Error",type:"string",value:"name: ".concat(r," step: ").concat(o," operation: ").concat(c," is an invalid combination")}],e.abrupt("return",y);case 6:return e.next=7,t.apiCall(h,b);case 7:return x=e.sent,v=x.items("outputs").toJS(),!0===u?w=v:(w={},v.map(function(e){w[e.name]=e.value})),e.abrupt("return",w);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}const lt=function(e,t,n,r,a,s){return ut.apply(this,arguments)};function pt(){return(pt=t(s().mark(function e(t,n,r){var a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,ct(t,[n]);case 1:return a=e.sent,e.next=2,lt(t,a,n,r,"score","execute");case 2:return o=e.sent,e.abrupt("return",o);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}const ft=function(e,t,n){return pt.apply(this,arguments)};function bt(){return(bt=t(s().mark(function e(t,n,r){var a,o,c,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=n.service,o=0;case 1:if(!(o<r.length)){e.next=4;break}if(c=r[o],null!=n.steps[c]){e.next=3;break}return e.next=2,st(t,a,c);case 2:i=e.sent,n.steps[c]=i;case 3:o++,e.next=1;break;case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}const dt=function(e,t,n){return bt.apply(this,arguments)}})(),r})());