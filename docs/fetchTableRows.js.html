<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: fetchTableRows.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: fetchTableRows.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * Copyright Â© 2019, SAS Institute Inc., Cary, NC, USA.  All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 */

import {casFetchRows} from '@sassoftware/restaflib';
import prepFormData from "./prepFormData";
/**
 * @description Fetch new records based on control argument
 * @async
 * @module fetchTableRows
 * @param {fetchControl} control - info for records to retrieve
 * @param {appEnv} appEnv - appEnv
 * @returns {promise}  - { data:data, columns:ecolumns, pagination: pagination} 
 * @examples
 *   let control = {from: 10, count:50, format: false};
 *   let r = await fetchTableRows(control, appEnv);
 *   r is a fetchResult object
 */
async function fetchTableRows (control, appEnv) {
    let {store, session} = appEnv;
    // eslint-disable-next-line no-useless-catch
    let c   = {...control};
    if (c.table == null) {
        c.table = appEnv.appControl.dataControl.table;
    }
    if (c.where == null) {
        c.where = {};
    }
    if (c.from &lt;= 0 || c.next === -1) {
        return null;
    }
    let r = await casFetchRows(store, session, c);
    let t = await prepFormData(r.data, appEnv);
    
    appEnv.state = {
        modified  : [],
        pagination: {...r.pagination},
        currentPage: c,
        data      : [],
        columns   : []
    };
    
    if (appEnv.appControl.dataControl.cachePolicy === true) {
       appEnv.state.data = t.data;
       appEnv.state.columns = t.columns;
    }

    t.pagination = {...r.pagination};
    return t;
        
}
export default fetchTableRows;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-cellEdit.html">cellEdit</a></li><li><a href="module-commonHandler.html">commonHandler</a></li><li><a href="module-fetchTableRows.html">fetchTableRows</a></li><li><a href="module-scrollTable.html">scrollTable</a></li><li><a href="module-setup.html">setup</a></li><li><a href="module-updateTableRows.html">updateTableRows</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Thu Jul 21 2022 14:08:49 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
