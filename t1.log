apiVersion: v1
kind: Pod
metadata:
  annotations:
    prometheus.io/path: /internal/metrics
    prometheus.io/port: "8080"
    prometheus.io/scheme: https
    prometheus.io/scrape: "true"
    sas.com/certificate-file-format: pem
    sas.com/component-name: sas-compute
    sas.com/component-version: 1.60.3-20220601.1654106385253
    sas.com/kustomize-base: golang
    sas.com/pod-uses-liveness-probe: http
    sas.com/pod-uses-readiness-probe: http
    sas.com/pod-uses-startup-probe: http
    sas.com/restartedAt: 2022-07-13 12:48:33.716347041 +0000 UTC m=+39281.016135778
    sas.com/tls-enabled-ports: all
    sas.com/tls-mode: full-stack
    sas.com/version: 1.60.3
    seccomp.security.alpha.kubernetes.io/pod: runtime/default
    sidecar.istio.io/proxyCPU: 15m
    sidecar.istio.io/proxyMemory: 115Mi
  creationTimestamp: "2022-07-13T13:27:00Z"
  generateName: sas-compute-d5b46b6c7-
  labels:
    app: sas-compute
    app.kubernetes.io/name: sas-compute
    pod-template-hash: d5b46b6c7
    sas.com/deployment: sas-viya
    workload.sas.com/class: stateless
  name: sas-compute-d5b46b6c7-wz85l
  namespace: viya
  ownerReferences:
  - apiVersion: apps/v1
    blockOwnerDeletion: true
    controller: true
    kind: ReplicaSet
    name: sas-compute-d5b46b6c7
    uid: dc598142-1a5d-4668-9814-991a5f3ee861
  resourceVersion: "556435"
  uid: 59149260-c6f7-424f-82b3-c06922148ae3
spec:
  affinity:
    nodeAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
      - preference:
          matchExpressions:
          - key: workload.sas.com/class
            operator: In
            values:
            - stateless
        weight: 100
      - preference:
          matchExpressions:
          - key: workload.sas.com/class
            operator: NotIn
            values:
            - compute
            - cas
            - stateful
        weight: 50
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: kubernetes.azure.com/mode
            operator: NotIn
            values:
            - system
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
      - podAffinityTerm:
          labelSelector:
            matchExpressions:
            - key: app.kubernetes.io/name
              operator: In
              values:
              - sas-compute
          topologyKey: kubernetes.io/hostname
        weight: 100
  automountServiceAccountToken: false
  containers:
  - env:
    - name: SAS_K8S_DEPLOYMENT_NAME
      value: sas-compute
    envFrom:
    - configMapRef:
        name: sas-tls-config-f8ccd48c6m
    - configMapRef:
        name: sas-go-config-tbg2228dk9
    - configMapRef:
        name: sas-shared-config-hbc29d9kh8
    - secretRef:
        name: sas-consul-client
    image: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-compute:1.60.3-20220601.1654106385253
    imagePullPolicy: IfNotPresent
    lifecycle:
      preStop:
        exec:
          command:
          - sh
          - -c
          - sleep 5
    livenessProbe:
      failureThreshold: 3
      httpGet:
        path: /internal/live
        port: http
        scheme: HTTPS
      periodSeconds: 20
      successThreshold: 1
      timeoutSeconds: 5
    name: sas-compute
    ports:
    - containerPort: 8080
      name: http
      protocol: TCP
    readinessProbe:
      failureThreshold: 3
      httpGet:
        path: /internal/ready
        port: http
        scheme: HTTPS
      periodSeconds: 20
      successThreshold: 1
      timeoutSeconds: 5
    resources:
      limits:
        cpu: "2"
        memory: 1Gi
      requests:
        cpu: 50m
        memory: 50Mi
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
        - ALL
      privileged: false
      readOnlyRootFilesystem: true
    startupProbe:
      failureThreshold: 180
      httpGet:
        path: /internal/live
        port: http
        scheme: HTTPS
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 1
    terminationMessagePath: /dev/termination-log
    terminationMessagePolicy: File
    volumeMounts:
    - mountPath: /tmp
      name: tmp
    - mountPath: /security
      name: security
    - mountPath: /opt/sas/viya/config/etc/SASSecurityCertificateFramework/cacerts
      name: security
      subPath: cacerts
    - mountPath: /opt/sas/viya/config/etc/SASSecurityCertificateFramework/private
      name: security
      subPath: private
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  imagePullSecrets:
  - name: sas-image-pull-secrets-26ftgft4m8
  initContainers:
  - env:
    - name: KUBE_POD_NAME
      valueFrom:
        fieldRef:
          apiVersion: v1
          fieldPath: metadata.name
    - name: SAS_CERTFRAME_TOKEN_DIR
      value: /certframe-token
    - name: SAS_ADDITIONAL_CA_CERTIFICATES_DIR
      value: /customer-provided-ca-certificates
    envFrom:
    - configMapRef:
        name: sas-certframe-config-2ch97fd95b
    - configMapRef:
        name: sas-certframe-ingress-certificate-config-cmm2t44t88
    - configMapRef:
        name: sas-certframe-user-config-8f8hm55b74
    image: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-certframe:3.28.3-20220608.1654723656720
    imagePullPolicy: IfNotPresent
    name: sas-certframe
    resources:
      limits:
        cpu: 500m
        memory: 500Mi
      requests:
        cpu: 50m
        memory: 50Mi
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
        - ALL
      privileged: false
      readOnlyRootFilesystem: true
    terminationMessagePath: /dev/termination-log
    terminationMessagePolicy: File
    volumeMounts:
    - mountPath: /certframe-token
      name: certframe-token
    - mountPath: /security
      name: security
    - mountPath: /customer-provided-ca-certificates
      name: customer-provided-ca-certificates
  - args:
    - cp -rf meta /data
    command:
    - /bin/sh
    - -c
    image: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-compute:1.60.3-20220601.1654106385253
    imagePullPolicy: IfNotPresent
    name: hydrator
    resources:
      limits:
        cpu: 500m
        memory: 128Mi
      requests:
        cpu: 75m
        memory: 64Mi
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
        - ALL
      privileged: false
      readOnlyRootFilesystem: true
    terminationMessagePath: /dev/termination-log
    terminationMessagePolicy: File
    volumeMounts:
    - mountPath: /data
      name: shared-vol
  - env:
    - name: SSL_CERT_FILE
      value: /security/trustedcerts.pem
    - name: SAS_SERVICE_NAME
      value: sas-compute
    envFrom:
    - configMapRef:
        name: sas-go-config-tbg2228dk9
    - configMapRef:
        name: sas-shared-config-hbc29d9kh8
    - configMapRef:
        name: sas-java-config-6fdh2d886m
    - secretRef:
        name: sas-consul-client
    image: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-db-migrator:1.10.0-20220607.1654637502176
    imagePullPolicy: IfNotPresent
    name: sas-db-migrator
    resources:
      limits:
        cpu: 500m
        memory: 500Mi
      requests:
        cpu: 100m
        memory: 90Mi
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
        - ALL
      privileged: false
      readOnlyRootFilesystem: true
    terminationMessagePath: /dev/termination-log
    terminationMessagePolicy: File
    volumeMounts:
    - mountPath: /security
      name: security
    - mountPath: /data
      name: shared-vol
  nodeName: aks-generic-15193761-vmss000004
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext:
    runAsNonRoot: true
    seccompProfile:
      type: RuntimeDefault
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 60
  tolerations:
  - effect: NoSchedule
    key: workload.sas.com/class
    operator: Equal
    value: stateful
  - effect: NoSchedule
    key: workload.sas.com/class
    operator: Equal
    value: stateless
  - effect: NoExecute
    key: node.kubernetes.io/not-ready
    operator: Exists
    tolerationSeconds: 300
  - effect: NoExecute
    key: node.kubernetes.io/unreachable
    operator: Exists
    tolerationSeconds: 300
  - effect: NoSchedule
    key: node.kubernetes.io/memory-pressure
    operator: Exists
  volumes:
  - emptyDir: {}
    name: tmp
  - emptyDir: {}
    name: shared-vol
  - name: certframe-token
    secret:
      defaultMode: 420
      secretName: sas-certframe-token
  - emptyDir: {}
    name: security
  - configMap:
      defaultMode: 420
      name: sas-customer-provided-ca-certificates-2f99ft6727
    name: customer-provided-ca-certificates
status:
  conditions:
  - lastProbeTime: null
    lastTransitionTime: "2022-07-13T13:37:52Z"
    status: "True"
    type: Initialized
  - lastProbeTime: null
    lastTransitionTime: "2022-07-13T13:42:20Z"
    status: "True"
    type: Ready
  - lastProbeTime: null
    lastTransitionTime: "2022-07-13T13:42:20Z"
    status: "True"
    type: ContainersReady
  - lastProbeTime: null
    lastTransitionTime: "2022-07-13T13:27:00Z"
    status: "True"
    type: PodScheduled
  containerStatuses:
  - containerID: containerd://822dd04ff32c4f23c7cf8397cc564a2432c5cdff8f31e7d9065fead2d11aee45
    image: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-compute:1.60.3-20220601.1654106385253
    imageID: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-compute@sha256:1f59f074275afaea4738d9a18b1862f40ab21a2d3f117731bf32c5b7e77f1c35
    lastState:
      terminated:
        containerID: containerd://dd035b5aee12c3009390616324657ffebaec5bb0d8a10f1b21ed7cec6c4b3126
        exitCode: 1
        finishedAt: "2022-07-13T13:41:13Z"
        reason: Error
        startedAt: "2022-07-13T13:41:11Z"
    name: sas-compute
    ready: true
    restartCount: 2
    started: true
    state:
      running:
        startedAt: "2022-07-13T13:41:36Z"
  hostIP: 192.168.0.6
  initContainerStatuses:
  - containerID: containerd://0fa585f12b0bbc194c141a3518957d3b715a372609d16df57428e159ae89db32
    image: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-certframe:3.28.3-20220608.1654723656720
    imageID: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-certframe@sha256:86fdf87b8de77b216c9e8268db0ca902c18ec26bc48e90c93c7af1b5ce2b5280
    lastState: {}
    name: sas-certframe
    ready: true
    restartCount: 0
    state:
      terminated:
        containerID: containerd://0fa585f12b0bbc194c141a3518957d3b715a372609d16df57428e159ae89db32
        exitCode: 0
        finishedAt: "2022-07-13T13:27:08Z"
        reason: Completed
        startedAt: "2022-07-13T13:27:03Z"
  - containerID: containerd://09b533945782c5d97fe6ad669445e623d33161fe300865249acf6c17cb6afd05
    image: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-compute:1.60.3-20220601.1654106385253
    imageID: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-compute@sha256:1f59f074275afaea4738d9a18b1862f40ab21a2d3f117731bf32c5b7e77f1c35
    lastState: {}
    name: hydrator
    ready: true
    restartCount: 0
    state:
      terminated:
        containerID: containerd://09b533945782c5d97fe6ad669445e623d33161fe300865249acf6c17cb6afd05
        exitCode: 0
        finishedAt: "2022-07-13T13:27:14Z"
        reason: Completed
        startedAt: "2022-07-13T13:27:14Z"
  - containerID: containerd://ee797e428f2e5cfecdd07c95c15d283c70fa27e75716accbafe5df7b2d1530f7
    image: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-db-migrator:1.10.0-20220607.1654637502176
    imageID: crcache-az-us-east.unx.sas.com/viya-4-x64_oci_linux_2-docker/sas-db-migrator@sha256:42f8e02a50ffcf731a399c826d66c1744f587d7cb5d82bcb8daa092773fa516a
    lastState: {}
    name: sas-db-migrator
    ready: true
    restartCount: 1
    state:
      terminated:
        containerID: containerd://ee797e428f2e5cfecdd07c95c15d283c70fa27e75716accbafe5df7b2d1530f7
        exitCode: 0
        finishedAt: "2022-07-13T13:37:50Z"
        reason: Completed
        startedAt: "2022-07-13T13:34:40Z"
  phase: Running
  podIP: 10.244.7.23
  podIPs:
  - ip: 10.244.7.23
  qosClass: Burstable
  startTime: "2022-07-13T13:27:00Z"
